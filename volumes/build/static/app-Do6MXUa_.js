var Rc=Object.defineProperty;var Dc=(t,s,a)=>s in t?Rc(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var xe=(t,s,a)=>Dc(t,typeof s!="symbol"?s+"":s,a);import{u as Ds,a as oi,c as Pt,r as Je,j as e,R as Mc,b as no,s as H,M as li,d as h,e as Fc,f as K,i as Ec,g as Bc,h as T,k as he,D as je,T as G,H as Oc,l as qc,m as zc,o as Uc,n as Vc,C as Ki,B as L,p as Ke,q as ut,t as Hc,v as Ps,S as ue,w as Q,x as Yc,y as ci,P as io,z as ro,L as Xa,A as di,E as ui,F as gs,G as Ye,I as Le,J as oo,K as ce,N as rs,O as Wc,Q as Ta,U as Qc,V as se,W as Ns,X as Gc,Y as St,Z as V,_ as R,$ as F,a0 as vt,a1 as Kc,a2 as es,a3 as Jc,a4 as ve,a5 as Zc,a6 as lo,a7 as Xc,a8 as ed,a9 as td,aa as sd,ab as ad,ac as nd,ad as id,ae as co,af as rd,ag as od,ah as uo,ai as ld,aj as cd,ak as dd,al as ud,am as hd,an as pd,ao as ho,ap as md,aq as gd,ar as po,as as De,at as Nt,au as le,av as hi,aw as xs,ax as ht,ay as we,az as ct,aA as M,aB as ja,aC as xd,aD as nt,aE as dt,aF as ts,aG as mo,aH as pi,aI as mi,aJ as Wt,aK as fd,aL as go,aM as xo,aN as gi,aO as xi,aP as fi,aQ as vn,aR as jt,aS as jd,aT as Sn,aU as Ms,aV as yd,aW as fo,aX as _d,aY as bd,aZ as vd,a_ as Sd,a$ as wd,b0 as Cd,b1 as Td,b2 as jo,b3 as yo,b4 as _o,b5 as wn,b6 as bo,b7 as kd,b8 as Id,b9 as Ji,ba as $d,bb as Ld,bc as ka,bd as Ad,be as Pd,bf as Nd,bg as Rd,bh as Dd,bi as Md,bj as Fd,bk as Ed,bl as Bd,bm as Od,bn as qd,bo as zd,bp as Ud,bq as Vd,br as Hd,bs as Yd,bt as ji,bu as Zi,bv as Wd,bw as Xi,bx as er,by as Qd,bz as Gd,bA as Zt,bB as Kd,bC as Jd,bD as Zd,bE as Xd,bF as eu,bG as tu,bH as su,bI as au,bJ as nu,bK as iu,bL as ru,bM as yi,bN as vo,bO as So,bP as ou,bQ as lu,bR as cu,bS as du,bT as uu,bU as hu,bV as X,bW as pu,bX as mu,bY as gu,bZ as xu,b_ as fu,b$ as ju}from"./npm-packages-CQCjokhM.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=a(i);fetch(i.href,r)}})();const ye=()=>Ds(),z=oi,yu={error:null},wo=Pt({name:"app",initialState:yu,reducers:{handleError:(t,s)=>{t.error=s.payload}}}),{handleError:en}=wo.actions,_u=wo.reducer,bu=t=>t.app.error,tr={user:null},vu=()=>{document.cookie="csrftoken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},Co=Pt({name:"auth",initialState:tr,reducers:{setUser:(t,s)=>{t.user=s.payload},logout:()=>(vu(),tr)}}),{setUser:Su,logout:Gn}=Co.actions,wu=Co.reducer,aa=t=>t.auth.user,_i=()=>{const t=document.cookie.split(";");let s="";return t.forEach(a=>{a.trim().startsWith("csrftoken=")&&(s=a.split("=")[1])}),s},Cu=async(t,s,a)=>{var i;await $s.waitForUnlock();const n=await Ro(t,s,a);return((i=n.error)==null?void 0:i.status)===404&&(await $s.waitForUnlock(),s.dispatch(en({code:404,message:"Sorry, the page you visited does not exist."}))),n},tn=Je.createApi({reducerPath:"authApi",baseQuery:Cu,endpoints:t=>({login:t.mutation({query:s=>({url:"login/",method:"POST",body:{...s}}),async onQueryStarted(s,{queryFulfilled:a}){try{await a}catch(n){console.error(n)}}}),logout:t.mutation({query:()=>({url:"logout/",method:"POST",headers:{"X-CSRFToken":_i()},body:{}}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){try{await n,a(Gn())}catch(i){console.error(i),a(Gn())}}})})}),{useLoginMutation:Tu,useLogoutMutation:To}=tn,Ae={apiRoot:"https://127.0.0.1",apiVersion:"v2",repoUrl:"https://gitlab-pub.yadro.com/testy/testy",bugReportUrl:"https://gitlab-pub.yadro.com/testy/testy/-/issues",appName:"TestY",estimateTooltip:"Example formats: 120, 1d 1h 1m 1s, 2 days, 4:13:02 (uptime format), 4:13:02.266, 5hr34m56s, 5 hours, 34 minutes, 56 seconds",pageSizeOptions:["10","20","50","100"],defaultTreePageSize:99,defaultLang:"en",debugCss:!1},Oe={primary:"var(--y-grey-50)",accent:"var(--y-interactive-default)",error:"var(--y-error-block)",success:"var(--y-success-block)",warning:"var(--y-warning-block)",untested:"var(--y-sky-20)",passed:"var(--y-graph-primary)",failed:"var(--y-graph-tertiary)",skipped:"var(--y-graph-sixth)",broken:"var(--y-grey-80)",bloked:"var(--y-graph-fourth)",retest:"#FFE500"},Ba=t=>t.format("YYYY-MM-DD").toString(),bi=t=>typeof t=="object"&&t!=null&&"status"in t,Kn=(t,s=[])=>{const a=t.map(i=>({...i,key:`TS${i.id}`,title:i.name,icon:e.jsx(Mc,{}),children:Kn(i.children,i.test_cases)})),n=s.map(i=>({key:String(i.id),title:i.name,icon:e.jsx(no,{}),labels:i.labels,is_archive:i.is_archive}));return a.concat(n)},ko=t=>{const s=[];return t.map(a=>{const n={key:a.id,title:a.data,value:a.id};if(a.group_name==="")s.push(n);else{const i=s.findIndex(r=>r.title===a.group_name);i===-1?s.push({key:a.group_name,title:a.group_name,value:a.group_name,children:[n]}):s[i].children.push(n)}}),s},Oa=()=>Math.random().toString(16).slice(2),Xs=class Xs{static filterRows(s,a,n={isAllExpand:!0,isShowChildren:!0}){const i=a.toLowerCase(),r=(d,u)=>{var m,g;const p=u.title.toLowerCase();if(p.includes(i)&&!((m=u.children)!=null&&m.length))return d.push(u),d;if((g=u.children)!=null&&g.length){const f=u.children.reduce(r,[]);f.length?d.push({...u,children:f}):p.includes(i)&&d.push({...u,children:n.isShowChildren?u.children:[]})}return d},o=(d,u)=>{var m,g;if(u.title.toLowerCase().includes(i)&&!((m=u.children)!=null&&m.length))return d.push(String(u.key)),d;if((g=u.children)!=null&&g.length){const f=u.children.reduce(o,[]);if(!f.length)return n.isAllExpand&&d.push(String(u.key)),d;d.push(String(u.key),...f)}return d},c=s.reduce(r,[]),l=c.reduce(o,[]);return[c,l]}};xe(Xs,"deleteChildren",s=>{var n;const a=s;for(let i=a.length;i--;i>0)a[i].children&&((n=a[i].children)!=null&&n.length?Xs.deleteChildren(a[i].children??[]):delete a[i].children);return s}),xe(Xs,"deleteNode",(s,a)=>s.filter(n=>n.id!==a).map(n=>n.children.length!==0?{...n,children:Xs.deleteNode(n.children,a)}:n));let sn=Xs;const Hs=(t,s)=>Number(t.toFixed(s)),vi=async t=>({url:await new Promise(a=>{const n=new FileReader;n.readAsDataURL(t.originFileObj),n.onload=()=>a(String(n.result))}),file:t.originFileObj}),Se=t=>{console.error(t),H.error({message:"Error!",description:"Internal server error. Showing in console log."})},Si=t=>t.charAt(0).toUpperCase()+t.slice(1);function $t(t,s,a="id"){return t?[{type:s,id:"LIST"},...t.map(n=>({type:s,id:n[a]}))]:[{type:s,id:"LIST"}]}function Ge(t,s,a="id"){return t?[{type:s,id:"LIST"},{type:s,id:t[a]}]:[{type:s,id:"LIST"}]}const Io=t=>t==="true",ya=(t,s)=>{if(Array.isArray(t)&&Array.isArray(s))return t.length===s.length&&t.every(a=>s.includes(a));if(typeof t=="object"&&typeof s=="object"){const a=Object.keys(t),n=Object.keys(s);return a.length===n.length&&a.every(i=>ya(t[i],s[i]))}return t===s},sr=t=>{const s={...t};for(const a in s)(s[a]===void 0||s[a]===null||s[a]==="")&&delete s[a];return s},Jn=t=>t.split(",").filter(s=>s.length),Ls=t=>Jn(t).map(Number),$o=t=>s=>`${t}-${s}`,ps=t=>{const s={};let a=!0;const n={};for(let i=0;i<t.length;i++){const r=t[i].name.trimStart().trimEnd(),o=t[i].value.toString(),c=t[i].type,l=!!t[i].required;if(r===""||o===""&&l){n[t[i].id]={name:r===""?"Required":"",value:o===""&&l?"Required":""},a=!1;continue}if(o===""&&l){n[t[i].id]={...n[t[i].id],value:"Required"},a=!1;continue}if(o!=="")if(c==="JSON")try{s[r]=JSON.parse(o)}catch{n[t[i].id]={...n[t[i].id],value:"JSON parse error"},a=!1;continue}else c==="List"?s[r]=o.split(/\r?\n/):c==="Text"&&(s[r]=t[i].value)}return{attributesJson:s,isSuccess:a,errors:n}},ku=t=>{localStorage.setItem("prevPageUrl",t)},Iu=()=>localStorage.getItem("prevPageUrl"),$u=()=>{localStorage.removeItem("prevPageUrl")},an=()=>localStorage.getItem("lang")??"en",Lo=(t,s)=>{localStorage.setItem(t,JSON.stringify(s))},nn=t=>{const s=localStorage.getItem(t);return s?JSON.parse(s):void 0},Ao=(t,s)=>{sessionStorage.setItem(t,s)},Po=t=>sessionStorage.getItem(t),ar={tests:{name:"case_name",assignee_username:"assignee"},plans:{title:"name",action_timestamp:"history_date"}},wi=(t,s)=>{if(Array.isArray(t)||!t.order)return"";let a=t.field;return s&&Object.keys(ar[s]).length&&(a=ar[s][a]||a),t.order==="ascend"?a:t.order==="descend"?`-${a}`:""},$s=new li,No=t=>Je.fetchBaseQuery({baseUrl:t,credentials:"include",prepareHeaders:s=>{const a=_i();return a&&s.set("X-CSRFToken",a),s}}),nr=No(`${Ae.apiRoot}/api/${Ae.apiVersion}/`),Ro=No(`${Ae.apiRoot}/auth/`),pt=async(t,s,a)=>{var i,r,o,c;await $s.waitForUnlock();let n=await nr(t,s,a);if(((i=n.error)==null?void 0:i.status)===404&&(await $s.waitForUnlock(),s.dispatch(en({code:404,message:"Sorry, the page you visited does not exist."}))),((r=n==null?void 0:n.error)==null?void 0:r.status)===403&&((o=n==null?void 0:n.meta)==null?void 0:o.request.redirect)!=="manual"&&s.dispatch(en({code:403,message:"You do not have permission to access this page."})),((c=n==null?void 0:n.error)==null?void 0:c.status)===401&&window.location.pathname!=="/login")if($s.isLocked())await $s.waitForUnlock(),n=await nr(t,s,a);else{const l=await $s.acquire();try{await Ro("logout/",s,a)}finally{ku(window.location.pathname),window.location.href="/login",s.dispatch(Gn()),l()}}return n},Mt="users",rn=Je.createApi({reducerPath:"usersApi",tagTypes:["User","Profile","Config"],baseQuery:pt,endpoints:t=>({getConfig:t.query({query:()=>`${Mt}/me/config/`,providesTags:()=>["Config"]}),updateConfig:t.mutation({query:s=>({url:`${Mt}/me/config/`,method:"PATCH",body:s}),invalidatesTags:["Config"]}),getUsers:t.query({query:s=>({url:`${Mt}/`,params:s}),providesTags:()=>[{type:"User",id:"LIST"}]}),getUserById:t.query({query:s=>({url:`${Mt}/${s}/`}),providesTags:(s,a,n)=>[{type:"User",id:n}]}),getMe:t.query({query:()=>`${Mt}/me/`,providesTags:()=>[{type:"Profile"}],async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){try{const{data:i}=await n;a(Su(i))}catch(i){console.error(i)}}}),updateMe:t.mutation({query:s=>({url:`${Mt}/me/`,method:"PATCH",body:s}),invalidatesTags:[{type:"Profile"}]}),updatePassword:t.mutation({query:s=>({url:`${Mt}/change-password/`,method:"POST",body:s}),invalidatesTags:[{type:"Profile"}]}),createUser:t.mutation({query:s=>({url:`${Mt}/`,method:"POST",body:s}),invalidatesTags:[{type:"User",id:"LIST"}]}),updateUser:t.mutation({query:({id:s,body:a})=>({url:`${Mt}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"User")}),deleteUser:t.mutation({query:s=>({url:`${Mt}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"User",id:"LIST"}]}),uploadAvatar:t.mutation({query:s=>({url:`${Mt}/me/avatar/`,method:"POST",body:s}),invalidatesTags:[{type:"Profile"}]}),deleteAvatar:t.mutation({query:()=>({url:`${Mt}/me/avatar/`,method:"DELETE"}),invalidatesTags:[{type:"Profile"}]})})}),{useGetUsersQuery:Lu,useLazyGetUserByIdQuery:Au,useLazyGetUsersQuery:Do,useCreateUserMutation:Pu,useUpdateUserMutation:Nu,useDeleteUserMutation:Ru,useGetMeQuery:Du,useLazyGetMeQuery:Mu,useGetConfigQuery:Fu,useLazyGetConfigQuery:Eu,useUpdateMeMutation:Bu,useUpdatePasswordMutation:Ou,useUpdateConfigMutation:qu,useUploadAvatarMutation:zu,useDeleteAvatarMutation:Uu}=rn,Vu={ui:{is_open_sidebar:!0,drawer_size_test_case_details:500,drawer_size_test_result_details:500,graph_base_type:"pie",graph_base_bar_type:"by_time",graph_base_bar_attribute_input:"",test_plan:{},test_plan_estimate_everywhere_period:"minutes"},projects:{is_only_favorite:!1,is_show_archived:!1,favorite:[]},test_plans:{is_show_archived:!1,is_cases_filter_open:!1,filters:{}},test_suites:{filters:{}},test_cases:{is_show_archived:!1}},Hu={userModal:null,userConfig:Vu,modal:{isShow:!1,isEditMode:!1},modalProfile:{isShow:!1}},Mo=Pt({name:"user",initialState:Hu,reducers:{setUserModal:(t,s)=>{t.userModal=s.payload},setUserConfig:(t,s)=>{t.userConfig=s.payload},showCreateUserModal:t=>{t.modal.isShow=!0},showEditUserModal:t=>{t.modal.isShow=!0,t.modal.isEditMode=!0},hideModal:t=>{t.modal.isShow=!1,t.modal.isEditMode=!1},showEditProfileModal:t=>{t.modalProfile.isShow=!0},hideEditProfileModal:t=>{t.modalProfile.isShow=!1}}}),{setUserModal:Yu,setUserConfig:Wu,showCreateUserModal:Qu,showEditUserModal:Gu,hideModal:Ku,showEditProfileModal:Ju,hideEditProfileModal:Zu}=Mo.actions,Xu=t=>t.user.modal.isShow,eh=t=>t.user.modal.isEditMode,Fo=t=>t.user.userModal,th=t=>t.user.userConfig,sh=t=>t.user.modalProfile.isShow,ah=Mo.reducer,nh=(t,s=[])=>{const a=Object.keys(t).filter(n=>!s.includes(n)).reduce((n,i)=>(n[i]=t[i],n),{});return JSON.stringify(a)==="{}"?null:a},Eo=({isDirty:t,pathname:s})=>{const a=h.useRef(!1);return h.useEffect(()=>{const i=r=>{t&&(r.preventDefault(),r.returnValue="")};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i)}},[t]),Fc(({currentLocation:i,nextLocation:r})=>t&&i.pathname.includes(s)&&i.pathname!==r.pathname&&!a.current?!confirm("Are you sure? All changes will be lost."):!1),{setIsRedirectByUser:()=>{a.current=!0}}};K.extend(Ec);K.extend(Bc);const Ci=()=>{const[t,s]=h.useState(K()),[a,n]=h.useState(K());return{dateTo:t,dateFrom:a,setDateTo:s,setDateFrom:n,disabledDateFrom:o=>o.isSameOrAfter(t),disabledDateTo:o=>o.isSameOrBefore(a)}};function Fs(t,s,a=!1){const[n,i]=h.useState(t),[r,o]=h.useState(a);return h.useEffect(()=>{const c=setTimeout(()=>{if(r){o(!1);return}i(t)},s??500);return()=>{clearTimeout(c)}},[t,s]),n}const We=t=>({onHandleError:a=>{var n;if(bi(a))if(a!=null&&a.status&&(a.status===400||a.status===403)){let i=a.data;a.status===403&&(i={errors:[(n=a.data)==null?void 0:n.detail]}),t(i)}else Se(a);else Se(a)}}),ih="Escape",ir="keyup",rh=(t=!1)=>{const[s,a]=h.useState(t),n=()=>{a(!1)},i=()=>{a(!0)},r=h.useCallback(o=>{o.key===ih&&n()},[n]);return h.useEffect(()=>(document.addEventListener(ir,r,!1),()=>{document.removeEventListener(ir,r,!1)}),[r]),{handleClose:n,handleShow:i,isShow:s}},Ti=(t,s,a=!0,n=[])=>{const i=h.useCallback(r=>{const o=t==null?void 0:t.current;if(!o)return;const c=r==null?void 0:r.target,l=n.some(d=>c==null?void 0:c.closest(d));o.contains(c??null)||l||s(r)},[t,s]);h.useEffect(()=>{if(a)return document.addEventListener("mousedown",i),document.addEventListener("touchstart",i),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}},[t,s,a]),h.useEffect(()=>{a||(document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i))},[a])},oh=({elRef:t,onResize:s})=>{h.useEffect(()=>{if(!t.current)return;const a=new ResizeObserver(()=>{t.current&&s(t,t.current.offsetWidth)});return a.observe(t.current),()=>a.disconnect()},[])},rr=(t,s)=>{const a=localStorage.getItem(t);return a===null?null:(s==null?void 0:s(a))??a},Es=(t,s,a)=>{const[n,i]=h.useState(rr(t,a)??s),r=o=>{i(o),localStorage.setItem(t,String(o))};return h.useEffect(()=>{const o=rr(t,a);i(o??s)},[]),[n,r]},Bo=({key:t,elRef:s,defaultWidth:a,minWidth:n,maxWidth:i,maxAsPercent:r=!1,direction:o="right",updater:c})=>{const[l,d]=Es(`${t}-width`,a,Number),u=()=>{document.body.style.cursor="ew-resize",document.body.style.userSelect="none"},p=()=>{document.body.style.removeProperty("cursor"),document.body.style.removeProperty("user-select")};return{handleMouseDown:f=>{const x=s.current;if(!x)return;const y=f.clientX,j=window.getComputedStyle(x),_=parseInt(j.width,10),w=S=>{const C=o==="right"?S.clientX-y:y-S.clientX,v=_+C,k=r?document.body.clientWidth/100*i:i,$=Math.min(Math.max(v,n),k);c==null||c($),d($),u()},b=()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",b),p()};document.addEventListener("mousemove",w),document.addEventListener("mouseup",b)},setWidth:f=>{const x=s.current;x&&(x.style.width=`${f}px`,d(f))},width:l}},Ot=()=>{const{t}=T();return{showModal:a=>{he.confirm({title:t("Do you want to close?"),content:t("You will lose your data if you continue!"),okText:t("Ok"),cancelText:t("Cancel"),onOk:()=>a(),okButtonProps:{"data-testid":"button-confirm"},cancelButtonProps:{"data-testid":"button-cancel"}})}}},Oo=({attributes:t})=>{const s=a=>typeof a=="string"?e.jsx(At,{content:a}):Array.isArray(a)?e.jsx(At,{content:a.join(`\r
`)}):JSON.stringify(a,null,2);return e.jsx(e.Fragment,{children:Object.keys(t).map(a=>e.jsxs("div",{children:[e.jsx(je,{orientation:"left",style:{margin:0,fontSize:14},children:e.jsx("span",{id:"attribute-name",children:a})}),e.jsx("div",{style:{padding:8},children:e.jsx(G,{children:e.jsx(G.Paragraph,{children:e.jsx(G.Text,{style:{whiteSpace:"pre-wrap"},id:"attribute-desc",children:s(t[a])})})})})]},a))})},lh="testy-frontend",ch="2.0.5",dh="module",uh={start:"vite --host 0.0.0.0",build:"tsc && vite build",preview:"vite preview",fix:"npm run fix:prettier && npm run fix:eslint","fix:eslint":"eslint --fix src","fix:prettier":"prettier --write src",lint:"npm run lint:prettier && npm run lint:eslint","lint:eslint":"eslint src","lint:prettier":"prettier --check src",prepare:"husky install"},hh={hooks:{"pre-commit":"lint-staged"}},ph={"@ant-design/icons":"^5.2.6","@ant-design/pro-layout":"^7.17.16","@dnd-kit/core":"^6.1.0","@dnd-kit/modifiers":"^7.0.0","@dnd-kit/sortable":"^8.0.0","@reduxjs/toolkit":"^1.9.7",antd:"^5.12.8","async-mutex":"^0.4.0",dayjs:"^1.11.10",immer:"^10.1.1",react:"^18.2.0","react-dom":"^18.2.0","react-highlight-words":"^0.20.0","react-hook-form":"^7.49.3","react-i18next":"^15.0.1","react-image-crop":"^10.1.8","react-intersection-observer":"^9.5.3","react-markdown":"^8.0.7","react-redux":"^8.1.3","react-rnd":"^10.4.13","react-router-dom":"^6.23.0","react-router-hash-link":"^2.4.3","react-sortablejs":"^6.1.4","react-syntax-highlighter":"^15.5.0",recharts:"^2.10.3","redux-persist":"^6.0.0","remark-gfm":"3.0.1",sortablejs:"^1.15.1",uuid:"^9.0.1"},mh={"@trivago/prettier-plugin-sort-imports":"^4.3.0","@types/node":"^20.10.7","@types/react":"^18.2.47","@types/react-dom":"^18.2.18","@types/react-highlight-words":"^0.16.7","@types/react-router-hash-link":"^2.4.9","@types/react-syntax-highlighter":"^15.5.11","@types/uuid":"^9.0.7","@typescript-eslint/eslint-plugin":"^6.18.1","@typescript-eslint/parser":"^6.18.1","@vitejs/plugin-react":"^4.2.1",eslint:"^8.56.0","eslint-plugin-react":"^7.33.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-react-refresh":"^0.4.5",husky:"^8.0.3",less:"^4.2.0",prettier:"^3.1.1",typescript:"^5.3.3","typescript-plugin-css-modules":"^5.1.0",vite:"^5.0.11","vite-plugin-svgr":"^4.2.0","vite-tsconfig-paths":"^4.2.3"},gh={name:lh,private:!0,version:ch,type:dh,scripts:uh,husky:hh,"lint-staged":{"*.(ts|tsx)":["npm run fix"]},dependencies:ph,devDependencies:mh},qo=()=>{const{t}=T();return e.jsxs("p",{style:{textAlign:"center",marginBottom:0,fontSize:12},children:[e.jsxs("a",{target:"_blank",href:Ae.repoUrl,rel:"noreferrer",children:["TestY TMS ",t("version")," ",gh.version]}),". ",t("Released under the AGPL-v3 License"),".",e.jsx("br",{}),t("Found a bug or have a comment?"),"  ",t("Please report an")," ",e.jsx("a",{target:"_blank",rel:"noreferrer",href:Ae.bugReportUrl,children:t("issue")})," ",t("or")," ",e.jsx("a",{href:"mailto:testy@yadro.com",children:t("email us")})," .",e.jsx("br",{}),t("Copyright")," © ",new Date().getFullYear()," ",e.jsx("a",{target:"_blank",href:"https://yadro.com",rel:"noreferrer",children:"KNS Group LLC (YADRO)."})]})},Lt=({searchWords:t,textToHighlight:s,backgroundColor:a="#d9d9d9",color:n=Oe.accent})=>e.jsx(Oc,{autoEscape:!0,highlightStyle:{backgroundColor:a,color:n,padding:0},searchWords:[t],textToHighlight:s??""}),At=({content:t,...s})=>e.jsx(qc,{children:t,linkTarget:"_blank",components:{img:({...a})=>e.jsx("a",{href:a.src,target:"blank",children:e.jsx("img",{...a})}),code({inline:a,className:n="",children:i,...r}){const o=/language-(\w+)/.exec(n);return!a&&o?e.jsx(zc,{...r,children:String(i).replace(/\n$/,""),style:Uc,language:o[1],PreTag:"div"}):e.jsx("code",{...r,className:n,children:i})},p:({children:a})=>e.jsx("p",{style:{whiteSpace:"pre-wrap"},children:a})},remarkPlugins:[Vc],...s}),xh="_item_a2ogo_1",fh="_icon_a2ogo_19",jh="_content_a2ogo_43",yh="_actions_a2ogo_59",_h="_fieldUl_a2ogo_79",bh="_scenarioBtn_a2ogo_95",vh="_fieldItem_a2ogo_111",Sh="_fieldWrapper_a2ogo_133",wh="_fieldIcon_a2ogo_147",Ch="_fieldContent_a2ogo_181",Th="_arrowIcon_a2ogo_197",kh="_resultFieldItem_a2ogo_207",Ih="_resultFieldIcon_a2ogo_225",$h="_resultSelect_a2ogo_253",Lh="_resultModalFieldWrapper_a2ogo_263",Ah="_resultModalFieldContent_a2ogo_275",Ph="_resultStatus_a2ogo_291",Nh="_resultFieldWrapper_a2ogo_299",Rh="_resultFieldContent_a2ogo_313",Te={item:xh,icon:fh,content:jh,actions:yh,fieldUl:_h,scenarioBtn:bh,fieldItem:vh,fieldWrapper:Sh,fieldIcon:wh,fieldContent:Ch,arrowIcon:Th,resultFieldItem:kh,resultFieldIcon:Ih,resultSelect:$h,resultModalFieldWrapper:Lh,resultModalFieldContent:Ah,resultStatus:Ph,resultFieldWrapper:Nh,resultFieldContent:Rh},Dh=({step:t})=>e.jsxs("li",{id:`step-item-${t.name}`,className:Te.fieldItem,children:[e.jsx("div",{className:Te.fieldIcon,children:t.sort_order}),e.jsx("div",{className:Te.fieldWrapper,children:e.jsx(Ki,{ghost:!0,style:{padding:0,margin:0},children:e.jsxs(Ki.Panel,{id:"steps-collapse",className:"collapse-wrapper",header:e.jsx(G.Title,{level:5,style:{marginTop:0,marginBottom:0},children:t.name}),children:[e.jsxs("div",{className:Te.fieldContent,children:[e.jsx(je,{orientation:"left",style:{margin:0,marginTop:14},orientationMargin:0,children:"Scenario"}),e.jsx("div",{className:"content markdown",children:e.jsx(At,{content:t.scenario})})]}),t.expected&&e.jsxs("div",{className:Te.fieldContent,children:[e.jsx(je,{orientation:"left",style:{margin:0,marginTop:0},orientationMargin:0,children:"Expected"}),e.jsx("div",{className:"content markdown",children:e.jsx(At,{content:t.expected??""})})]}),!!t.attachments.length&&e.jsx("div",{style:{marginTop:14},"data-testid":`${t.name}-step-attachments-list`,children:e.jsx(mt.Field,{attachments:t.attachments})})]},"1")})})]}),Mh=({steps:t})=>{const{t:s}=T();return e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:s("Steps")}),e.jsx("ul",{style:{paddingLeft:0,marginTop:8},children:t.map(a=>e.jsx(Dh,{step:a},a.id))})]})},Fh=({index:t,actions:s,step:a})=>e.jsxs("li",{className:Te.item,children:[e.jsx("div",{className:Te.icon,children:t+1}),e.jsx("p",{className:Te.content,children:a.name}),s&&e.jsxs("div",{className:Te.actions,children:[e.jsx(L,{id:`${a.name}-edit`,onClick:()=>s.onClickEdit(a),shape:"circle",icon:e.jsx(Ke,{})}),e.jsx(L,{id:`${a.name}-delete`,danger:!0,shape:"circle",onClick:()=>s.onClickDelete(a.id),icon:e.jsx(ut,{})}),e.jsx(L,{id:`${a.name}-move`,className:"handle",style:{border:"0"},icon:e.jsx(Hc,{})})]})]},a.id),Eh=({stepsResult:t})=>e.jsx("ul",{className:Te.fieldUl,children:[...t].sort((s,a)=>s.sort_order-a.sort_order).map(s=>e.jsxs("li",{id:`step-item-${s.name}`,className:Te.resultFieldItem,children:[e.jsx("div",{className:Te.resultFieldIcon,children:s.sort_order}),e.jsx("div",{className:Te.resultFieldWrapper,children:e.jsx("span",{children:s.name})}),e.jsx("div",{className:Te.resultStatus,children:e.jsx(Rt,{name:s.status_text,id:s.status,color:s.status_color})})]},s.id))}),or="system",_a=Je.createApi({reducerPath:"systemApi",baseQuery:pt,tagTypes:["SystemMessages","SystemStatistic"],endpoints:t=>({getSystemMessages:t.query({query:()=>`${or}/messages/`,providesTags:s=>$t(s,"SystemMessages")}),getSystemStats:t.query({query:()=>`${or}/statistics/`,providesTags:[{type:"SystemStatistic",id:"LIST"}]})})}),It=_a.util.invalidateTags([{type:"SystemStatistic",id:"LIST"}]),{useGetSystemMessagesQuery:Bh,useGetSystemStatsQuery:OI}=_a,qa="labels",ba=Je.createApi({reducerPath:"labelApi",baseQuery:pt,tagTypes:["Label"],endpoints:t=>({getLabels:t.query({query:s=>({url:`${qa}/`,params:s}),providesTags:s=>$t(s,"Label")}),createLabel:t.mutation({query:s=>({url:`${qa}/`,method:"POST",body:s}),invalidatesTags:[{type:"Label",id:"LIST"}]}),updateLabel:t.mutation({query:({id:s,body:a})=>({url:`${qa}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Label")}),deleteLabel:t.mutation({query:s=>({url:`${qa}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"Label",id:"LIST"}]})})}),Zs=ba.util.invalidateTags([{type:"Label",id:"LIST"}]),{useGetLabelsQuery:ki,useCreateLabelMutation:Oh,useUpdateLabelMutation:qh,useDeleteLabelMutation:zh}=ba,za="tests",ms=Je.createApi({reducerPath:"testApi",baseQuery:pt,tagTypes:["Test"],endpoints:t=>({getTest:t.query({query:s=>({url:`${za}/${s}/`}),providesTags:(s,a,n)=>[{type:"Test",id:n}]}),getTests:t.query({query:s=>({url:`${za}/`,params:s}),providesTags:()=>[{type:"Test",id:"LIST"}]}),updateTest:t.mutation({query:({id:s,body:a})=>({url:`${za}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Test"),async onQueryStarted({id:s},{dispatch:a,queryFulfilled:n}){await n,a(Be.util.invalidateTags([{type:"TestPlanTest",id:s}]))}}),bulkUpdate:t.mutation({query:s=>({url:`${za}/bulk-update/`,method:"PUT",body:s}),async onQueryStarted({current_plan:s,plan:a},{dispatch:n,queryFulfilled:i}){await i,n(Be.util.invalidateTags([{type:"TestPlanStatistics",id:s}])),n(Be.util.invalidateTags([{type:"TestPlanHistogram",id:s},{type:"TestPlanHistogram",id:a}])),n(Be.util.invalidateTags([{type:"TestPlanLabels",id:"LIST"},{type:"TestPlanLabels",id:a}])),n(Be.util.invalidateTags([{type:"TestPlanCasesIds",id:s},{type:"TestPlanCasesIds",id:a}])),n(Be.util.invalidateTags([{type:"TestPlanTest",id:"LIST"},{type:"TestPlanTest",id:s}]))},invalidatesTags:s=>Ge(s,"Test")})})}),{useGetTestQuery:Uh,useLazyGetTestsQuery:qI,useLazyGetTestQuery:zI,useUpdateTestMutation:Vh,useBulkUpdateMutation:Hh,useGetTestsQuery:Yh}=ms,Fe="testplans",Be=Je.createApi({reducerPath:"testPlanApi",baseQuery:pt,tagTypes:["TestPlan","TestPlanTest","TestPlanAncestors","TestPlanStatistics","TestPlanLabels","TestPlanCasesIds","TestPlanHistogram","TestPlanStatuses"],endpoints:t=>({getTestPlans:t.query({query:s=>({url:`${Fe}/`,params:s}),providesTags:s=>s?[...s.results.map(({id:a})=>({type:"TestPlan",id:a})),{type:"TestPlan",id:"LIST"}]:[{type:"TestPlan",id:"LIST"}]}),getTestPlansWithTests:t.query({query:s=>({url:`${Fe}/union/`,params:s}),providesTags:s=>s?[...s.results.map(({id:a})=>({type:"TestPlan",id:a})),{type:"TestPlan",id:"LIST"}]:[{type:"TestPlan",id:"LIST"}]}),getTestPlanAncestors:t.query({query:({project:s,id:a,...n})=>({url:`${Fe}/${a}/ancestors/`,params:{project:s,...n}}),providesTags:s=>s?[...s.map(a=>({type:"TestPlanAncestors",id:a})),{type:"TestPlanAncestors",id:"LIST"}]:[{type:"TestPlanAncestors",id:"LIST"}]}),getTestPlan:t.query({query:({testPlanId:s,...a})=>({url:`${Fe}/${s}/`,params:a}),providesTags:(s,a,{testPlanId:n})=>[{type:"TestPlan",id:String(n)}]}),getTestPlanActivity:t.query({query:({testPlanId:s,...a})=>({url:`${Fe}/${s}/activity/`,params:a}),providesTags:(s,a,{testPlanId:n})=>[{type:"TestPlan",id:n}]}),deleteTestPlan:t.mutation({query:s=>({url:`${Fe}/${s}/`,method:"DELETE"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:[{type:"TestPlan",id:"LIST"}]}),archiveTestPlan:t.mutation({query:s=>({url:`${Fe}/${s}/archive/`,method:"POST"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:(s,a,n)=>[{type:"TestPlan",id:"LIST"},{type:"TestPlan",id:n}]}),createTestPlan:t.mutation({query:s=>({url:`${Fe}/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:s=>Ge(s==null?void 0:s[0],"TestPlan")}),updateTestPlan:t.mutation({query:({id:s,body:a})=>({url:`${Fe}/${s}/`,method:"PATCH",body:a,redirect:"manual"}),async onQueryStarted({id:s},{dispatch:a,queryFulfilled:n}){await n,a(Be.util.invalidateTags([{type:"TestPlanTest",id:s},{type:"TestPlanTest",id:"LIST"}])),a(Be.util.invalidateTags([{type:"TestPlanStatistics",id:s}])),a(Be.util.invalidateTags([{type:"TestPlanHistogram",id:s}])),a(Be.util.invalidateTags([{type:"TestPlanLabels",id:"LIST"}])),a(Be.util.invalidateTags([{type:"TestPlanCasesIds",id:s}])),a(ms.util.invalidateTags([{type:"Test",id:"LIST"}])),a(Zs),a(It)},invalidatesTags:s=>Ge(s,"TestPlan")}),getTestPlanStatistics:t.query({query:s=>({url:`${Fe}/statistics/`,params:s}),providesTags:(s,a,{project:n,parent:i})=>[{type:"TestPlanStatistics",id:`${n}-${i}`}]}),getTestPlanHistogram:t.query({query:s=>({url:`${Fe}/histogram/`,params:s}),providesTags:(s,a,{project:n,parent:i})=>[{type:"TestPlanHistogram",id:`${n}-${i}`}]}),getTestPlanLabels:t.query({query:s=>({url:`${Fe}/labels/`,params:s}),providesTags:()=>[{type:"TestPlanLabels",id:"LIST"}]}),getTestPlanTests:t.query({query:({testPlanId:s,...a})=>({url:`${Fe}/${s}/tests/`,params:a}),providesTags:s=>$t(s==null?void 0:s.results,"TestPlanTest")}),getTestPlanSuites:t.query({query:s=>({url:`${Fe}/suites/`,params:{show_descendants:!0,...s}})}),getDescendantsTree:t.query({query:s=>({url:`${Fe}/descendants-tree/`,params:s})}),getTestPlanCases:t.query({query:({testPlanId:s,include_children:a=!1})=>({url:`${Fe}/${s}/cases/`,params:{include_children:a}}),providesTags:(s,a,{testPlanId:n})=>[{type:"TestPlanCasesIds",id:n}]}),getTestPlanDeletePreview:t.query({query:s=>({url:`${Fe}/${s}/delete/preview/`}),providesTags:(s,a,n)=>[{type:"TestPlan",id:n}]}),getTestPlanArchivePreview:t.query({query:s=>({url:`${Fe}/${s}/archive/preview/`}),providesTags:(s,a,n)=>[{type:"TestPlan",id:n}]}),сopyTestPlan:t.mutation({query:s=>({url:`${Fe}/copy/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:[{type:"TestPlan",id:"LIST"}]}),getTestPlanStatuses:t.query({query:s=>`${Fe}/${s}/statuses/`,providesTags:(s,a,n)=>[{type:"TestPlanStatuses",id:n}]}),getTestPlanActivityStatuses:t.query({query:s=>`${Fe}/${s}/activity/statuses/`,providesTags:(s,a,n)=>[{type:"TestPlanStatuses",id:n}]}),getBreadcrumbs:t.query({query:s=>({url:`${Fe}/${s}/breadcrumbs/`})})})}),Wh=t=>Be.util.invalidateTags([{type:"TestPlan",id:"LIST"}]),da=Be.util.invalidateTags([{type:"TestPlanLabels",id:"LIST"}]),Qh=t=>Be.util.invalidateTags([{type:"TestPlanStatuses",id:t}]),{useGetTestPlanQuery:Gh,useLazyGetTestPlanQuery:Kh,useLazyGetTestPlansQuery:Cn,useLazyGetTestPlansWithTestsQuery:Jh,useGetTestPlanAncestorsQuery:UI,useLazyGetTestPlanAncestorsQuery:na,useCreateTestPlanMutation:Zh,useDeleteTestPlanMutation:Xh,useGetTestPlanStatisticsQuery:zo,useUpdateTestPlanMutation:ep,useLazyGetTestPlanSuitesQuery:tp,useGetTestPlanLabelsQuery:VI,useLazyGetTestPlanActivityQuery:sp,useGetTestPlanCasesQuery:ap,useGetTestPlanDeletePreviewQuery:np,useGetTestPlanArchivePreviewQuery:ip,useArchiveTestPlanMutation:rp,useGetTestPlanHistogramQuery:op,useСopyTestPlanMutation:lp,useLazyGetTestPlanActivityStatusesQuery:cp,useLazyGetTestPlanStatusesQuery:dp,useGetBreadcrumbsQuery:up,useGetTestPlanTestsQuery:hp,useLazyGetDescendantsTreeQuery:pp}=Be,Ft="projects",on=Je.createApi({reducerPath:"projectApi",tagTypes:["Project"],baseQuery:pt,endpoints:t=>({getProjects:t.query({query:({favorites:s=!1,...a})=>({url:`${Ft}/`,params:{favorites:s,...a}}),providesTags:()=>[{type:"Project",id:"LIST"}]}),getProject:t.query({query:s=>`${Ft}/${s}/`,providesTags:(s,a,n)=>[{type:"Project",id:n}]}),createProject:t.mutation({query:s=>({url:`${Ft}/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:[{type:"Project",id:"LIST"}]}),updateProject:t.mutation({query:({id:s,body:a})=>({url:`${Ft}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Project")}),updateProjectJson:t.mutation({query:({id:s,body:a})=>({url:`${Ft}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Project")}),deleteProject:t.mutation({query:s=>({url:`${Ft}/${s}/`,method:"DELETE"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:[{type:"Project",id:"LIST"}]}),archiveProject:t.mutation({query:s=>({url:`${Ft}/${s}/archive/`,method:"POST"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It),a(Wh())},invalidatesTags:(s,a,n)=>[{type:"Project",id:Number(n)},{type:"Project",id:"LIST"}]}),getProjectDeletePreview:t.query({query:s=>({url:`${Ft}/${s}/delete/preview/`})}),getProjectArchivePreview:t.query({query:s=>({url:`${Ft}/${s}/archive/preview/`}),providesTags:(s,a,n)=>[{type:"Project",id:n}]}),getProjectProgress:t.query({query:({projectId:s,period_date_end:a,period_date_start:n})=>({url:`${Ft}/${s}/progress/`,method:"GET",params:{end_date:a,start_date:n}}),providesTags:(s,a,{projectId:n})=>[{type:"Project",id:n}]}),getMembers:t.query({query:({id:s,...a})=>({url:`${Ft}/${s}/members/`,params:a})}),requestAccess:t.mutation({query:({id:s,reason:a})=>({url:`${Ft}/${s}/access/`,method:"POST",body:{reason:a}})})})}),{useGetProjectsQuery:Ii,useGetProjectQuery:$i,useLazyGetProjectsQuery:mp,useCreateProjectMutation:gp,useUpdateProjectMutation:xp,useUpdateProjectJsonMutation:Li,useDeleteProjectMutation:fp,useLazyGetProjectProgressQuery:jp,useGetProjectDeletePreviewQuery:yp,useArchiveProjectMutation:_p,useGetProjectArchivePreviewQuery:bp,useGetMembersQuery:vp,useRequestAccessMutation:Sp}=on,Ua="statuses",va=Je.createApi({reducerPath:"statusesApi",baseQuery:pt,tagTypes:["Status"],endpoints:t=>({getStatuses:t.query({query:({project:s})=>({url:`${Ua}/`,params:{project:s}}),providesTags:s=>$t(s,"Status")}),createStatus:t.mutation({query:s=>({url:`${Ua}/`,method:"POST",body:s}),invalidatesTags:[{type:"Status",id:"LIST"}]}),updateStatus:t.mutation({query:({id:s,body:a})=>({url:`${Ua}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Status")}),deleteStatus:t.mutation({query:s=>({url:`${Ua}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"Status",id:"LIST"}]})})}),wp=va.util.invalidateTags([{type:"Status",id:"LIST"}]),{useGetStatusesQuery:Cp,useLazyGetStatusesQuery:Tp,useCreateStatusMutation:kp,useUpdateStatusMutation:Ip,useDeleteStatusMutation:$p}=va,lr="Untested",qt=({project:t,plan:s,isActivity:a})=>{const[n,i]=h.useState([]),[r,o]=h.useState(!1),[c]=Tp(),[l]=dp(),[d]=cp(),{data:u}=$i(Number(t),{skip:!t}),p=async()=>{if(!t)return;o(!0);let v=null;a&&s?v=await d(s):s?v=await l(s):v=await c({project:t}),i((v==null?void 0:v.data)??[]),o(!1)};h.useEffect(()=>{p()},[t,s,a]);const m=v=>({label:v.name,value:v.id,color:v.color,id:v.id}),g=v=>({text:v.name,value:v.id.toString()}),f=n.map(m),x=[...f,{label:lr,value:"null"}],y=n.map(g),j=h.useMemo(()=>[...y,{text:lr,value:"null"}],[n]),_=n.reduce((v,k)=>(v[k.id]=k.name,v),{}),w=n.map(v=>v.id),b=v=>{const k=j.find($=>$.text.toLowerCase()===v.toLowerCase());return(k==null?void 0:k.value)??null},S=v=>n.find(k=>k.id===v)??null,C=u!=null&&u.settings.default_status?S(u.settings.default_status):null;return{statuses:n,statusesOptions:f,statusesObject:_,isLoading:r||n.length===0,allStatusesId:w,getStatusNumberByText:b,getStatusById:S,statusesOptionsWithUntested:x,statusesFilters:y,statusesFiltersWithUntested:j,refetch:p,defaultStatus:C}},Rt=({id:t,name:s,color:a,style:n,extraId:i})=>e.jsx(Ps,{className:"status",color:a,id:`${i?i+"-":""}status-${s}-${t}`,style:n,children:s==null?void 0:s.toUpperCase()}),Ia=()=>e.jsx(Ps,{className:"status",color:"default",id:"status-untested",children:"UNTESTED"}),Lp=({testCase:t,steps:s,setSteps:a})=>{const{t:n}=T(),{statusesOptions:i,getStatusById:r}=qt({project:t.project});if(!t.steps)return e.jsx(e.Fragment,{});const o=(c,l)=>{const d=parseInt(l),u=r(d);u&&a(p=>({...p,[c]:u.id}))};return e.jsx("ul",{style:{paddingLeft:0},className:Te.fieldUl,children:t.steps.map(c=>e.jsxs("li",{id:`step-item-${c.name}`,className:Te.resultFieldItem,children:[e.jsx("div",{className:Te.resultFieldIcon,children:c.sort_order}),e.jsx("div",{className:Te.resultModalFieldWrapper,children:e.jsx("div",{className:Te.resultModalFieldContent,children:e.jsx("div",{children:c.name})})}),e.jsx("div",{className:Te.resultSelect,children:e.jsx(ue,{value:s[c.id],placeholder:n("Please select"),style:{width:"100%"},onSelect:l=>o(c.id,l.toString()),id:`create-result-step-${c.name}`,children:i.map(l=>e.jsx(ue.Option,{value:l.id,children:e.jsx(Rt,{id:l.id,name:l.label,color:l.color,extraId:`create-result-step-${c.name}`})},l.id))})})]},c.id))})},Ap=({stepResultsData:t,stepResults:s,setStepsResult:a,id:n})=>{const{t:i}=T(),{projectId:r}=Q(),{statusesOptions:o}=qt({project:r}),c=(l,d)=>{a({...s,[l]:d})};return t.length?e.jsx("ul",{style:{paddingLeft:0},className:Te.fieldUl,children:[...t].sort((l,d)=>l.sort_order-d.sort_order).map(l=>e.jsxs("li",{id:`step-item-${l.name}`,className:Te.resultFieldItem,children:[e.jsx("div",{className:Te.resultFieldIcon,children:l.sort_order}),e.jsx("div",{className:Te.resultModalFieldWrapper,children:e.jsx("div",{className:Te.resultModalFieldContent,children:e.jsx("div",{children:l.name})})}),e.jsx("div",{className:Te.resultSelect,children:e.jsx(ue,{value:s[l.id]??null,placeholder:i("Please select"),style:{width:"100%"},onSelect:d=>c(String(l.id),d),id:`${n}-result-step-${l.name}`,children:o.map(d=>e.jsx(ue.Option,{value:Number(d.id),children:e.jsx(Rt,{name:d.label,color:d.color,id:d.id,extraId:`${n}-result-step-${l.name}`})},d.id))})})]},l.id))}):e.jsx(e.Fragment,{})},$a={Step:Fh,Field:Mh,Result:Eh,ResultInCreateModal:Lp,ResultInEditModal:Ap},Uo=({data:t,handleCellClick:s,checkActive:a})=>e.jsx(e.Fragment,{children:t.map(n=>e.jsx(Yc,{style:{cursor:"pointer"},fill:n.fill,stroke:a(n.label)&&Oe.accent||void 0,onClick:s?()=>s(n):void 0},`cell-${n.label}`))}),Pp="_legendTitle_118q6_1",Np="_legendValue_118q6_19",Ys={legendTitle:Pp,legendValue:Np},Vo=({data:t,statuses:s,updateStatuses:a,type:n,period:i,onHeightChange:r})=>{const{projectId:o,testPlanId:c}=Q(),{getStatusNumberByText:l,isLoading:d}=qt({project:o,plan:c}),u=h.useRef(null);h.useEffect(()=>{setTimeout(()=>{if(!u.current||!r)return;const w=u.current.querySelector(".recharts-default-legend");w&&r(w.clientHeight+50)},0)},[t]);const p=w=>{if(d)return[];const b=l(w),S=b===null?!1:s.includes(b),C=s.length===1;return S?C?[]:s.filter(v=>v!==b):[...s,b].filter(Boolean)},m=h.useMemo(()=>!t.some(w=>w[n]>0),[t]),g=h.useMemo(()=>m?0:t.reduce((w,b)=>w+b[n],0),[t,m]),f=h.useMemo(()=>t.map(w=>({...w,fill:w.color,[n]:m?1:w[n]})),[t,m,d]),x=h.useCallback((w,b)=>{var N;const S=String(b.payload.label),C=b.payload[n],v=(N=b.payload)==null?void 0:N.percent,k=p(S),$=_(S),I=n==="estimates"?(i==null?void 0:i.slice(0,1))??"m":"",P=()=>{a(k)};return m?e.jsxs("span",{className:Ys.legendTitle,style:{borderBottom:$?`1px solid ${Oe.accent}`:"0"},onClick:P,"data-testid":`pie-legend-title-${S}`,children:[S," ",e.jsxs("span",{className:Ys.legendValue,children:["[0",I,"] (0%)"]})]}):C===0?e.jsxs("span",{className:Ys.legendTitle,style:{borderBottom:$?`1px solid ${Oe.accent}`:"0"},onClick:P,"data-testid":`pie-legend-title-${S}`,children:[S," ",e.jsxs("span",{className:Ys.legendValue,children:["[",C??0,I,"] (0%)"]})]}):e.jsxs("span",{className:Ys.legendTitle,style:{borderBottom:$?`1px solid ${Oe.accent}`:"0"},onClick:P,"data-testid":`pie-legend-title-${S}`,children:[w," ",e.jsxs("span",{className:Ys.legendValue,children:["[",C??0,I,"] (",(v*100).toFixed(2),"%)"]})]})},[m,i,l]),y=h.useCallback(w=>m?0:w,[m]),j=w=>{const b=p(w.label);a(b)},_=w=>{const b=l(w);return(s==null?void 0:s.some(S=>String(S)===b))??!1};return{formatData:f,total:g,legendFormatter:x,tooltipFormatter:y,handleCellClick:j,checkActive:_,chartRef:u}},Rp=({data:t,statuses:s,updateStatuses:a,type:n,height:i=208,onHeightChange:r})=>{const{t:o}=T(),{formatData:c,total:l,legendFormatter:d,tooltipFormatter:u,handleCellClick:p,checkActive:m,chartRef:g}=Vo({data:t??[],statuses:s,updateStatuses:a,type:n,onHeightChange:r});return e.jsx(ci,{width:"100%",height:i,ref:g,children:e.jsxs(io,{children:[e.jsxs(ro,{data:c,dataKey:n,nameKey:"label",cx:"50%",cy:"50%",innerRadius:80,outerRadius:94,fill:"#a0a0a0",children:[e.jsx(Uo,{data:c,checkActive:m,handleCellClick:p}),e.jsx(Xa,{position:"centerBottom",fontSize:26,value:o("Total")}),e.jsx(Xa,{value:l,position:"centerTop",offset:20,fontSize:28,style:{marginTop:20},dy:12,fill:"#000",fontWeight:"bold"})]}),e.jsx(di,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",iconType:"circle",formatter:d}),e.jsx(ui,{formatter:u})]})})},it=({error:t,skipFields:s,style:a})=>{const n=nh(t,s);return n&&e.jsx(gs,{style:{marginBottom:24,...a},description:n.errors??JSON.stringify(n),type:"error"})},Re=({action:t,id:s,link:a,title:n})=>{const{t:i}=T();return e.jsxs("span",{children:[n," ",a?e.jsx("a",{href:a,children:s}):s," ",i(t)," ",i("successfully")]})},Ho=({attachment:t,handleAttachmentRemove:s})=>e.jsxs(Ye,{style:{border:"1px solid #ddd",marginBottom:8},align:"middle",children:[e.jsx(Le,{flex:"0 1 60px",style:{padding:"16px 16px"},children:e.jsx(oo,{style:{color:"#096dd9",fontSize:32}})}),e.jsx(Le,{flex:"1 1",style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},"data-testid":`attachment-name-${t.name}`,children:t.name}),e.jsx(Le,{flex:"0 1 100px",style:{textAlign:"center"},children:e.jsxs(ce,{children:[e.jsx(rs,{onClick:()=>{navigator.clipboard.writeText(t.link),Wc.info("Attachment url copied to clipboard")},style:{fontSize:16,cursor:"pointer",color:"#ааа"},"data-testid":`attachment-copy-btn-${t.name}`}),s&&e.jsx(Ta,{"data-testid":`attachment-remove-btn-${t.name}`,onClick:()=>s(t.id),style:{fontSize:16,cursor:"pointer",color:"#eb2f96"}})]})})]}),Yo=({attachments:t,isShowNoAttachment:s=!0,handleAttachmentRemove:a})=>{const{t:n}=T();return t.length===0&&s?e.jsx("p",{children:n("No attachments")}):e.jsx(e.Fragment,{children:t.map((i,r)=>e.jsx(Ho,{handleAttachmentRemove:a,attachment:i},`${i.id}-${r}`))})},Dp=({attachments:t,attachmentsIds:s,onChange:a,onLoad:n,onRemove:i,register:r,idInput:o})=>{const{t:c}=T();return e.jsxs(e.Fragment,{children:[e.jsx(Yo,{handleAttachmentRemove:i,attachments:t}),s.map((l,d)=>e.jsx("input",{type:"hidden",...r(`attachments.${d}`)},l.id)),e.jsx(Qc,{name:"file",multiple:!0,showUploadList:!1,customRequest:n,onChange:a,fileList:t,height:80,"data-testid":o,children:e.jsx("p",{className:"ant-upload-text",children:c("Drop files here to attach, or click to browse")})})]})},Wo=({attachments:t,isDivider:s=!0})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(je,{orientation:"left",style:{margin:0,fontSize:14},children:"Attachments"}),t.map((a,n)=>e.jsxs(Ye,{align:"middle",id:`attachment-${n+1}`,children:[e.jsx(Le,{flex:"0 1 40px",style:{padding:8},children:e.jsx(oo,{style:{color:"#096dd9",fontSize:32}})}),e.jsxs(Le,{flex:"1 1",style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:[e.jsx("a",{target:"blank",href:a.link,style:{margin:0,fontSize:13},children:a.filename}),e.jsx("p",{style:{margin:0,fontSize:12,color:"#828282"},children:a.size_humanize})]})]},a.id))]}),mt=({children:t})=>e.jsx(e.Fragment,{children:t});mt.Field=Wo;mt.Item=Ho;mt.List=Yo;mt.DropFiles=Dp;const Mp="_row_gxhcv_1",Fp="_pictureIcon_gxhcv_15",Zn={row:Mp,pictureIcon:Fp},Qo=h.forwardRef(({id:t="text-area",...s},a)=>{const[n,i]=h.useState("md"),[r,o]=h.useState(null),c=l=>{i(l)};return h.useEffect(()=>{const l=document.querySelector(`#${t}`);function d(){!l||l.clientHeight===0||o((l==null?void 0:l.clientHeight)??0)}let u;return l&&(u=new ResizeObserver(d),u.observe(l)),()=>u==null?void 0:u.disconnect()},[t]),e.jsxs("div",{id:`wrapper-${t}`,children:[e.jsx(se.TextArea,{id:t,rows:4,ref:a,style:{fontSize:13,borderBottomLeftRadius:0,display:n==="md"?"inline-block":"none",...s.style},...s}),e.jsx(Ko,{tab:n,textAreaHeight:r,value:s.value}),e.jsx("div",{id:`${t}-bottom`,className:Zn.row,children:e.jsx(Jo,{id:t,tab:n,handleTabClick:c})})]})}),lt=({uploadId:t="text-area-with-attach",textAreaId:s="text-area-with-attach",fieldProps:a,stateAttachments:n,customRequest:i,setValue:r})=>{const[o,c]=h.useState("md"),[l,d]=h.useState(null),{attachments:u,setAttachments:p}=n,m=h.useRef(null),g=y=>{p(y.fileList);const{status:j}=y.file;if(j==="done"&&a.name){const _=`${a.value??""}![](${y.file.link})`;r(a.name,_,{shouldDirty:!0})}},f=y=>{const{files:j}=y.clipboardData;j.length&&m.current.upload.uploader.uploadFiles(j)},x=y=>{c(y)};return h.useEffect(()=>{const y=document.querySelector(`#${s}`);function j(){!y||y.clientHeight===0||d((y==null?void 0:y.clientHeight)??0)}let _;return y&&(_=new ResizeObserver(j),_.observe(y)),()=>_==null?void 0:_.disconnect()},[s]),e.jsxs(e.Fragment,{children:[e.jsx(se.TextArea,{id:s,style:{fontSize:13,display:o==="md"?"inline-block":"none",...a.style},rows:4,...a,onPasteCapture:f}),e.jsx(Ko,{tab:o,textAreaHeight:l,value:a.value}),e.jsxs("div",{id:`${s}-bottom`,className:Zn.row,children:[e.jsx(Jo,{id:s,tab:o,handleTabClick:x}),e.jsx(Ns,{ref:m,id:`${t}-upload-attachment-input`,fileList:u,customRequest:i,onChange:g,name:"file",multiple:!0,showUploadList:!1,children:e.jsx(L,{id:`${t}-upload-attachment-button`,icon:e.jsx(Gc,{}),size:"small",type:"link",className:Zn.pictureIcon})})]})]})},Ep="_loader_k370n_1",Bp={loader:Ep},zt=()=>e.jsx("div",{className:Bp.loader,children:e.jsx(St,{})}),Go=({value:t,trueText:s,falseText:a,dataTestid:n})=>t?e.jsx(Ps,{color:Oe.success,"data-testid":n,children:s}):e.jsx(Ps,{color:Oe.error,"data-testid":n,children:a}),at=({id:t,dataTestId:s,title:a,value:n,markdown:i=!1})=>n?e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:a}),i?e.jsx("div",{className:"content markdown",id:t,"data-testid":s,children:e.jsx(At,{content:n})}):e.jsx("div",{style:{padding:8},children:e.jsx(G,{children:e.jsx(G.Paragraph,{id:t,children:e.jsx(G.Text,{style:{whiteSpace:"pre-wrap"},"data-testid":s,children:n})})})})]}):null,Ko=({tab:t,textAreaHeight:s,value:a})=>e.jsx("div",{className:"mdViewer",style:{display:t==="view"?"block":"none",minHeight:s?s+1:"auto"},children:e.jsx(At,{content:a})}),Op="_tabs_1tkas_1",qp="_tab_1tkas_1",zp="_active_1tkas_47",ua={tabs:Op,tab:qp,active:zp},Jo=({id:t,tab:s,handleTabClick:a})=>e.jsxs("div",{className:ua.tabs,children:[e.jsx("button",{id:`${t}-tabs-md`,className:V(ua.tab,{[ua.active]:s==="md"}),type:"button",onClick:()=>a("md"),children:"editor (.md)"}),e.jsx("button",{id:`${t}-tabs-view`,className:V(ua.tab,{[ua.active]:s==="view"}),type:"button",onClick:()=>a("view"),children:"visual"})]}),Up=({id:t,title:s,value:a})=>{const{t:n}=T(),i=h.useMemo(()=>a.split(/\r\n|\r|\n/)??[],[a]),r=h.useMemo(()=>{const d=i.slice(0,3).join(`
`);return i.length>3||d.length>300?`${d.slice(0,300)}...`:d},[i]),[o,c]=h.useState(!1),l=()=>{c(d=>!d)};return e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:s}),e.jsx(Ye,{align:"middle",id:t,children:e.jsx(Le,{flex:"auto",children:e.jsxs("div",{style:{padding:8},children:[e.jsx(At,{content:o?a:r}),(i.length>3||a.length>300)&&e.jsx("span",{style:{color:Oe.accent,cursor:"pointer"},onClick:l,children:n(o?"Hide more":"Show more")})]})})})]})},Zo=({id:t,control:s,name:a,formErrors:n,externalErrors:i,rules:r,maxLength:o,label:c=Si(a),required:l=!1})=>{var p;const{t:d}=T(),u=n?(p=n[a])==null?void 0:p.message:i?i[a]:void 0;return e.jsx(R.Item,{label:c,validateStatus:u?"error":"",help:u,required:l,children:e.jsx(F,{name:a,control:s,rules:{required:l?{value:!0,message:d("Required field")}:void 0,maxLength:o?{value:o,message:`${d("Maximum length")} `+o}:void 0,...r},render:({field:m})=>e.jsx(se,{id:t,...m})})})},ln=({id:t,control:s,name:a,setDate:n,disabledDate:i,defaultDate:r,formErrors:o,externalErrors:c,rules:l,maxLength:d,label:u=Si(a),required:p=!1,formStyles:m})=>{var x;const{t:g}=T(),f=o?(x=o[a])==null?void 0:x.message:c?c[a]:void 0;return e.jsx(R.Item,{label:u,validateStatus:f?"error":"",help:f,required:p,style:m,children:e.jsx(F,{name:a,control:s,defaultValue:r,rules:{required:p?{value:!0,message:g("Required field")}:void 0,maxLength:d?{value:d,message:`${g("Maximum length")} `+d}:void 0,...l},render:y=>e.jsx(vt,{id:t,...y,style:{width:"100%"},value:y.field.value,onChange:j=>{y.field.onChange(j),n(j)},disabledDate:i})})})},Vp=({id:t,control:s,name:a,formErrors:n,externalErrors:i,rules:r,label:o=Si(a),required:c=!1,treeData:l,treeProps:d})=>{var m;const{t:u}=T(),p=n?(m=n[a])==null?void 0:m.message:i?i[a]:void 0;return e.jsx(R.Item,{label:o,validateStatus:p?"error":"",help:p,required:c,children:e.jsx(F,{name:a,control:s,rules:{required:c?{value:!0,message:u("Required field")}:void 0,...r},render:({field:g})=>e.jsx("div",{"data-testid":`${t}-select`,children:e.jsx(Kc,{id:t,...g,showSearch:!0,treeCheckable:!0,treeNodeFilterProp:"title",style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:l,placeholder:u("Please select"),allowClear:!0,showCheckedStrategy:"SHOW_CHILD",...d})})})})},fs=(t,s,a)=>t.map(n=>{const i=typeof s=="function"?s(n):s,r=a?typeof a=="function"?a(n):a:void 0;return{id:n.id,data:n,title:i.title??n.name,children:[],parent:i.parent??null,props:{canOpen:n.has_children,isLeaf:!!n.has_children,isLoading:!1,isChecked:!1,isHalfChecked:!1,isMoreLoading:!1,isOpen:!1,hasMore:!1,page:i.page,level:i.level,...r}}}),Hp="_wrapper_mqxfg_1",Yp={wrapper:Hp},os=({className:t,children:s,...a})=>e.jsx("div",{className:V(Yp.wrapper,t),...a,children:s}),{Footer:Wp}=es,Xo=()=>e.jsx(Wp,{style:{textAlign:"center"},children:e.jsx(qo,{})}),Qp="_wrapper_11wft_1",Gp={wrapper:Qp},el=({code:t,message:s})=>e.jsx("div",{className:Gp.wrapper,children:e.jsx(Jc,{status:t,title:t,subTitle:s,extra:e.jsx(L,{type:"primary",children:e.jsx(ve,{to:"/",children:"Back to Home"})})})}),Kp=()=>({connected:!1,messages:[],lastMessage:null}),Jp=(t,s)=>Pt({name:t,initialState:s,reducers:{websocketConnected(a,n){a.connected=!0},websocketDisconnected(a){a.connected=!1,a.lastMessage=null,a.messages=[]},websocketMessageReceived(a,n){a.messages=[...a.messages,n.payload],a.lastMessage=n.payload}}}),tl=Jp("notificationWS",Kp()),{websocketConnected:sl,websocketDisconnected:cn,websocketMessageReceived:Zp}=tl.actions,Xp=tl.reducer,em=t=>t.notificationWS.lastMessage,al=()=>{const t=ye(),s=z(aa),a=z(em);h.useEffect(()=>{if(!s){t(cn());return}const i=`${Ae.apiRoot}/ws/notifications/${s.id}/`.replace("http","ws");return t(sl({url:i})),()=>{t(cn())}},[t,s]);const n=(a==null?void 0:a.count)??0;return{notificationsCount:n,hasNotifications:n>0}},tm=t=>h.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"currentColor",viewBox:"0 0 256 256",...t},h.createElement("path",{d:"M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"})),sm=t=>h.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 40V0H40V40H0ZM9.88504 17.8H11.305V16.33H6.73504V17.8H8.15504V23H9.88504V17.8ZM15.8621 17.8V16.33H12.0721V23H15.8621V21.53H13.8021V20.38H15.7521V18.91H13.8021V17.8H15.8621ZM17.4046 21L16.6646 22.4C16.998 22.6333 17.3346 22.81 17.6746 22.93C18.0746 23.0767 18.5113 23.15 18.9846 23.15C19.8446 23.15 20.5013 22.9233 20.9546 22.47C21.3746 22.05 21.5846 21.49 21.5846 20.79C21.5846 20.3033 21.4413 19.9067 21.1546 19.6C20.908 19.3333 20.5046 19.1133 19.9446 18.94L19.4146 18.78C19.1213 18.6933 18.928 18.5933 18.8346 18.48C18.7746 18.4 18.7446 18.3 18.7446 18.18C18.7446 18.0533 18.8013 17.9333 18.9146 17.82C19.0546 17.6867 19.2446 17.62 19.4846 17.62C19.8646 17.62 20.2446 17.77 20.6246 18.07L21.3146 16.72C20.628 16.36 19.9413 16.18 19.2546 16.18C18.5346 16.18 17.9646 16.39 17.5446 16.81C17.138 17.2167 16.9346 17.7533 16.9346 18.42C16.9346 18.9333 17.0613 19.3267 17.3146 19.6C17.508 19.82 17.828 20 18.2746 20.14L18.7246 20.28C19.1913 20.42 19.478 20.5367 19.5846 20.63C19.7113 20.7367 19.7746 20.87 19.7746 21.03C19.7746 21.1967 19.718 21.3367 19.6046 21.45C19.4646 21.6033 19.2413 21.68 18.9346 21.68C18.3946 21.68 17.8846 21.4533 17.4046 21ZM25.1975 17.8H26.6175V16.33H22.0475V17.8H23.4675V23H25.1975V17.8ZM29.2285 19.8V23H30.9685V19.8L33.4585 16.33H31.3585L30.1485 18.15L28.8885 16.33H26.8185L29.2285 19.8Z",fill:"white"})),am={ArchiveIcon:Zc,ArrowIcon:lo,ArrowLeftIcon:Xc,BackIcon:ed,BookmarkFillIcon:td,BookmarkIcon:sd,CloseIcon:Ta,CollapseIcon:ad,ColumnViewIcon:nd,ContextMenuIcon:id,DashboardIcon:co,DotsIcon:rd,ExpandIcon:od,FilterIcon:uo,FilterPlusIcon:ld,InfoIcon:cd,LogoutIcon:dd,ResetIcon:ud,SaveIcon:hd,SorterIcon:pd,TableIcon:ho,TestPlansIcon:no,TestSuitesIcon:md,UserGroupsIcon:gd,UserIcon:po},nm={...am},Ce={...nm},im="_wrapper_nopto_1",rm="_links_nopto_27",om="_linksBottom_nopto_41",lm="_link_nopto_27",cm="_icon_nopto_83",dm="_badge_nopto_93",um="_hide_nopto_105",hm="_active_nopto_113",pm="_divider_nopto_123",$e={wrapper:im,links:rm,linksBottom:om,link:lm,icon:cm,badge:dm,hide:um,active:hm,divider:pm},{ColumnViewIcon:mm,DashboardIcon:gm,LogoutIcon:xm,TestPlansIcon:fm,TestSuitesIcon:jm,UserGroupsIcon:ym,UserIcon:_m}=Ce,nl=h.memo(()=>{const{t}=T(),s=De(),{projectId:a}=Q(),n=Nt(),[i]=To(),r=z(aa),{notificationsCount:o}=al(),c=[{key:"overview",to:`/projects/${a}/overview`,title:t("Overview"),icon:e.jsx(gm,{className:$e.icon})},{key:"suites",to:`/projects/${a}/suites`,title:t("Test Suites & Cases"),icon:e.jsx(jm,{className:$e.icon})},{key:"plans",to:`/projects/${a}/plans`,title:t("Test Plans & Results"),icon:e.jsx(fm,{className:$e.icon})}],l=[{key:"administration/projects",to:"/administration/projects",title:t("Projects"),icon:e.jsx(mm,{className:$e.icon}),is_private:!1},{key:"administration/users",to:"/administration/users",title:t("Users"),icon:e.jsx(ym,{className:$e.icon}),is_private:!0}],d=()=>{i().unwrap().then(()=>{s("/login")})};return e.jsxs("div",{className:$e.wrapper,children:[e.jsx(ve,{id:"logo",to:"/",children:e.jsx(sm,{})}),n.pathname.includes("project")&&!n.pathname.includes("administration")&&e.jsx("ul",{className:$e.links,children:c.map(u=>e.jsx(le,{title:u.title,placement:"right",children:e.jsx(ve,{id:`sidebar-link-${u.key}`,to:u.to,className:V($e.link,{[$e.active]:n.pathname.includes(`/${u.key}`)}),children:u.icon})},u.key))}),e.jsxs("ul",{className:V($e.links,$e.linksBottom),children:[e.jsx("ul",{className:$e.links,children:l.map(u=>u.is_private&&!(r!=null&&r.is_superuser)?null:e.jsx(le,{title:u.title,placement:"right",children:e.jsx(ve,{id:`sidebar-link-${u.key}`,to:u.to,className:V($e.link,{[$e.active]:n.pathname.includes(u.to)}),children:u.icon})},u.key))}),e.jsx(le,{title:t("Notifications"),placement:"right",children:e.jsxs(ve,{id:"sidebar-link-notifications",to:"/notifications",className:V($e.link,{[$e.active]:n.pathname.includes("/notifications")}),children:[e.jsx(tm,{className:$e.icon}),e.jsx(hi,{className:V($e.badge,{[$e.hide]:!o}),color:"var(--y-interactive-default)",count:o,showZero:!1})]})}),e.jsx("div",{className:$e.divider}),e.jsx(le,{title:t("Profile"),placement:"right",children:e.jsx(ve,{id:"sidebar-link-profile",to:"/profile",className:V($e.link,{[$e.active]:n.pathname==="/profile"}),children:e.jsx(_m,{className:$e.icon})})}),e.jsx(le,{title:t("Logout"),placement:"right",children:e.jsx("div",{className:$e.link,children:e.jsx(xm,{id:"sidebar-link-logout",onClick:d,className:$e.icon})})})]})]})});nl.displayName="Sidebar";const{Content:bm}=es,vm=()=>{const t=ye(),{pathname:s}=Nt(),a=z(bu);h.useEffect(()=>{t(en(null))},[s]);const n=s.includes("projects")&&(s.includes("suites")||s.includes("plans"));return e.jsxs(es,{style:{display:"flex",flexDirection:"row",minHeight:"100vh",maxWidth:"100vw"},children:[e.jsx(nl,{}),e.jsxs(es,{children:[e.jsx(rc,{}),e.jsx(bm,{style:{minHeight:"100vh",zIndex:1},children:a?e.jsx(el,{code:a.code,message:a.message}):e.jsx(xs,{})}),!n&&e.jsx(Xo,{})]}),e.jsx(Gw,{})]})},Bs=({status:t,isShow:s,name:a,handleClose:n,isLoading:i,isLoadingButton:r,handleDelete:o,data:c,type:l,typeTitle:d,action:u})=>{const{t:p}=T(),m=[{title:p("Verbose Name"),dataIndex:"verbose_name"},{title:p("Verbose Name Related Model"),dataIndex:"verbose_name_related_model"},{title:p("Count"),dataIndex:"count",align:"right"}],g=h.useMemo(()=>c.filter(f=>!!f.count).map((f,x)=>({...f,id:x})),[c]);return e.jsxs(he,{className:`${l}-${u}-modal`,open:s,title:`${p(u==="archive"?"Archive":"Delete")} ${d} '${a}'`,onCancel:n,width:"530px",footer:[e.jsx(L,{id:`cancel-${l}-${u}`,onClick:n,children:p("Cancel")},"back"),e.jsx(L,{id:`update-${l}-edit`,type:"primary",danger:!0,onClick:o,loading:r||i,children:p(u==="archive"?"Archive":"Delete")},"submit")],children:[e.jsxs(G.Paragraph,{children:[p("Attention"),": ",p(u==="archive"?"Archiving":"Deleting")," ",p("the selected data in this table will remove it from view")]}),e.jsx(ht,{rowKey:"id",columns:m,dataSource:g,size:"small",pagination:!1,loading:t==="pending"})]})},Et="suites",Sa=Je.createApi({reducerPath:"suiteApi",baseQuery:pt,tagTypes:["TestSuite","TestSuiteAncestors","TestSuiteDeletePreview","TestSuiteTestCase"],endpoints:t=>({getTestSuites:t.query({query:s=>({url:`${Et}/`,params:s}),providesTags:s=>$t(s==null?void 0:s.results,"TestSuite")}),getTestSuitesWithTestCases:t.query({query:s=>({url:`${Et}/union/`,params:s}),providesTags:s=>$t(s==null?void 0:s.results,"TestSuite")}),getTestSuiteAncestors:t.query({query:({project:s,id:a,...n})=>({url:`${Et}/${a}/ancestors/`,params:{project:s,...n}}),providesTags:s=>s?[...s.map(a=>({type:"TestSuiteAncestors",id:a})),{type:"TestSuiteAncestors",id:"LIST"}]:[{type:"TestSuiteAncestors",id:"LIST"}]}),createSuite:t.mutation({query:s=>({url:`${Et}/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:s=>s!=null&&s.parent?[{type:"TestSuite",id:"LIST"},{type:"TestSuiteDeletePreview",id:s==null?void 0:s.parent.id}]:[{type:"TestSuite",id:"LIST"},{type:"TestSuiteDeletePreview",id:"LIST"}]}),updateTestSuite:t.mutation({query:({id:s,body:a})=>({url:`${Et}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"TestSuite")}),deleteTestSuite:t.mutation({query:s=>({url:`${Et}/${s}/`,method:"DELETE"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(It)},invalidatesTags:s=>Ge(s,"TestSuite")}),getSuite:t.query({query:({suiteId:s,...a})=>({url:`${Et}/${s}/`,params:a}),providesTags:(s,a,{suiteId:n})=>[{type:"TestSuite",id:n}]}),getDescendantsTree:t.query({query:s=>({url:`${Et}/descendants-tree/`,params:s})}),getSuiteDeletePreview:t.query({query:s=>({url:`${Et}/${s}/delete/preview/`}),providesTags:(s,a,n)=>[{type:"TestSuiteDeletePreview",id:n},{type:"TestSuiteDeletePreview",id:"LIST"}]}),copySuite:t.mutation({query:s=>({url:`${Et}/copy/`,method:"POST",body:s})}),getBreadcrumbs:t.query({query:s=>({url:`${Et}/${s}/breadcrumbs/`})}),getSuiteTestCases:t.query({query:({testSuiteId:s,...a})=>({url:`${Et}/${s}/cases/`,params:a}),providesTags:s=>$t(s==null?void 0:s.results,"TestSuiteTestCase")})})}),Ws=t=>Sa.util.invalidateTags([{type:"TestSuite",id:"LIST"},{type:"TestSuiteDeletePreview",id:"LIST"},{type:"TestSuiteTestCase",id:"LIST"}]),{useLazyGetTestSuitesQuery:Os,useLazyGetSuiteQuery:Sm,useGetTestSuitesQuery:wm,useGetSuiteQuery:Cm,useGetTestSuiteAncestorsQuery:HI,useLazyGetTestSuiteAncestorsQuery:ia,useLazyGetTestSuitesWithTestCasesQuery:Tm,useCreateSuiteMutation:km,useDeleteTestSuiteMutation:Im,useUpdateTestSuiteMutation:$m,useGetSuiteDeletePreviewQuery:Lm,useCopySuiteMutation:Am,useGetBreadcrumbsQuery:Pm,useLazyGetDescendantsTreeQuery:Nm,useGetSuiteTestCasesQuery:Rm}=Sa,Dm=(t,s)=>{const{t:a}=T(),[n,i]=h.useState([]),[r,o]=h.useState(!1),{project:c}=h.useContext(J),[l,d]=h.useState(null),[u,{isLoading:p}]=Am(),{data:m,isLoading:g}=Ii({page:1,page_size:1e3},{skip:!r}),{handleSubmit:f,reset:x,control:y,formState:{isDirty:j,errors:_},setValue:w,watch:b}=we(),S=b("project"),C=A=>{if(bi(A)&&(A==null?void 0:A.status)===400){const O=A.data.suites[0].new_name;i(O)}else Se(A)},v=()=>{x({new_name:`${t.name}(Copy)`,project:{label:c.name,value:c.id}}),o(!1),i([])},k=()=>{o(!0)},$=A=>{o(A)},I=async({new_name:A,project:q,suite:O})=>{if(!q){i([a("Project is required")]);return}if(!A.trim().length){i([a("New name is not be empty")]);return}try{const Y=await u({suites:[{id:t.id.toString(),new_name:A}],dst_project_id:q.value.toString(),dst_suite_id:O?O.value.toString():void 0}).unwrap();H.success({message:a("Success"),closable:!0,description:e.jsx(Re,{id:Y[0].id.toString(),link:`/projects/${Y[0].project}/suites/${Y[0].id}/`,action:"copied",title:a("Suite")})}),v(),s==null||s(Y[0])}catch(Y){C(Y)}},P=A=>{A&&(w("suite",A,{shouldDirty:!0}),d({value:A.value,label:A.label}))},N=h.useMemo(()=>m?m.results.map(A=>({label:A.name,value:A.id})):[],[m]);return h.useEffect(()=>{w("new_name",`${t.name}(Copy)`,{shouldDirty:!0,shouldTouch:!0}),w("project",{label:c.name,value:c.id},{shouldDirty:!0,shouldTouch:!0})},[t,c]),{errors:n,formErrors:_,isShow:r,isLoading:p,isDisabled:!j||p||g,projects:N,control:y,selectedSuite:l,selectedProject:S,handleCancel:v,handleChangeShow:$,handleShow:k,handleSelectSuite:P,handleSubmitForm:f(I)}},Ai=h.memo(({as:t,suite:s,onSubmit:a})=>{const{t:n}=T(),[i]=Os(),[r]=ia(),{errors:o,formErrors:c,isShow:l,isLoading:d,projects:u,isDisabled:p,control:m,selectedSuite:g,selectedProject:f,handleSubmitForm:x,handleSelectSuite:y,handleCancel:j,handleShow:_}=Dm(s,a);return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{id:"copy-test-suite",onClick:_,children:t}):e.jsx(L,{id:"copy-test-suite",icon:e.jsx(rs,{}),onClick:_,children:n("Copy").toUpperCase()}),e.jsxs(he,{className:"copy-test-suite-modal",title:`${n("Copy Test Suite")} '${s.name}'`,open:l,onCancel:j,centered:!0,footer:[e.jsx(L,{id:"cancel-btn",onClick:j,children:n("Cancel")},"back"),e.jsx(L,{id:"save-btn",type:"primary",loading:d,onClick:x,disabled:p,children:n("Save")},"submit")],children:[e.jsxs(R,{id:"create-test-suite-form",layout:"vertical",onFinish:x,children:[e.jsx(R.Item,{label:n("New Suite name"),children:e.jsx(F,{name:"new_name",control:m,render:({field:w})=>e.jsx(se,{id:"copy-test-suite-form-name",placeholder:n("Please enter a name"),...w,autoFocus:!0})})}),e.jsx(R.Item,{label:n("Project"),children:e.jsx(F,{name:"project",control:m,render:({field:w})=>e.jsx(ue,{...w,id:"copy-test-suite-select-project",showSearch:!0,placeholder:n("Please select project"),notFoundContent:"No matches",defaultActiveFirstOption:!1,labelInValue:!0,style:{width:"100%"},options:u,value:f,filterOption:(b,S)=>((S==null?void 0:S.label)??"").toLowerCase().includes(b.toLowerCase()),filterSort:(b,S)=>((b==null?void 0:b.label)??"").toLowerCase().localeCompare(((S==null?void 0:S.label)??"").toLowerCase())})})}),e.jsx(Fa,{id:"copy-test-suite-select-suite",control:m,name:"suite",label:n("Suite"),placeholder:n("Search a test suite"),formErrors:c,getData:i,getAncestors:r,dataParams:{project:String(f==null?void 0:f.value)},skipInit:!l,selected:g,onSelect:y})]}),!!o.length&&e.jsx(gs,{style:{marginBottom:0,marginTop:16},description:o,type:"error"})]})]})});Ai.displayName="CopySuite";const Mm=({isShow:t,setIsShow:s,testSuite:a,onSubmit:n})=>{const{t:i}=T(),[r,{isLoading:o}]=Im(),{data:c,isLoading:l,status:d}=Lm(String(a.id),{skip:!t}),u=De(),p=()=>{s(!1)},m=async()=>{try{await r(a.id).unwrap(),u(`/projects/${a.project}/suites`),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"deleted",title:i("Test Suite")})}),n==null||n(a)}catch(g){Se(g)}};return e.jsx(Bs,{status:d,isShow:t,isLoading:l,isLoadingButton:o,name:a.name,typeTitle:i("Test Suite"),type:"test-suite",data:c??[],handleClose:p,handleDelete:m,action:"delete"})},Pi=h.memo(({as:t,suite:s,onSubmit:a})=>{const{t:n}=T(),[i,r]=h.useState(!1),o=()=>{r(!0)};return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{id:"delete-test-suite",onClick:o,children:t}):e.jsx(L,{id:"delete-test-suite",icon:e.jsx(ut,{}),onClick:o,children:n("Delete")}),e.jsx(Mm,{testSuite:s,isShow:i,setIsShow:r,onSubmit:a})]})});Pi.displayName="DeleteSuite";const ea=h.memo(({type:t,as:s,suite:a,size:n="default",colorType:i="default"})=>{const{t:r}=T(),{projectId:o,testSuiteId:c}=Q(),l=De(),d=()=>{var x;const m=new URL(`${window.location.origin}/projects/${o}/suites/${t==="create"?"new":`${a==null?void 0:a.id}/edit`}-test-suite`),g=new URLSearchParams(window.location.search),f=(t==="create"?a==null?void 0:a.id.toString():(x=a==null?void 0:a.parent)==null?void 0:x.id.toString())??c;f&&m.searchParams.append("parentTestSuite",f),m.searchParams.append("prevUrl",g.get("prevUrl")?g.get("prevUrl")??"":`${window.location.pathname}${window.location.search}`),l(`${m.pathname}${m.search}`,{state:{suite:a}})},u=()=>n==="small"?"":r(t==="create"?a?"Create Child Test Suite":"Create":"Edit"),p=()=>t==="create"?a?"create-child-test-suite":"create-test-suite":"edit-test-suite";return s?e.jsx("div",{id:p(),onClick:d,children:s}):e.jsx(L,{id:p(),icon:t==="create"?e.jsx(ct,{}):e.jsx(Ke,{}),onClick:d,type:i,shape:n==="default"?"default":"circle",children:u()})});ea.displayName="ChangeTestSuite";const Fm="_wrapper_gx0to_1",Em="_title_gx0to_19",Bm="_requireIcon_gx0to_31",Om="_value_gx0to_49",qm="_expanded_gx0to_75",zm="_showMore_gx0to_83",Qs={wrapper:Fm,title:Em,requireIcon:Bm,value:Om,expanded:qm,showMore:zm},Um=t=>typeof t=="string"?e.jsx(At,{content:t}):Array.isArray(t)?e.jsx(At,{content:t.join(`\r
`)}):JSON.stringify(t,null,2),il=({title:t,value:s,isRequired:a})=>{const{t:n}=T(),[i,r]=h.useState(!1),[o,c]=h.useState(!1),l=h.useRef(null);h.useEffect(()=>{l.current&&c(l.current.scrollHeight>100)},[]);const d=()=>{r(u=>!u)};return e.jsxs(M,{vertical:!0,className:Qs.wrapper,children:[e.jsxs(M,{children:[e.jsx(G.Title,{id:"attribute-name",level:4,className:Qs.title,children:t}),a&&e.jsx("span",{className:Qs.requireIcon,children:"*"})]}),e.jsx(G.Text,{id:"attribute-value",style:{whiteSpace:"pre-wrap"},className:V(Qs.value,{[Qs.expanded]:i}),ref:l,children:Um(s)}),o&&e.jsx("button",{"data-testid":"attribute-show-more-btn",style:{color:Oe.accent,cursor:"pointer",marginTop:8},onClick:d,className:Qs.showMore,children:n(i?"Hide more":"Show more")})]})},Vm="_button_1sgkg_1",Hm={button:Vm},ra=({onClick:t})=>{const{t:s}=T();return e.jsxs(L,{id:"add-attribute-btn",type:"dashed",block:!0,onClick:t,className:Hm.button,children:[e.jsx(ct,{})," ",s("Add attribute")]})},Ym=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})}),Xn=({value:t})=>t?e.jsx(ja,{}):null,Wm=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M12.258 3h-8.51l-.083 2.46h.479c.26-1.544.758-1.783 2.693-1.845l.424-.013v7.827c0 .663-.144.82-1.3.923v.52h4.082v-.52c-1.162-.103-1.306-.26-1.306-.923V3.602l.431.013c1.934.062 2.434.301 2.693 1.846h.479L12.258 3z"})}),Qm=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})}),Gm=()=>e.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 16 16",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2.984V2h-.09c-.313 0-.616.062-.909.185a2.33 2.33 0 0 0-.775.53 2.23 2.23 0 0 0-.493.753v.001a3.542 3.542 0 0 0-.198.83v.002a6.08 6.08 0 0 0-.024.863c.012.29.018.58.018.869 0 .203-.04.393-.117.572v.001a1.504 1.504 0 0 1-.765.787 1.376 1.376 0 0 1-.558.115H2v.984h.09c.195 0 .38.04.556.121l.001.001c.178.078.329.184.455.318l.002.002c.13.13.233.285.307.465l.001.002c.078.18.117.368.117.566 0 .29-.006.58-.018.869-.012.296-.004.585.024.87v.001c.033.283.099.558.197.824v.001c.106.273.271.524.494.753.223.23.482.407.775.53.293.123.596.185.91.185H6v-.984h-.09c-.2 0-.387-.038-.563-.115a1.613 1.613 0 0 1-.457-.32 1.659 1.659 0 0 1-.309-.467c-.074-.18-.11-.37-.11-.573 0-.228.003-.453.011-.672.008-.228.008-.45 0-.665a4.639 4.639 0 0 0-.055-.64 2.682 2.682 0 0 0-.168-.609A2.284 2.284 0 0 0 3.522 8a2.284 2.284 0 0 0 .738-.955c.08-.192.135-.393.168-.602.033-.21.051-.423.055-.64.008-.22.008-.442 0-.666-.008-.224-.012-.45-.012-.678a1.47 1.47 0 0 1 .877-1.354 1.33 1.33 0 0 1 .563-.121H6zm4 10.032V14h.09c.313 0 .616-.062.909-.185.293-.123.552-.3.775-.53.223-.23.388-.48.493-.753v-.001c.1-.266.165-.543.198-.83v-.002c.028-.28.036-.567.024-.863-.012-.29-.018-.58-.018-.869 0-.203.04-.393.117-.572v-.001a1.502 1.502 0 0 1 .765-.787 1.38 1.38 0 0 1 .558-.115H14v-.984h-.09c-.196 0-.381-.04-.557-.121l-.001-.001a1.376 1.376 0 0 1-.455-.318l-.002-.002a1.415 1.415 0 0 1-.307-.465v-.002a1.405 1.405 0 0 1-.118-.566c0-.29.006-.58.018-.869a6.174 6.174 0 0 0-.024-.87v-.001a3.537 3.537 0 0 0-.197-.824v-.001a2.23 2.23 0 0 0-.494-.753 2.331 2.331 0 0 0-.775-.53 2.325 2.325 0 0 0-.91-.185H10v.984h.09c.2 0 .387.038.562.115.174.082.326.188.457.32.127.134.23.29.309.467.074.18.11.37.11.573 0 .228-.003.452-.011.672-.008.228-.008.45 0 .665.004.222.022.435.055.64.033.214.089.416.168.609a2.285 2.285 0 0 0 .738.955 2.285 2.285 0 0 0-.738.955 2.689 2.689 0 0 0-.168.602c-.033.21-.051.423-.055.64a9.15 9.15 0 0 0 0 .666c.008.224.012.45.012.678a1.471 1.471 0 0 1-.877 1.354 1.33 1.33 0 0 1-.563.121H10z"})}),Km="_buttonType_u656i_1",Jm="_active_u656i_15",Zm="_disabled_u656i_31",Xm="_label_u656i_49",eg="_labelIsRequired_u656i_57",Tt={buttonType:Km,active:Jm,disabled:Zm,label:Xm,labelIsRequired:eg},{TextArea:tg}=se,sg=({errorName:t,errorValue:s,index:a,attribute:n,onChangeName:i,onChangeType:r,onChangeValue:o,onRemove:c,onBlur:l})=>{const{t:d}=T();return e.jsxs("div",{id:`attribute-block-${a}`,children:[e.jsxs(M,{wrap:!0,style:{rowGap:8,columnGap:8,paddingBottom:5},children:[e.jsxs(Le,{flex:"auto",children:[(n.is_init||!!n.required)&&e.jsx("div",{className:"ant-col ant-form-item-label",children:e.jsxs("label",{className:V(Tt.label,{[Tt.labelIsRequired]:!!n.required}),title:n.name,children:[n.name," (",n.type,")"]})}),!n.is_init&&!n.required&&e.jsx(se,{id:`attribute-name-${a}`,value:n.name,onChange:u=>i(n.id,u.target.value),onBlur:l,style:{borderColor:t!=null&&t.length?Oe.error:""},disabled:n.required,placeholder:d("Attribute name")})]}),!n.is_init&&!n.required&&e.jsxs(M,{align:"center",children:[e.jsx(le,{placement:"topRight",title:d("Text value"),children:e.jsx(L,{id:`attribute-type-text-${a}`,disabled:n.is_init,icon:e.jsx(Wm,{}),onClick:()=>r(n.id,"Text"),type:"text",className:V(Tt.buttonType,{[Tt.active]:n.type==="Text",[Tt.disabled]:n.is_init})})}),e.jsx(le,{placement:"topRight",title:d("List value"),children:e.jsx(L,{id:`attribute-type-list-${a}`,disabled:n.is_init,icon:e.jsx(Qm,{}),onClick:()=>r(n.id,"List"),type:"text",className:V(Tt.buttonType,{[Tt.active]:n.type==="List",[Tt.disabled]:n.is_init})})}),e.jsx(le,{placement:"topRight",title:d("JSON value"),children:e.jsx(L,{id:`attribute-type-json-${a}`,disabled:n.is_init,icon:e.jsx(Gm,{}),onClick:()=>r(n.id,"JSON"),type:"text",className:V(Tt.buttonType,{[Tt.active]:n.type==="JSON",[Tt.disabled]:n.is_init}),style:{marginRight:16}})}),e.jsx(le,{placement:"topRight",title:d("Delete attribute"),children:e.jsx(L,{id:`attribute-type-json-${a}`,disabled:n.required??n.is_init,danger:!0,type:"text",icon:e.jsx(ut,{}),onClick:()=>c(n.id),style:{marginLeft:"auto"},className:V(Tt.buttonType,{[Tt.disabled]:n.required})})})]})]}),e.jsx(tg,{id:`attribute-value-${a}`,className:V({[`attribute-value-${a}-req`]:!!n.required}),rows:4,value:String(n.value),onChange:u=>o(n.id,u.target.value),onBlur:l,style:{borderColor:s!=null&&s.length?Oe.error:""}})]})},ag="_list_1rd1l_1",ng={list:ag},oa=({attributes:t,onChangeName:s,onChangeType:a,onChangeValue:n,onRemove:i,onBlur:r,errors:o})=>t.length===0?null:e.jsx("div",{className:ng.list,children:t.map((c,l)=>{var d,u;return e.jsx(sg,{index:l,attribute:c,onChangeName:s,onChangeType:a,onChangeValue:n,onRemove:i,errorName:(d=o==null?void 0:o[c.id])==null?void 0:d.name,errorValue:(u=o==null?void 0:o[c.id])==null?void 0:u.value,onBlur:r},c.id)})}),ig="_datesRow_1e6jl_1",rg="_form_1e6jl_15",og={datesRow:ig,form:rg},lg="attachments",dn=Je.createApi({reducerPath:"attachmentApi",baseQuery:pt,endpoints:t=>({createAttachment:t.mutation({query:s=>({url:`${lg}/`,method:"POST",body:s})})})}),{useCreateAttachmentMutation:cg}=dn,cr=new li,ls=(t,s)=>{const[a,n]=h.useState([]),[i,{isLoading:r}]=cg(),{fields:o,append:c,remove:l}=xd({name:"attachments",control:t});return h.useEffect(()=>{l(),c(a.map(({id:g})=>g))},[a]),{onLoad:async g=>{const{onSuccess:f,onError:x,file:y}=g,j=y;if(!s||!f||!x){H.error({message:"Error!",description:"ProjectId is undefined"});return}const _=new FormData;_.append("file",y),_.append("project",String(s)),await cr.waitForUnlock();const w=await cr.acquire();try{const b=await i(_).unwrap();j.id=b[0].id,j.link=b[0].link,f("Ok")}catch(b){const S=b;Se(b),x(S)}finally{w()}},onRemove:g=>{n(a.filter(({id:f})=>f!==g))},onChange:g=>{const f=g.fileList;n(f)},setAttachments:n,removeAttachmentIds:l,onReset:()=>{l(),n([])},attachmentsIds:o,attachments:a,isLoading:r}},Va="parameters",un=Je.createApi({reducerPath:"parameterApi",baseQuery:pt,tagTypes:["Parameter"],endpoints:t=>({getParameters:t.query({query:s=>({url:`${Va}/`,params:{project:s,treeview:!0}}),providesTags:s=>$t(s,"Parameter")}),createParameter:t.mutation({query:s=>({url:`${Va}/`,method:"POST",body:s}),invalidatesTags:[{type:"Parameter",id:"LIST"}]}),updateParameter:t.mutation({query:({id:s,body:a})=>({url:`${Va}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Parameter")}),deleteParameter:t.mutation({query:s=>({url:`${Va}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"Parameter",id:"LIST"}]})})}),{useGetParametersQuery:Ni,useCreateParameterMutation:dg,useUpdateParameterMutation:ug,useDeleteParameterMutation:hg}=un,ha="custom-attributes",hn=Je.createApi({reducerPath:"customAttributeApi",baseQuery:pt,tagTypes:["CustomAttribute"],endpoints:t=>({getCustomAttributes:t.query({query:s=>({url:`${ha}/`,params:s}),providesTags:s=>$t(s,"CustomAttribute")}),createCustomAttribute:t.mutation({query:s=>({url:`${ha}/`,method:"POST",body:s}),invalidatesTags:s=>Ge(s,"CustomAttribute")}),updateCustomAttribute:t.mutation({query:({id:s,body:a})=>({url:`${ha}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"CustomAttribute")}),deleteCustomAttribute:t.mutation({query:s=>({url:`${ha}/${s}/`,method:"DELETE"}),invalidatesTags:s=>Ge(s,"CustomAttribute")}),getCustomAttributeContentTypes:t.query({query:()=>({url:`${ha}/content-types/`})})})}),{useGetCustomAttributesQuery:La,useCreateCustomAttributeMutation:pg,useUpdateCustomAttributeMutation:mg,useDeleteCustomAttributeMutation:gg,useGetCustomAttributeContentTypesQuery:xg}=hn,Ri={0:"Text",1:"List",2:"JSON"},rl=Object.entries(Ri).map(([t,s])=>({value:Number(t),label:s})),Tn=({model:t,attribute:s,is_init:a=!0})=>{const n=t==="testresult",i=s.applied_to[t];return{id:String(s.id),name:s.name,type:Ri[s.type],value:"",required:(i==null?void 0:i.is_required)??!1,status_specific:n?i.status_specific:[],is_init:a}},kn=({mode:t,initAttributes:s,addAttributeAdditionalParams:a,getJsonAdditionalParams:n,setValue:i})=>{const[r,o]=h.useState([]);return h.useEffect(()=>{t==="create"&&s.length&&o(s)},[t,s]),{attributes:r,setAttributes:o,resetAttributes:()=>{o(t==="create"?s:[])},addAttribute:()=>{const f=[...r,{id:Oa(),name:"",value:"",type:"Text",is_init:!1,...a}];o(f),i(f)},onAttributeChangeType:(f,x)=>{const y=r.map(j=>j.id!==f?j:{...j,type:x});o(y),i(y)},onAttributeChangeValue:(f,x)=>{const y=r.map(j=>j.id!==f?j:{...j,value:x});o(y),i(y)},onAttributeChangeName:(f,x)=>{const y=r.map(j=>j.id!==f?j:{...j,name:x});o(y),i(y)},onAttributeRemove:f=>{const x=r.filter(({id:y})=>y!==f);o(x),i(x)},getAttributeJson:f=>{const x=[];return Object.keys(f).map(y=>{if(typeof f[y]=="string")x.push({id:Oa(),name:y,type:"Text",value:f[y],is_init:!1,...n});else if(Array.isArray(f[y])){const j=f[y];x.push({id:Oa(),name:y,type:"List",value:j.join(`\r
`),is_init:!1,...n})}else typeof f[y]=="object"&&x.push({id:Oa(),name:y,type:"JSON",value:JSON.stringify(f[y],null,2),is_init:!1,...n})}),s.forEach(y=>{const j=x.find(_=>_.name===y.name);j?y.type!==j.type?j.type=y.type:y.required&&!j.required?j.required=y.required:j.is_init=!0:x.push(y)}),x}}},fg=({mode:t,setValue:s})=>{const{project:a}=h.useContext(J),{data:n,isLoading:i}=La({project:String(a.id)}),r=h.useMemo(()=>n?n.filter(y=>y.applied_to.testsuite).map(y=>Tn({attribute:y,model:"testsuite"})):[],[n]),o=y=>{s("attributes",y,{shouldDirty:!0})},{attributes:c,addAttribute:l,getAttributeJson:d,onAttributeChangeName:u,onAttributeChangeType:p,onAttributeChangeValue:m,onAttributeRemove:g,resetAttributes:f,setAttributes:x}=kn({mode:t,initAttributes:r,setValue:o,addAttributeAdditionalParams:{required:!1},getJsonAdditionalParams:{required:!1}});return{attributes:c,isLoading:i,initAttributes:r,setAttributes:x,resetAttributes:f,addAttribute:l,onAttributeChangeType:p,onAttributeChangeValue:m,onAttributeChangeName:u,onAttributeRemove:g,getAttributeJson:d}},jg=t=>{const s=ol();window.localStorage.setItem("treeSettings",JSON.stringify({...s,...t}))},ol=()=>{const t=window.localStorage.getItem("treeSettings");return t?JSON.parse(t):{collapsed:!1,show_archived:!1,plans:{sortBy:"asc",filterBy:"name"},suites:{sortBy:"asc",filterBy:"name"}}},Aa=async(t,s)=>{var i;const a=((i=s==null?void 0:s.parent)==null?void 0:i.id)??null;if(!a){await t.initRoot();return}const n=t.findById(a);n&&(n.updateProps({canOpen:!0}),await t.refetchNodeBy(r=>r.id===a))},ll=async(t,s)=>{var n;const a=((n=s==null?void 0:s.parent)==null?void 0:n.id)??null;await t.refetchNodeBy(i=>i.id===a)},Di=async(t,s)=>{var i;const a=((i=s==null?void 0:s.parent)==null?void 0:i.id)??null;if(!a){await t.initRoot();return}const n=t.findById(a);n&&(await t.refetchNodeBy(r=>r.id===a),n.updateProps({canOpen:!!n.children.length}))},cl=async(t,s,a,n)=>{var o,c;if(!((o=s.parent)!=null&&o.id)||!((c=a.parent)!=null&&c.id)){await t.initRoot();return}const i=t.findById(s.parent.id),r=t.findById(a.parent.id);if(s.parent.id===a.parent.id&&i){await t.refetchNodeBy(l=>l.id===i.id);return}if(i)await t.refetchNodeBy(l=>l.id===i.id),i.children.length&&i.updateProps({canOpen:!0});else{const l=await n(s.id);for(const d of l)await t.refetchNodeBy(u=>u.id===d)}r&&(await t.refetchNodeBy(l=>l.id===r.id),r.children.length||r.updateProps({canOpen:!1}))},dl=(t,s)=>{const a=new URLSearchParams;return t.forEach(n=>{const i=s.get(n);i&&a.append(n,i)}),a},dr={name:"",description:"",parent:null,attributes:[],attachments:[]},yg=({type:t})=>{const{t:s}=T(),a=Nt(),[n]=nt(),{project:i}=h.useContext(J),{showModal:r}=Ot(),o=De(),c=a.state,{treebar:l}=h.useContext(Us),{handleSubmit:d,reset:u,control:p,setValue:m,formState:{isDirty:g,errors:f},register:x}=we({defaultValues:dr}),{setDateFrom:y,setDateTo:j,disabledDateFrom:_,disabledDateTo:w}=Ci(),{attachments:b,attachmentsIds:S,isLoading:C,setAttachments:v,onLoad:k,onRemove:$,onChange:I}=ls(p,i.id),{attributes:P,isLoading:N,addAttribute:A,onAttributeChangeName:q,onAttributeChangeType:O,onAttributeChangeValue:Y,onAttributeRemove:ee,getAttributeJson:U,setAttributes:E}=fg({mode:t,setValue:m}),[D,ae]=h.useState((c==null?void 0:c.suite)??null),[oe,te]=h.useState([]),[B,ie]=h.useState(null),[ke,qe]=h.useState("general"),[Qe,ge]=h.useState(null),{onHandleError:rt}=We(ge),{data:ze}=Ni(i.id),[pe,{isLoading:_e}]=Sm(),[Ue]=ia(),[Ze,{isLoading:Ne}]=km(),[Xe,{isLoading:_t}]=$m(),Me=async Z=>{l.current&&await Aa(l.current,Z)},et=async(Z,ne)=>{if(!l.current)return;const W=me=>Ue({id:me,project:ne.project},!1).unwrap();await cl(l.current,Z,ne,W)},tt=Z=>{qe(Z)},Ie=()=>{ge(null),u()},Dt=()=>{Ie();const Z=n.get("prevUrl");o(Z??`/projects/${i.id}/suites/${(D==null?void 0:D.id)??""}`)},bt=()=>{if(g){r(Dt);return}Dt()},ot=Z=>{const ne=n.get("prevUrl");if(ne&&t==="edit"){o(ne);return}o(`/projects/${i.id}/suites/${Z??""}`)},bs=async Z=>{if(D){ge(null);try{const{isSuccess:ne,attributesJson:W,errors:me}=ps(P);if(!ne){ge({attributes:JSON.stringify(me)});return}const be=await Xe({id:D.id,body:{...Z,parent:Z.parent?Number(Z.parent):null,attributes:W}}).unwrap();H.success({message:s("Success"),closable:!0,description:e.jsx(Re,{id:String(D.id),action:"updated",title:s("Test Suite"),link:`/projects/${i.id}/suites/${D.id}`})}),Ie(),et(be,D),ot(D.id)}catch(ne){rt(ne)}}},vs=async Z=>{ge(null);try{const{isSuccess:ne,attributesJson:W,errors:me}=ps(P);if(!ne){ge({attributes:JSON.stringify(me)});return}const be=await Ze({...Z,project:i.id,attributes:W}).unwrap();H.success({message:s("Success"),closable:!0,description:e.jsx(Re,{action:"created",title:s("Test Suite"),link:`/projects/${i.id}/suites/${be.id}`,id:String(be.id)})}),Ie(),Me(be),ot(be.id)}catch(ne){rt(ne)}},re=Z=>{var ne;if(ge({parent:""}),t==="edit"&&Number(Z==null?void 0:Z.value)===Number(D==null?void 0:D.id)){ge({parent:s("Test Suite cannot be its own parent.")});return}m("parent",Z?Z.value:null,{shouldDirty:!0}),ie(Z?{value:Z.value,label:((ne=Z.label)==null?void 0:ne.toString())??""}:null)};return h.useEffect(()=>{ze&&te(ko(ze))},[ze]),h.useEffect(()=>{const Z=n.get("parentTestSuite");if(!Z||Z&&D)return;(async()=>{const W=await pe({suiteId:Z}).unwrap();ie({value:W.id,label:W.name})})()},[D,n.get("parentTestSuite")]),h.useEffect(()=>{var Z,ne;if(!(!D||N)){if(t==="create")u(dr),ie({value:D.id,label:D.name}),m("parent",D.id,{shouldDirty:!1});else if(t==="edit"){const W=(Z=D==null?void 0:D.attachments)==null?void 0:Z.map(be=>({...be,uid:String(be.id)}));W!=null&&W.length&&v(W);const me=U(D.attributes);E(me),u({name:D.name,description:D.description,parent:((ne=D.parent)==null?void 0:ne.id)??null,attributes:me}),ie(D.parent?{value:D.parent.id,label:D.parent.name}:null)}}},[D,t,N]),h.useEffect(()=>{ae((c==null?void 0:c.suite)??null)},[c==null?void 0:c.suite]),{errors:Qe,formErrors:f,tab:ke,isDirty:g,isLoadingSubmit:Ne||_t||_e||C,control:p,selectedParent:B,attachments:b,attachmentsIds:S,parametersTreeView:oe,stateTestSuite:D,setDateFrom:y,disabledDateFrom:_,setDateTo:j,disabledDateTo:w,handleSelectTestSuite:re,setAttachments:v,handleAttachmentLoad:k,handleAttachmentRemove:$,handleAttachmentChange:I,setValue:m,handleTabChange:tt,handleCancel:bt,handleSubmitForm:d(t==="create"?vs:bs),register:x,attributes:P,addAttribute:A,onAttributeChangeName:q,onAttributeChangeType:O,onAttributeChangeValue:Y,onAttributeRemove:ee}},ur=({type:t})=>{const{t:s}=T(),{control:a,formErrors:n,errors:i,tab:r,isLoadingSubmit:o,isDirty:c,attachments:l,selectedParent:d,stateTestSuite:u,setAttachments:p,handleCancel:m,handleSubmitForm:g,handleTabChange:f,handleAttachmentLoad:x,handleSelectTestSuite:y,setValue:j,attributes:_,addAttribute:w,onAttributeChangeName:b,onAttributeChangeType:S,onAttributeChangeValue:C,onAttributeRemove:v}=yg({type:t}),[k]=Os(),[$]=ia(),I=t==="create"?`${s("Create")} ${s("Test Suite")}`:`${s("Edit")} ${s("Test Suite")} '${u==null?void 0:u.name}'`;return e.jsxs(e.Fragment,{children:[e.jsx(Dn,{model:"test-suite",type:t,title:I,isDisabledSubmit:!c,isLoadingSubmit:o,onClose:m,onSubmit:g}),i?e.jsx(it,{error:i,style:{marginTop:12,marginBottom:12},skipFields:["name","description","parent","attributes"]}):null,e.jsx(R,{id:`test-suite-${t}-form`,layout:"vertical",onFinish:g,className:og.form,children:e.jsx(dt,{defaultActiveKey:"general",onChange:f,activeKey:r,children:e.jsx(dt.TabPane,{tab:s("General"),children:e.jsxs(M,{justify:"space-between",gap:16,style:{marginTop:14},children:[e.jsxs(M,{vertical:!0,style:{width:"100%"},children:[e.jsx(Zo,{id:`${t}-test-suite-name`,control:a,name:"name",required:!0,label:s("Name"),maxLength:100,formErrors:n,externalErrors:i}),e.jsx(Fa,{id:`${t}-test-suite-parent`,control:a,name:"parent",label:s("Parent Test Suite"),placeholder:s("Search a test suite"),formErrors:n,externalErrors:i,getData:k,getAncestors:$,selected:d,onSelect:y}),e.jsx(R.Item,{label:s("Description"),validateStatus:i!=null&&i.description?"error":"",help:i!=null&&i.description?i.description:"",children:e.jsx(F,{name:"description",control:a,render:({field:P})=>e.jsx(lt,{uploadId:`${t}-test-suite-desc`,textAreaId:`${t}-test-suite-desc-textarea`,fieldProps:P,stateAttachments:{attachments:l,setAttachments:p},customRequest:x,setValue:j})})})]}),e.jsx(M,{vertical:!0,style:{width:"100%"},children:e.jsx(F,{name:"attributes",control:a,render:({field:P})=>e.jsxs(Ye,{style:{flexDirection:"column"},children:[e.jsx(oa,{attributes:_,onChangeName:b,onChangeType:S,onChangeValue:C,onRemove:v,onBlur:P.onBlur,errors:i!=null&&i.attributes?JSON.parse(i==null?void 0:i.attributes):void 0}),e.jsx(ra,{onClick:w})]})})})]})},"general")})})]})},_g=({isShow:t,setIsShow:s,testPlan:a,onSubmit:n})=>{const{t:i}=T(),[r,{isLoading:o}]=rp(),{data:c,isLoading:l,status:d}=ip(String(a.id),{skip:!t}),u=De(),p=()=>{s(!1)},m=async()=>{try{await r(a.id).unwrap(),u(`/projects/${a.project}/plans`),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"archived",title:i("Test Plan")})}),n==null||n(a),p()}catch(g){Se(g)}};return e.jsx(Bs,{status:d,isShow:t,isLoading:l,isLoadingButton:o,name:a.name,typeTitle:i("Test Plan"),type:"test-plan",data:c??[],handleClose:p,handleDelete:m,action:"archive"})},{ArchiveIcon:bg}=Ce,Mi=h.memo(({as:t,testPlan:s,onSubmit:a})=>{const{t:n}=T(),[i,r]=h.useState(!1),o=()=>{r(!0)};return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{id:"archive-test-plan",onClick:o,children:t}):e.jsx(L,{id:"archive-test-plan",icon:e.jsx(bg,{width:16,height:16}),onClick:o,children:n("Archive")}),e.jsx(_g,{isShow:i,setIsShow:r,testPlan:s,onSubmit:a})]})});Mi.displayName="ArchiveTestPlan";const vg=({isShow:t,setIsShow:s,testPlan:a,onSubmit:n})=>{const{t:i}=T(),{testPlanId:r}=Q(),[o,{isLoading:c}]=Xh(),{data:l,isLoading:d,status:u}=np(String(a.id),{skip:!t}),p=De(),m=()=>{s(!1)},g=async()=>{try{await o(a.id).unwrap(),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"deleted",title:i("Test Plan")})}),n==null||n(a),r&&a.id===Number(r)&&p(`/projects/${a.project}/plans`)}catch(f){Se(f)}};return e.jsx(Bs,{status:u,isShow:t,isLoading:d,isLoadingButton:c,name:a.name,typeTitle:i("Test Plan"),type:"test-plan",data:l??[],handleClose:m,handleDelete:g,action:"delete"})},Fi=h.memo(({as:t,testPlan:s,onSubmit:a})=>{const{t:n}=T(),[i,r]=h.useState(!1),o=()=>{r(!0)};return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{id:"edit-test-plan",onClick:o,children:t}):e.jsx(L,{id:"delete-test-plan",icon:e.jsx(ut,{}),onClick:o,children:n("Delete")}),e.jsx(vg,{isShow:i,setIsShow:r,testPlan:s,onSubmit:a})]})});Fi.displayName="DeleteTestPlan";const Sg="_datesRow_1g9dm_1",wg={datesRow:Sg},Cg=({testPlan:t,onSubmit:s})=>{const{t:a}=T(),[n,i]=h.useState(!1),[r,o]=h.useState([]),[c,{isLoading:l}]=lp(),[d,u]=h.useState(null),{handleSubmit:p,reset:m,control:g,formState:{isDirty:f,errors:x},setValue:y,watch:j}=we({defaultValues:{new_name:`${t.name}(Copy)`,startedAt:t.started_at?K(t.started_at):null,dueDate:t.due_date?K(t.due_date):null,keepAssignee:!1,plan:null}}),_=j("new_name"),{setDateFrom:w,setDateTo:b,disabledDateFrom:S,disabledDateTo:C}=Ci(),v=N=>{if(bi(N)&&(N==null?void 0:N.status)===400){const q=N.data.plans[0].new_name;o(q)}else Se(N)},k=()=>{i(!1),o([]),m()},$=()=>{i(!0)},I=async({new_name:N,plan:A,keepAssignee:q,startedAt:O,dueDate:Y})=>{if(!N.trim().length){o([a("New plan name is required")]);return}try{const ee=await c({plans:[{plan:t.id,new_name:N,started_at:O==null?void 0:O.toISOString(),due_date:Y==null?void 0:Y.toISOString()}],dst_plan:A==null?void 0:A.value,keep_assignee:q}).unwrap();H.success({message:a("Success"),closable:!0,description:e.jsx(Re,{id:ee[0].id.toString(),link:`/projects/${ee[0].project}/plans/${ee[0].id}/`,action:"copied",title:a("Test Plan")})}),k(),s==null||s(ee[0])}catch(ee){v(ee)}},P=N=>{N&&(y("plan",N,{shouldDirty:!0}),u(N))};return h.useEffect(()=>{m({new_name:`${t.name}(Copy)`,startedAt:t.started_at?K(t.started_at):null,dueDate:t.due_date?K(t.due_date):null,keepAssignee:!1,plan:null})},[t,n]),{isShow:n,isLoading:l,selectedPlan:d,handleSelectPlan:P,handleSave:I,handleShow:$,handleCancel:k,isDirty:f,errors:r,formErrors:x,control:g,handleSubmitForm:p(I),isDisabled:l||!_,setDateFrom:w,setDateTo:b,disabledDateFrom:S,disabledDateTo:C}},Ei=h.memo(({as:t,testPlan:s,onSubmit:a})=>{const{t:n}=T(),{projectId:i}=Q(),[r]=Cn(),[o]=na(),{isShow:c,isLoading:l,handleCancel:d,handleShow:u,selectedPlan:p,handleSelectPlan:m,errors:g,formErrors:f,control:x,handleSubmitForm:y,isDisabled:j,setDateFrom:_,setDateTo:w,disabledDateFrom:b,disabledDateTo:S}=Cg({testPlan:s,onSubmit:a});return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{id:"copy-test-plan",onClick:u,children:t}):e.jsx(L,{id:"copy-test-plan",icon:e.jsx(rs,{}),onClick:u,children:n("Copy")}),e.jsxs(he,{className:"copy-test-plan-modal",title:`${n("Copy Test Plan")} '${s.name}'`,open:c,onCancel:d,centered:!0,footer:[e.jsx(L,{id:"cancel-btn",onClick:d,children:n("Cancel")},"back"),e.jsx(L,{id:"save-btn",type:"primary",loading:l,onClick:y,disabled:j,children:n("Save")},"submit")],children:[e.jsxs(R,{id:"copy-test-plan-form",layout:"vertical",onFinish:y,children:[e.jsx(R.Item,{label:n("New Plan name"),children:e.jsx(F,{name:"new_name",control:x,render:({field:C})=>e.jsx(se,{id:"copy-test-plan-form-name",placeholder:n("Please enter a name"),...C,autoFocus:!0})})}),e.jsx(Fa,{id:"copy-test-plan-select",control:x,name:"parent",label:n("Parent plan"),placeholder:n("Search a test plan"),formErrors:f,externalErrors:g,getData:r,getAncestors:o,dataParams:{project:i},skipInit:!c,selected:p,onSelect:m}),e.jsxs("div",{className:wg.datesRow,children:[e.jsx(ln,{id:"copy-test-plan-start-date",control:x,label:n("Start date"),name:"startedAt",setDate:_,disabledDate:b,formStyles:{width:"100%"},formErrors:f,externalErrors:g,defaultDate:K()}),e.jsx("span",{children:"-"}),e.jsx(ln,{id:"copy-test-plan-due-date",control:x,label:n("Due date"),name:"dueDate",setDate:w,disabledDate:S,formStyles:{width:"100%"},formErrors:f,externalErrors:g,defaultDate:K().add(1,"day")})]}),e.jsx(R.Item,{name:n("Keep Assignee"),children:e.jsx(F,{name:"keepAssignee",control:x,render:({field:C})=>e.jsx(ts,{...C,checked:C.value,onChange:v=>C.onChange(v.target.checked),children:n("Include Test Cases Assignment")})})})]}),!!g.length&&e.jsx(gs,{style:{marginBottom:0,marginTop:16},description:g,type:"error"})]})]})});Ei.displayName="CopyTestPlan";const Tg=({onSubmit:t})=>{const[s,a]=h.useState(!1),[n,i]=h.useState([]),[r,o]=h.useState(null),{handleSubmit:c,reset:l,control:d,formState:{isDirty:u,errors:p},setValue:m}=we({defaultValues:{plan:null}}),g=_=>{Se(_)},f=()=>{a(!1),i([]),l()},x=()=>{a(!0)},y=async({plan:_})=>{if(_!=null&&_.value)try{await t(_.value),f()}catch(w){g(w)}},j=_=>{_&&(m("plan",_,{shouldDirty:!0}),o(_))};return h.useEffect(()=>{l({plan:null}),o(null)},[s]),{isShow:s,selectedPlan:r,handleSelectPlan:j,handleSave:y,handleShow:x,handleCancel:f,isDirty:u,errors:n,formErrors:p,control:d,handleSubmitForm:c(y)}},kg=t=>{const{t:s}=T(),[a]=Cn(),[n]=na(),{isShow:i,handleCancel:r,handleShow:o,selectedPlan:c,handleSelectPlan:l,errors:d,formErrors:u,control:p,handleSubmitForm:m}=Tg(t);return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"move-tests",icon:e.jsx(rs,{}),onClick:o,children:s("Move tests")}),e.jsxs(he,{className:"move-tests-modal",title:s("Move test to plan"),open:i,onCancel:r,centered:!0,footer:[e.jsx(L,{id:"cancel-btn",onClick:r,children:s("Cancel")},"back"),e.jsx(L,{id:"save-btn",type:"primary",loading:t.isLoading,onClick:m,children:s("Save")},"submit")],children:[e.jsx(R,{id:"move-tests-form",layout:"vertical",onFinish:m,children:e.jsx(Fa,{id:"move-tests-select",control:p,name:"plan",label:s("Parent plan"),placeholder:s("Search a test plan"),formErrors:u,externalErrors:d,getData:a,getAncestors:n,skipInit:!i,selected:c,onSelect:l})}),!!d.length&&e.jsx(gs,{style:{marginBottom:0,marginTop:16},description:d,type:"error"})]})]})},ta=h.memo(({type:t,as:s,testPlan:a,size:n="default",colorType:i="default"})=>{const{t:r}=T(),{projectId:o,testPlanId:c}=Q(),l=De(),d=()=>{var x;const m=new URL(`${window.location.origin}/projects/${o}/plans/${t==="create"?"new":`${a==null?void 0:a.id}/edit`}-test-plan`),g=new URLSearchParams(window.location.search),f=(t==="create"?a==null?void 0:a.id.toString():(x=a==null?void 0:a.parent)==null?void 0:x.id.toString())??c;f&&m.searchParams.append("parentTestPlan",f),m.searchParams.append("prevUrl",g.get("prevUrl")?g.get("prevUrl")??"":`${window.location.pathname}${window.location.search}`),l(`${m.pathname}${m.search}`,{state:{testPlan:a}})},u=()=>n==="small"?"":r(t==="create"?a?"Create Child Test Plan":"Create":"Edit"),p=()=>t==="create"?a?"create-child-test-plan":"create-test-plan":"edit-test-plan";return s?e.jsx("div",{id:p(),onClick:d,children:s}):e.jsx(L,{id:p(),icon:t==="create"?e.jsx(ct,{}):e.jsx(Ke,{}),onClick:d,type:i,disabled:a==null?void 0:a.is_archive,shape:n==="default"?"default":"circle",children:u()})});ta.displayName="ChangeTestPlan";const Ig="_datesRow_1e6jl_1",$g="_form_1e6jl_15",hr={datesRow:Ig,form:$g},Bi=({setValue:t,testCase:s,isShow:a,isEditMode:n,defaultLabels:i=[]})=>{const{projectId:r}=Q(),[o,c]=h.useState([]),[l,d]=h.useState(""),[u,p]=h.useState(!1),{data:m}=ki({project:r??""},{skip:!r||!a}),g=_=>{const w=o.filter(C=>C.name.toLowerCase()!==_.toLowerCase()),b=m==null?void 0:m.find(C=>C.name.toLowerCase()===_.toLowerCase()),S=[...w,{name:_,id:b==null?void 0:b.id}];c(S),d(""),p(!1),t("labels",S,{shouldDirty:!0})},f=_=>{const w=o.filter(b=>b.name!==_);c(w),t("labels",w,{shouldDirty:!0})},x=(_,w)=>{_.key==="Enter"&&g(w)};h.useEffect(()=>{p(!!l.length)},[l]),h.useEffect(()=>{!s||!n||(c(s.labels),t("labels",s.labels))},[s,a,n]);const y=h.useMemo(()=>m?o.length?m.filter(({name:_})=>!o.some(({name:w})=>_===w)):m:[],[o,m]);h.useEffect(()=>{m&&c(m.filter(_=>_.id&&i.includes(typeof _.id=="number"?_.id:parseInt(_.id))))},[m]);const j=h.useMemo(()=>y.filter(_=>_.name.toLowerCase().includes(l.toLowerCase())),[l,y]);return{labels:o,searchingLabels:j,searchValue:l,isShowPopup:u,setLabels:c,setSearchValue:d,setIsShowPopup:p,handleAddLabel:g,handleDeleteLabel:f,handleSubmitInput:x}},yt=(t,s={})=>{const a=new URLSearchParams(s.url??window.location.search),{ignoredUnscheme:n=!0}=s,i=Object.entries(t).reduce((r,[o,{format:c,default:l}])=>{const d=a.get(o);let u;return d!==null?u=c?c(d):d:l!==void 0?u=l:u=void 0,r[o]=u,r},{});return n||a.forEach((r,o)=>{o in t||(i[o]=r)}),i},ul={ordering:{default:"name"}},hl={name_or_id:"",suites:[],is_archive:void 0,labels:[],not_labels:[],labels_condition:void 0,test_suite_created_before:void 0,test_suite_created_after:void 0,test_case_created_before:void 0,test_case_created_after:void 0},pn={name_or_id:{default:""},suites:{format:Ls,default:[]},labels:{format:Ls,default:[]},not_labels:{format:Ls,default:[]},labels_condition:{format:t=>t==="and"?"and":"or"},is_archive:{format:t=>t==="true"},test_suite_created_before:{},test_suite_created_after:{},test_case_created_before:{},test_case_created_after:{}},Lg=yt(ul),Gt=yt(pn),pr={filter:{name_or_id:Gt.name_or_id,suites:Gt.suites,is_archive:Gt.is_archive,labels:Gt.labels,not_labels:Gt.not_labels,labels_condition:Gt.labels_condition,test_suite_created_before:Gt.test_suite_created_before,test_suite_created_after:Gt.test_suite_created_after,test_case_created_before:Gt.test_case_created_before,test_case_created_after:Gt.test_case_created_after},settings:{selected:null,editing:!1,editingValue:"",creatingNew:!1,hasUnsavedChanges:!1},ordering:Lg.ordering},wa=mo("testCasesFilter/updateFilter"),pl=Pt({name:"testCasesFilter",initialState:pr,reducers:{clearFilter:t=>{t.filter=hl},updateFilterSettings:(t,s)=>{t.settings={...t.settings,...s.payload}},resetFilterSettings:t=>{t.settings=pr.settings},updateOrdering:(t,s)=>{t.ordering=s.payload}},extraReducers:t=>{t.addCase(wa,(s,a)=>{s.filter={...s.filter,...a.payload}})}}),{clearFilter:ei,updateFilterSettings:Oi,updateOrdering:ti,resetFilterSettings:Ag}=pl.actions,In=t=>t.testCasesFilter.filter,ml=t=>t.testCasesFilter.settings,gl=t=>Object.entries(t.testCasesFilter.filter).reduce((s,[a,n])=>{const i=hl[a];if(Array.isArray(n)){if(n.length>0)return s+1}else if(n!==i)return s+1;return s},0),Pa=t=>t.testCasesFilter.ordering,Pg=pl.reducer,$n={page:{format:t=>Number(t),default:1},page_size:{format:t=>Number(t),default:10}},xl=(t="name")=>({ordering:{default:t}}),mr=[{key:"id",title:"ID"},{key:"name",title:"Name"},{key:"suite_path",title:"Test Suite"},{key:"labels",title:"Labels"},{key:"estimate",title:"Estimate"},{key:"created_at",title:"Created At"}],gr=[{key:"name",title:"Name"},{key:"id",title:"ID"},{key:"labels",title:"Labels"},{key:"estimate",title:"Estimate"},{key:"created_at",title:"Created At"}],xr=yt($n),Ha={drawerTestCase:null,editingTestCase:null,settings:{table:{columns:mr,visibleColumns:nn("test-cases-visible-cols-table")??mr,page:xr.page,page_size:xr.page_size,_n:0},tree:{columns:gr,visibleColumns:nn("test-cases-visible-cols-tree")??gr}}},fl=Pt({name:"testCase",initialState:Ha,reducers:{setDrawerTestCase:(t,s)=>{t.drawerTestCase=s.payload},setDrawerTestCaseIsArchive:(t,s)=>{t.drawerTestCase&&(t.drawerTestCase={...t.drawerTestCase,is_archive:s.payload})},clearDrawerTestCase:t=>{t.drawerTestCase=null},updateSettings:(t,s)=>{t.settings[s.payload.key]={...t.settings[s.payload.key],...s.payload.settings}},setPagination:(t,s)=>{t.settings[s.payload.key]={...t.settings[s.payload.key],page:s.payload.pagination.page,page_size:s.payload.pagination.page_size}},clearSettings:t=>{t.settings={tree:Ha.settings.tree,table:{...Ha.settings.table,page:1,page_size:10}}}},extraReducers:t=>{t.addCase(wa,s=>{s.settings.table.page=1,s.settings.table.page_size=Ha.settings.table.page_size})}}),{setDrawerTestCase:hs,clearDrawerTestCase:qi,setDrawerTestCaseIsArchive:Ng,updateSettings:jl,clearSettings:YI,setPagination:Rg}=fl.actions,Dg=fl.reducer,mn=t=>s=>s.testCase.settings[t],zi=t=>t.testCase.drawerTestCase,Mg=({steps:t,setSteps:s})=>{const[a,n]=h.useState(null),[i,r]=h.useState(!1),[o,c]=h.useState(!0),l=()=>t.reduce((j,_)=>j>_.sort_order?j:_.sort_order,0),d=j=>{j.preventDefault();const _=l(),w={id:pi(),name:"",scenario:"",expected:"",sort_order:_+1,attachments:[]};n(w),r(!1)},u=j=>{const _=t.concat(j);s(_),n(null)},p=j=>{const _=t.map(w=>w.id===j.id?{id:w.id,name:j.name,scenario:j.scenario,expected:j.expected,sort_order:w.sort_order,attachments:j.attachments}:w);s(_),n(null)};return{handleStep:d,handleSortSteps:j=>{if(o){c(!1);return}const _=j.map((w,b)=>({...w,sort_order:b+1}));s(_)},handleDeleteStep:j=>{const _=t.filter(w=>w.id!==j);s(_)},handleClickCloseModal:()=>{r(!1),n(null)},handleClickEditStep:j=>{r(!0),n(j)},isEdit:i,modalStep:a,handleSubmit:j=>{if(i){p(j);return}u(j)}}},Fg=({step:t,onSubmit:s,onCloseModal:a})=>{const{project:n}=h.useContext(J),{showModal:i}=Ot(),{handleSubmit:r,control:o,setValue:c,register:l,clearErrors:d,formState:{isDirty:u,errors:p}}=we({defaultValues:{name:"",scenario:"",expected:"",attachments:[]}}),{attachments:m,attachmentsIds:g,isLoading:f,setAttachments:x,onRemove:y,onLoad:j,onChange:_}=ls(o,n.id),w=()=>{a(),d()},b=()=>{if(u){i(w);return}w()},S=({name:C,scenario:v,expected:k})=>{t&&s({id:t.id,name:C,scenario:v,expected:k,sort_order:t.sort_order,attachments:m})};return h.useEffect(()=>{if(!t)return;const C=t.attachments.map(v=>({...v,uid:String(v.id)}));c("name",t.name),c("scenario",t.scenario),c("expected",t.expected),x(C),d()},[t]),{handleClose:b,handleSubmit:r,onSubmitForm:S,isLoading:f,isDirty:u,errors:p,control:o,onLoad:j,attachments:m,setAttachments:x,attachmentsIds:g,setValue:c,onChange:_,register:l,onRemove:y}},kt="cases",gn=Je.createApi({reducerPath:"testCaseApi",baseQuery:pt,tagTypes:["TestCase","TestCaseHistoryChanges","TestCaseTestsList"],endpoints:t=>({searchTestCases:t.query({query:s=>({url:`${kt}/search/`,params:s})}),createTestCase:t.mutation({query:s=>({url:`${kt}/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(Zs),a(da),a(Ws()),a(It)},invalidatesTags:[{type:"TestCase",id:"LIST"}]}),deleteTestCase:t.mutation({query:s=>({url:`${kt}/${s}/`,method:"DELETE"}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(Zs),a(da),a(Ws()),a(It)},invalidatesTags:[{type:"TestCase",id:"LIST"}]}),updateTestCase:t.mutation({query:s=>({url:`${kt}/${s.id}/`,method:"PUT",body:s}),async onQueryStarted(s,{queryFulfilled:a,dispatch:n}){try{const{data:i}=await a;n(Zs),n(da),n(Ws()),n(hs(i))}catch(i){console.error(i)}},invalidatesTags:(s,a,{id:n,current_version:i})=>s?[{type:"TestCase",id:n},{type:"TestCase",id:"LIST"},{type:"TestCaseHistoryChanges",id:i}]:[{type:"TestCase",id:"LIST"},{type:"TestCaseHistoryChanges",id:"LIST"}]}),archiveTestCase:t.mutation({query:s=>({url:`${kt}/${s}/archive/`,method:"POST"}),invalidatesTags:(s,a,n)=>[{type:"TestCase",id:"LIST"},{type:"TestCase",id:n}],async onQueryStarted(s,{queryFulfilled:a,dispatch:n}){try{await a,n(Ng(!0)),n(It),n(Ws())}catch(i){console.error(i)}}}),getTestCaseById:t.query({query:({testCaseId:s,...a})=>({url:`${kt}/${s}/`,params:a}),providesTags:(s,a,{testCaseId:n})=>[{type:"TestCase",id:n}]}),getTestCaseDeletePreview:t.query({query:s=>({url:`${kt}/${s}/delete/preview/`})}),getTestCaseArchivePreview:t.query({query:s=>({url:`${kt}/${s}/archive/preview/`})}),copyTestCase:t.mutation({query:s=>({url:`${kt}/copy/`,method:"POST",body:s}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){await n,a(Zs),a(da),a(Ws())},invalidatesTags:[{type:"TestCase",id:"LIST"}]}),getTestCaseHistoryChanges:t.query({query:({testCaseId:s,...a})=>({url:`${kt}/${s}/history/`,params:a}),providesTags:s=>$t(s==null?void 0:s.results,"TestCaseHistoryChanges","version")}),getTestCaseTestsList:t.query({query:({testCaseId:s,...a})=>({url:`${kt}/${s}/tests/`,params:a}),providesTags:s=>$t(s==null?void 0:s.results,"TestCaseTestsList")}),restoreTestCase:t.mutation({query:({testCaseId:s,...a})=>({url:`${kt}/${s}/version/restore/`,method:"POST",body:a}),async onQueryStarted(s,{dispatch:a,queryFulfilled:n}){const{data:i}=await n;a(Zs),a(da),a(Ws()),a(hs(i))},invalidatesTags:[{type:"TestCase",id:"LIST"}]}),getTestPlanTestCases:t.query({query:s=>({url:`${kt}/`,params:{...s,parent:"null"}})})})}),{useLazySearchTestCasesQuery:Eg,useGetTestCaseByIdQuery:yl,useLazyGetTestCaseByIdQuery:Bg,useCreateTestCaseMutation:Og,useUpdateTestCaseMutation:qg,useArchiveTestCaseMutation:zg,useDeleteTestCaseMutation:Ug,useGetTestCaseDeletePreviewQuery:Vg,useCopyTestCaseMutation:Hg,useGetTestCaseHistoryChangesQuery:Yg,useGetTestCaseTestsListQuery:Wg,useGetTestCaseArchivePreviewQuery:Qg,useRestoreTestCaseMutation:Gg,useGetTestPlanTestCasesQuery:Kg}=gn,Jg=({isShow:t})=>{const{projectId:s}=Q(),[a,n]=h.useState(""),[i,r]=h.useState([]),[o,c]=h.useState(!1),[l]=Eg(),[d,u]=h.useState([]);return h.useEffect(()=>{if(!t||!s)return;(async()=>{c(!0);const x=await l({project:s}).unwrap(),y=Kn(x);r(y),c(!1)})()},[t,s]),{searchText:a,treeData:i,expandedRowKeys:d,isLoading:o,onSearch:async(f,x,y,j=!1)=>{if(!s||!t)return;f!==a&&n(f),c(!0);const _=await l({project:s,search:f,labels:x,labels_condition:x.length>1?y:void 0,is_archive:j}).unwrap(),w=Kn(_),[b]=sn.filterRows(w,f,{isAllExpand:!0,isShowChildren:!0});!f.trim().length&&!x.length&&u([]),r(b),c(!1)},onRowExpand:(f,x)=>{f.includes(x)?u(f.filter(y=>y!==x)):u([...f,x])},onClearSearch:()=>{n(""),r([]),u([])}}},_l=({mode:t,setValue:s})=>{const{projectId:a,testSuiteId:n}=Q(),{data:i,isLoading:r}=La({project:a??""},{skip:!a}),o=h.useMemo(()=>i?i.filter(j=>j.applied_to.testcase).filter(j=>j.applied_to.testcase.suite_ids.length&&n?j.applied_to.testcase.suite_ids.includes(Number(n)):!0).map(j=>Tn({attribute:j,model:"testcase"})):[],[i]),c=j=>{s("attributes",j,{shouldDirty:!0})},{attributes:l,addAttribute:d,getAttributeJson:u,onAttributeChangeName:p,onAttributeChangeType:m,onAttributeChangeValue:g,onAttributeRemove:f,resetAttributes:x,setAttributes:y}=kn({mode:t,initAttributes:o,setValue:c,getJsonAdditionalParams:{required:!1}});return{attributes:l,isLoading:r,initAttributes:o,setAttributes:y,resetAttributes:x,addAttribute:d,onAttributeChangeType:m,onAttributeChangeValue:g,onAttributeChangeName:p,onAttributeRemove:f,getAttributeJson:u}},bl=(t,s=[])=>(t.parent===null?s.push(t):s=[t,...bl(t.parent,s)],s),Zg=t=>t.map(s=>{switch(s){case"added":return"+";case"deleted":return"-";case"updated":return"~";default:return""}}).join(","),vl=t=>{const s=[];if(t.test_cases)for(const a of t.test_cases)s.push(String(a.id));if(t.children)for(const a of t.children)a.key.startsWith("TS")&&s.push(...vl(a));return s},Xg=(t,s,a)=>{const n=new Set(a),i=s.node.key.startsWith("TS"),r=t.filter(c=>!c.startsWith("TS")),o=i?vl(s.node):r;return!s.checked||s.node.halfChecked?i?o.forEach(c=>n.delete(c)):n.delete(s.node.key):o.forEach(c=>n.add(c)),Array.from(n)},ex="_label_12gg9_1",tx="_btn_12gg9_21",Mn={label:ex,btn:tx},js=({content:t,color:s,onDelete:a,onClick:n,onEdit:i})=>e.jsxs(Ps,{className:Mn.label,color:s!=="line-through"?s:Oe.accent,style:{cursor:n?"pointer":"default",textDecoration:s==="line-through"?"line-through":void 0},onClick:n?()=>n({name:t}):void 0,"data-testid":`label-${t}`,children:[t,i&&e.jsx(L,{id:"label-edit",className:Mn.btn,icon:e.jsx(Ke,{style:{fontSize:14}}),shape:"default",onClick:()=>i({name:t}),"data-testid":`label-edit-${t}`}),a&&e.jsx(L,{id:"label-delete",className:Mn.btn,icon:e.jsx(Ta,{style:{fontSize:14}}),shape:"default",onClick:()=>a({name:t}),"data-testid":`label-delete-${t}`})]}),sx="_wrapper_13tz4_1",ax="_form_13tz4_13",nx="_list_13tz4_23",ix="_popup_13tz4_57",rx="_line_13tz4_119",ox="_newLabel_13tz4_133",ds={wrapper:sx,form:ax,list:nx,popup:ix,line:rx,newLabel:ox},Ui=({fieldProps:t,labelProps:{labels:s,searchValue:a,searchingLabels:n,setSearchValue:i,isShowPopup:r,setIsShowPopup:o,handleAddLabel:c,handleDeleteLabel:l,handleSubmitInput:d},noAdding:u})=>{const{t:p}=T(),m=h.useRef(null);Ti(m,()=>o(!1));const g=()=>{o(!r)},f=j=>{const _=j.target.value.trimStart();i(_)},x=h.useMemo(()=>a.length?n.some(j=>j.name.toLowerCase()===a.toLowerCase()):!0,[n,a]),y=h.useMemo(()=>!s.length||!a.length?!1:!!s.some(j=>j.name.toLowerCase()===a.toLowerCase()),[s,a]);return e.jsxs("div",{className:ds.wrapper,"data-testid":"label-wrapper",children:[e.jsxs("div",{className:ds.form,children:[e.jsx(se,{id:"label-input",placeholder:p("New label"),suffix:e.jsx(lo,{id:"label-input-arrow",style:{cursor:"pointer"},onClick:g}),value:a,onChange:f,onKeyDown:j=>d(j,a),onBlur:t==null?void 0:t.onBlur,"data-testid":"label-wrapper-input"}),r&&e.jsx("div",{id:"label-popup",className:ds.popup,ref:m,"data-testid":"label-wrapper-popup",children:e.jsxs("ul",{children:[n.map(j=>e.jsx("li",{onClick:()=>c(j.name),"data-testid":`label-wrapper-label-${j.name}`,children:e.jsx(Lt,{searchWords:a,textToHighlight:j.name})},j.id)),y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:ds.line}),e.jsxs("span",{className:ds.newLabel,onClick:()=>c(a),"data-testid":"label-wrapper-already-added",children:[e.jsx(Lt,{searchWords:a,textToHighlight:a}),"(",p("Already added"),")"]})]}),!x&&!y&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:ds.line}),e.jsxs("span",{className:ds.newLabel,onClick:()=>c(a),"data-testid":"label-wrapper-new-label",children:[e.jsx(Lt,{searchWords:a,textToHighlight:a}),"(",p("New label"),")"]})]})]})})]}),!!s.length&&e.jsx("ul",{id:"label-list",className:ds.list,children:s.map(j=>e.jsx("li",{children:e.jsx(js,{content:j.name,onDelete:()=>l(j.name),color:Oe.accent})},j.id))})]})},lx="_list_1a0io_1",cx={list:lx},dx=({title:t,labels:s})=>e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:t}),e.jsx("ul",{className:cx.list,"data-testid":"labels-list",children:s.map(a=>e.jsx("li",{children:e.jsx(js,{content:a.name,color:Oe.accent})},a.id))})]}),ux=()=>e.jsxs("ul",{style:{display:"flex",flexWrap:"wrap",gap:8,margin:0},children:[e.jsx(fe,{width:42,height:22,style:{borderRadius:"100px"}}),e.jsx(fe,{width:46,height:22,style:{borderRadius:"100px"}}),e.jsx(fe,{width:70,height:22,style:{borderRadius:"100px"}}),e.jsx(fe,{width:64,height:22,style:{borderRadius:"100px"}}),e.jsx(fe,{width:56,height:22,style:{borderRadius:"100px"}})]}),hx="_list_zljl3_1",px="_maxSize_zljl3_23",mx="_showMore_zljl3_33",gx="_noData_zljl3_41",Ya={list:hx,maxSize:px,showMore:mx,noData:gx},Sl=({value:t,onChange:s})=>{const{t:a}=T(),{project:n}=h.useContext(J),{data:i,isLoading:r}=ki({project:n.id.toString()}),[o,c]=h.useState(!1),[l,d]=h.useState(!1),u=h.useRef(null),p=g=>{const f=Number(g.id),x=t.labels.find(j=>j===f),y=t.not_labels.find(j=>j===f);if(!x&&!y){const j={...t,labels:[...t.labels,f]};s(j);return}if(x){const j={...t,labels:t.labels.filter(_=>_!==f),not_labels:[...t.not_labels,f]};s(j);return}if(y){const j={...t,labels:t.labels.filter(_=>_!==f),not_labels:t.not_labels.filter(_=>_!==f)};s(j);return}},m=()=>{c(!0),d(!1)};return h.useEffect(()=>{if(!u.current||!(i!=null&&i.length))return;const g=()=>{d(u.current.scrollHeight>52)};g();const f=new ResizeObserver(g);return f.observe(u.current),()=>f.disconnect()},[i]),r?e.jsx(ux,{}):i!=null&&i.length?e.jsxs(e.Fragment,{children:[e.jsx("ul",{ref:u,id:"label-filter",className:V(Ya.list,{[Ya.maxSize]:o}),children:(i??[]).map(g=>{const f=t.labels.some(j=>j===g.id),x=t.not_labels.some(j=>j===g.id),y=f?Oe.accent:x?"line-through":void 0;return e.jsx("li",{"data-testid":`label-filter-label-${g.name}`,children:e.jsx(js,{content:g.name,color:y,onClick:()=>p(g)})},g.id)})}),l&&!o&&e.jsx("button",{type:"button",className:V("link-button",Ya.showMore),onClick:m,"data-testid":"label-filter-show-more",children:a("Show more")})]}):e.jsx("span",{className:Ya.noData,children:a("No data")})},xx="_btn_1pff0_1",fx="_btnInActive_1pff0_11",Wa={btn:xx,btnInActive:fx},wl=({value:t,onChange:s,disabled:a=!1})=>{const{t:n}=T();return e.jsxs(M,{children:[e.jsx(L,{htmlType:"button",className:V(Wa.btn,{[Wa.btnInActive]:t!=="and"}),onClick:()=>s("and"),disabled:a,"data-testid":"label-filter-condition-and",children:n("and").toUpperCase()}),e.jsx(L,{htmlType:"button",className:V(Wa.btn,{[Wa.btnInActive]:t!=="or"}),onClick:()=>s("or"),disabled:a,"data-testid":"label-filter-condition-or",children:n("or").toUpperCase()})]})},jx="_labels_1ea1l_1",yx="_extra_1ea1l_11",fr={labels:jx,extra:yx},jr=3,_x=({labels:t})=>{const{t:s}=T(),a=t.slice(0,jr);return e.jsxs("div",{className:fr.labels,"data-testid":"test-case-labels",children:[a.map(n=>e.jsx(js,{content:n,"data-testid":`test-case-label-${n}`},n)),t.length>jr&&e.jsx(le,{title:`${s("Labels")}: ${t.join(", ")}`,children:e.jsx(G.Text,{className:fr.extra,children:"..."})})]})},bx="_treeBlock_12i26_1",vx="_switcher_12i26_9",Sx="_filterBtn_12i26_17",wx="_row_12i26_25",Cx="_rowWithThree_12i26_41",Tx="_container_12i26_49",kx="_form_12i26_61",Ix="_archivedRow_12i26_89",Kt={treeBlock:bx,switcher:vx,filterBtn:Sx,row:wx,rowWithThree:Cx,container:Tx,form:kx,archivedRow:Ix},$x=({labelProps:t,searchText:s,handleSearch:a,selectedLables:n,lableCondition:i,handleConditionClick:r,showArchived:o,handleToggleArchived:c})=>{const{t:l}=T(),[d,u]=h.useState(!1),p=()=>{u(!d)},m=e.jsx("div",{id:"test-cases-filter-btn",onClick:p,className:Kt.filterBtn,children:d?e.jsx(uo,{}):e.jsx(fd,{})}),g=d&&e.jsxs("div",{className:Kt.form,children:[e.jsxs("div",{className:Kt.row,children:[e.jsx(G.Text,{children:l("Name")}),e.jsx(mi,{placeholder:l("Search"),onChange:f=>a(f.target.value,n,i),value:s,className:Kt.search,"data-testid":"test-cases-filter-search"})]}),e.jsxs("div",{className:V(Kt.row,Kt.rowWithThree),children:[e.jsx(G.Text,{children:l("Labels")}),e.jsx(Ui,{labelProps:t,noAdding:!0}),e.jsx(Wt,{checkedChildren:l("or"),unCheckedChildren:l("and"),defaultChecked:!0,className:Kt.switcher,checked:i==="or",onChange:r,disabled:n.length<2,"data-testid":"test-cases-filter-switcher"})]}),e.jsxs("div",{className:Kt.archivedRow,children:[e.jsx(G.Text,{children:l("Show Archived")}),e.jsx(Wt,{checkedChildren:l("yes"),unCheckedChildren:l("no"),defaultChecked:!0,className:Kt.switcher,checked:o,onChange:c,"data-testid":"test-cases-filter-switcher-archived"})]})]});return{FilterButton:m,FilterForm:g}},Lx=({errors:t,control:s})=>{const{t:a}=T(),[n,i]=h.useState([]),[r,o]=h.useState("and"),[c,l]=h.useState(!1),d=()=>{o(r==="and"?"or":"and")},u=()=>{l(!c)},p=(S,C,v)=>{i(C.map($=>$.id).filter($=>$!==void 0))},{searchText:m,treeData:g,expandedRowKeys:f,isLoading:x,onSearch:y,onRowExpand:j}=Jg({isShow:!0}),_=Bi({setValue:p,testCase:null,isShow:!0,isEditMode:!1,defaultLabels:n}),{FilterButton:w,FilterForm:b}=$x({labelProps:_,searchText:m,handleSearch:y,selectedLables:n,lableCondition:r,handleConditionClick:d,showArchived:c,handleToggleArchived:u});return h.useEffect(()=>{y(m,n,r,c)},[n,r,c]),e.jsx(R.Item,{label:e.jsxs("div",{style:{display:"flex",height:22},children:[e.jsx(G.Paragraph,{style:{margin:0},children:a("Test Cases")}),w]}),validateStatus:t!=null&&t.test_cases?"error":"",help:t!=null&&t.test_cases?t.test_cases:"",children:e.jsx(F,{name:"test_cases",control:s,render:({field:S})=>{const C=S.value.filter(v=>!v.startsWith("TS"));return e.jsxs(e.Fragment,{children:[b,x&&e.jsx(zt,{}),!x&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{"data-testid":"create-test-plan-tree-selected",style:{display:"block",opacity:.7,marginBottom:8},children:[a("Selected"),": ",C.length," ",a("Test Cases").toLowerCase()]}),e.jsx(go,{"data-testid":"create-test-plan-tree",...S,titleRender:v=>e.jsxs(e.Fragment,{children:[e.jsxs(M,{"data-testid":`test-case-title-${v.name}`,gap:6,align:"center",children:[v.is_archive&&e.jsx(wt,{"data-testid":`test-case-archived-tag-${v.name}`,size:"sm"}),v.title]}),v.labels?e.jsx(_x,{labels:v.labels}):null]}),virtual:!1,showIcon:!0,checkable:!0,selectable:!1,treeData:sn.deleteChildren(g),checkedKeys:S.value,onCheck:(v,k)=>{S.onChange(Xg(v,k,S.value))},expandedKeys:f,onExpand:(v,k)=>{j(f,String(k.node.key))},className:Kt.treeBlock})]})]})}})})},Ax={showArchivedResults:!1,tests:[]},Cl=Pt({name:"testPlan",initialState:Ax,reducers:{showArchivedResults:t=>{t.showArchivedResults=!t.showArchivedResults},setTests:(t,s)=>{t.tests=s.payload}}}),{showArchivedResults:Px,setTests:WI}=Cl.actions,Nx=Cl.reducer,Tl=t=>t.testPlan.showArchivedResults,Rx=t=>t.testPlan.tests,kl="null",Dx="_image_154w6_1",Mx={image:Dx},Ut=({avatar_link:t,nonce:s=1,size:a=32})=>e.jsx("div",{className:Mx.image,style:{minWidth:a,minHeight:a},children:t?e.jsx("img",{id:"username-photo",src:`${t}?nonce=${s}`,alt:"avatar",style:{minWidth:a,width:a,height:a},loading:"lazy"}):e.jsx(xo,{icon:e.jsx(po,{id:"username-icon"}),size:a})}),fa=({user:t})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:8},children:[e.jsx("div",{style:{width:20,height:20},children:e.jsx(Ut,{avatar_link:t.avatar_link,size:20})}),e.jsx("span",{children:t.username})]}),Fx=({value:t,placeholder:s,project:a,onChange:n,onClear:i,onClose:r})=>{const{t:o}=T(),{me:c}=h.useContext(Pe),[l,d]=h.useState(""),[u,p]=h.useState([]),[m,g]=h.useState([]),[f,x]=h.useState(!1),[y,j]=h.useState(!1),[_,w]=h.useState(!1),[b]=Do(),[S]=Au(),[C,v]=h.useState(!1),[k,$]=h.useState(!1),{ref:I,inView:P}=gi(),[N,A]=h.useState(1),q=U=>{const E=new Set(m.map(D=>D.id));return U.filter(D=>!E.has(D.id)&&D.id!==(c==null?void 0:c.id))},O=async U=>{if(!U.length){p([]),d(""),v(!1);return}const E=a?{[a.is_private?"project":"exclude_external"]:a.id}:{};x(!0);const D=await b({page:1,page_size:10,username:U,...E}).unwrap();D.pages.next||v(!0),p(q(D.results)),d(U),x(!1)},Y=U=>{if(!U.length){i();return}n(U)},ee=U=>{$(U),U||r==null||r()};return h.useEffect(()=>{if(!P||!l.length||C||f)return;(async()=>{j(!0);const E=await b({page:N+1,page_size:10,username:l}).unwrap();E.pages.next||v(!0);const D=q(E.results);p(ae=>[...ae,...D]),E.pages.current<E.pages.total&&A(ae=>ae+1),j(!1)})()},[P,l,C,f]),h.useEffect(()=>{if(!(t!=null&&t.length)||_||m.length)return;const U=t.filter(D=>D!==String(c==null?void 0:c.id)&&D!=="null"&&D.length);(async()=>{w(!0);const D=[];for(const ae of U){const oe=await S(Number(ae)).unwrap();D.push(oe)}g(D),v(!0),w(!1)})()},[t,_,c]),h.useEffect(()=>{const U=new Set(m.map(D=>D.id)),E=u.filter(D=>!U.has(D.id));p(E)},[m]),e.jsxs(ue,{id:"assignee-filter",value:t??[],mode:"multiple",showSearch:!0,loading:_||f,placeholder:s??o("Search a user"),defaultActiveFirstOption:!1,showArrow:!0,filterOption:!1,onSearch:O,onChange:Y,onClear:i,open:k,onDropdownVisibleChange:ee,notFoundContent:o("No matches"),allowClear:!0,style:{width:"100%"},children:[e.jsx(ue.Option,{value:kl,"data-testid":"assignee-filter-not-assigned",children:o("Not Assigned")}),c&&e.jsx(ue.Option,{value:String(c.id),"data-testid":"assignee-filter-me",children:e.jsx(fa,{user:c})}),!_&&m.map(U=>e.jsx(ue.Option,{value:String(U.id),"data-testid":`assignee-filter-user-${U.username}`,children:e.jsx(fa,{user:U})},U.id)),!f&&u.map(U=>e.jsx(ue.Option,{value:String(U.id),"data-testid":`assignee-filter-user-${U.username}`,children:e.jsx(fa,{user:U})},U.id)),!!u.length&&!C&&!y&&e.jsx(ue.Option,{value:"",children:e.jsx("div",{ref:I})}),y&&e.jsx(ue.Option,{value:"",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(St,{})})})]})},Il=({selectedUser:t,handleClear:s,handleChange:a,placeholder:n,project:i})=>{const{t:r}=T(),[o,c]=h.useState(""),[l,d]=h.useState([]),[u,p]=h.useState(!1),[m,{data:g,isLoading:f}]=Do(),[x,y]=h.useState(!1),{ref:j,inView:_}=gi(),[w,b]=h.useState(1),S=async v=>{if(!v.length){d([]),c(""),y(!1);return}p(!0);const k=i?{[i.is_private?"project":"exclude_external"]:i.id}:{},$=await m({page:1,page_size:10,username:v,...k}).unwrap();$.pages.next||y(!0),d($.results),c(v),p(!1)},C=v=>{if(!v){s();return}a(v)};return h.useEffect(()=>{if(!_||!o.length||x||f)return;(async()=>{p(!0);const k=await m({page:w+1,page_size:10}).unwrap();k.pages.next||y(!0),d($=>[...$,...k.results]),k.pages.current<k.pages.total&&b($=>$+1),p(!1)})()},[_,o,x,f,g]),e.jsxs(ue,{id:"select-user",value:t,showSearch:!0,labelInValue:!0,placeholder:n??r("Search a user"),defaultActiveFirstOption:!1,showArrow:!0,filterOption:!1,onSearch:S,onChange:C,notFoundContent:r("No matches"),allowClear:!0,style:{width:"100%"},children:[l.map(v=>e.jsx(ue.Option,{value:v.id,children:e.jsx(fa,{user:v})},v.id)),!!l.length&&!x&&!u&&!f&&e.jsx(ue.Option,{value:"",children:e.jsx("div",{ref:j})}),u&&e.jsx(ue.Option,{value:"",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(St,{})})})]})},Ex=["admin","ci","unknown"],Ln=({username:t})=>Ex.some(a=>a===t)?e.jsx("span",{style:{userSelect:"none"},children:t}):e.jsx("a",{href:"#",rel:"noreferrer",children:t}),yr={pagination:{current:1,pageSize:10,pageSizeOptions:["10","100","200","500","1000"],showLessItems:!0}},Bx=()=>{const{t}=T(),{project:s}=h.useContext(J),{testPlanId:a}=Q(),{statusesFilters:n}=qt({project:s.id,plan:a,isActivity:!0}),[i,{data:r,isLoading:o}]=sp(),{getColumnSearch:c,setSearchText:l,setSearchedColumn:d,searchText:u,searchedColumn:p}=zs(),{renderBreadCrumbs:m}=Rl(),[g,f]=h.useState({}),[x,y]=h.useState(yr),j=[{title:t("Time"),dataIndex:"action_timestamp",key:"action_timestamp",width:"100px",sorter:(v,k)=>K(v.action_timestamp).diff(k.action_timestamp),render:(v,k)=>e.jsx("div",{"data-testid":`test-plan-activity-time-${k.test_name}`,children:K(v).format("HH:mm:ss")})},{title:t("Test"),dataIndex:"test_name",key:"test_name",...c("test_name"),render:(v,k)=>p.some($=>$==="test_name")?e.jsx(ve,{to:`/projects/${s.id}/plans/${k.breadcrumbs.id}?test=${k.test_id}`,"data-testid":`test-plan-activity-test-link-${k.test_name}`,children:e.jsx(Lt,{searchWords:u,textToHighlight:v})}):e.jsx(ve,{to:`/projects/${s.id}/plans/${k.breadcrumbs.id}?test=${k.test_id}`,"data-testid":`test-plan-activity-test-link-${k.test_name}`,children:v}),onFilter:(v,k)=>k.test_name.toLowerCase().includes(String(v).toLowerCase())},{title:t("Test Plans"),dataIndex:"breadcrumbs",key:"breadcrumbs",width:"500px",render:v=>m(v)},{title:t("Action"),dataIndex:"action",key:"action",width:"150px",filters:[{value:"added",text:t("added")},{value:"deleted",text:t("deleted")},{value:"updated",text:t("updated")}],onFilter:(v,k)=>k.action.includes(String(v)),render:(v,k)=>e.jsx("div",{"data-testid":`test-plan-activity-action-${k.test_name}`,children:t(v)})},{title:t("Status"),dataIndex:"status",key:"status",width:"150px",filters:n,render:(v,k)=>v?e.jsx(Rt,{id:k.status,name:k.status_text,color:k.status_color}):e.jsx(Ia,{}),onFilter:(v,k)=>k.status===v},{title:t("User"),dataIndex:"username",key:"username",width:"240px",...c("username"),onFilter:(v,k)=>k.username.toLowerCase().includes(String(v).toLowerCase()),render:(v,k)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:8},"data-testid":`test-plan-activity-user-${k.test_name}`,children:[e.jsx(Ut,{size:32,avatar_link:k.avatar_link}),k.username]})}];h.useEffect(()=>{d(["user","test_name"])},[]),h.useEffect(()=>{var k,$,I,P;if(!a)return;const v={testPlanId:a,page_size:(k=x.pagination)==null?void 0:k.pageSize,page:($=x.pagination)==null?void 0:$.current,status:(I=x.filters)==null?void 0:I.status,history_type:(P=x.filters)!=null&&P.action?Zg(x.filters.action??[]):void 0,search:x.search?x.search:void 0,ordering:x.sorter?x.sorter:void 0};i(v)},[a,u,JSON.stringify(x)]);const _=(v,k)=>{a&&y($=>({...$,pagination:{...$.pagination,pageSize:k,current:v}}))},w=v=>{a&&(y(k=>({...k,search:v})),l(v))},b=v=>{l(v)},S=(v,k,$)=>{const I=wi($,"plans");(k==null?void 0:k.status)===null&&delete k.status,y(P=>({...P,pagination:v,filters:k,sorter:I})),f(k)},C=()=>{f({}),y(v=>({...yr,sorter:v.sorter})),l("")};return{data:r,isLoading:o,columns:j,searchText:u,filteredInfo:g,pagination:x.pagination,handlePaginationChange:_,handleSearch:w,handleSearchChange:b,handleTableChange:S,clearFilters:C}},Ox=({testPlanActivity:t})=>{const{t:s}=T(),{filters:a,handleChange:n}=df(t);return e.jsxs("div",{style:{display:"flex",marginBottom:48,flexDirection:"column"},"data-testid":"test-plan-activity-filters",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:14},children:[e.jsx(G.Paragraph,{strong:!0,style:{marginBottom:0},children:s("Common Filters")}),e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:t.clearFilters,children:s("Clear filters and sorters")})})]}),e.jsx(ht,{columns:a,dataSource:[],rowKey:"id",pagination:!1,loading:!1,className:"test-plan-activity-filters",onChange:n})]})},qx=({testPlanActivity:t})=>{var s;return!t.data||t.isLoading?e.jsx(zt,{}):t.data.count?e.jsxs("ul",{style:{paddingLeft:0},children:[Object.entries(t.data.results).map(([a,n],i)=>e.jsxs("li",{style:{marginBottom:24,listStyle:"none"},"data-testid":`test-plan-activity-table-group-${a}`,children:[e.jsx(G.Paragraph,{strong:!0,"data-testid":`test-plan-activity-table-title-${a}`,children:K(a).format("D MMMM YYYY")}),e.jsx(ht,{columns:t.columns,dataSource:n,rowKey:"action_timestamp",pagination:!1,"data-testid":`test-plan-activity-table-${a}`})]},`${i}_${a}`)),e.jsx(fi,{defaultCurrent:1,pageSize:((s=t.pagination)==null?void 0:s.pageSize)??10,total:t.data.count,style:{width:"fit-content",marginLeft:"auto"},onChange:t.handlePaginationChange})]}):e.jsx(xi,{})},_r=({projectId:t,planId:s,title:a,isVisibleSeparator:n})=>e.jsxs("div",{"data-testid":`test-plan-activity-link-container-${a}`,children:[e.jsx(ve,{to:`/projects/${t}/plans/${s}`,"data-testid":`test-plan-activity-link-${a}`,children:a}),n&&e.jsx("span",{className:"ant-breadcrumb-separator",children:"/"})]}),$l={name_or_id:"",plans:[],suites:[],statuses:[],assignee:[],labels:[],not_labels:[],labels_condition:void 0,is_archive:void 0,test_plan_started_before:void 0,test_plan_started_after:void 0,test_plan_created_before:void 0,test_plan_created_after:void 0,test_created_before:void 0,test_created_after:void 0},xn={name_or_id:{default:""},plans:{format:Ls,default:[]},suites:{format:Ls,default:[]},statuses:{format:Jn,default:[]},assignee:{format:Jn,default:[]},labels:{format:Ls,default:[]},not_labels:{format:Ls,default:[]},labels_condition:{format:t=>t==="and"?"and":"or"},is_archive:{format:t=>t==="true"},test_plan_started_before:{},test_plan_started_after:{},test_plan_created_before:{},test_plan_created_after:{},test_created_before:{},test_created_after:{}},zx=yt(xl()),xt=yt(xn),br={filter:{name_or_id:xt.name_or_id,plans:xt.plans,suites:xt.suites,statuses:xt.statuses,assignee:xt.assignee,labels:xt.labels,not_labels:xt.not_labels,labels_condition:xt.labels_condition,is_archive:xt.is_archive,test_plan_started_before:xt.test_plan_started_before,test_plan_started_after:xt.test_plan_started_after,test_plan_created_before:xt.test_plan_created_before,test_plan_created_after:xt.test_plan_created_after,test_created_before:xt.test_created_before,test_created_after:xt.test_created_after},settings:{selected:null,editing:!1,editingValue:"",creatingNew:!1,hasUnsavedChanges:!1},ordering:zx.ordering},Rs=mo("testsFilter/updateFilter"),Ll=Pt({name:"testsFilter",initialState:br,reducers:{clearFilter:t=>{t.filter=$l},updateFilterSettings:(t,s)=>{t.settings={...t.settings,...s.payload}},resetFilterSettings:t=>{t.settings=br.settings},updateOrdering:(t,s)=>{t.ordering=s.payload}},extraReducers:t=>{t.addCase(Rs,(s,a)=>{s.filter={...s.filter,...a.payload}})}}),{clearFilter:si,updateFilterSettings:Vi,updateOrdering:ai,resetFilterSettings:Ux}=Ll.actions,ys=t=>t.testsFilter.filter,Al=t=>Object.entries(t.testsFilter.filter).reduce((s,[a,n])=>{const i=$l[a];if(Array.isArray(n)){if(n.length>0)return s+1}else if(n!==i)return s+1;return s},0),Pl=t=>t.testsFilter.settings,Na=t=>t.testsFilter.ordering,Vx=Ll.reducer,vr=[{key:"id",title:"ID"},{key:"name",title:"Name"},{key:"plan_path",title:"Test Plan"},{key:"suite_path",title:"Test Suite"},{key:"estimate",title:"Estimate"},{key:"labels",title:"Labels"},{key:"last_status",title:"Last status"},{key:"assignee_username",title:"Assignee"},{title:"Created At",key:"created_at"}],Sr=[{key:"name",title:"Name"},{key:"last_status",title:"Last status"},{key:"id",title:"ID"},{key:"suite_path",title:"Test Suite"},{key:"assignee_username",title:"Assignee"},{key:"estimate",title:"Estimate"},{key:"labels",title:"Labels"},{key:"started_at",title:"Start Date"},{key:"created_at",title:"Created At"}],wr=yt($n),Qa={test:null,settings:{table:{testPlanId:null,columns:vr,visibleColumns:nn("tests-visible-cols-table")??vr,page:wr.page,page_size:wr.page_size,hasBulk:!1,isAllSelectedTableBulk:!1,selectedRows:[],excludedRows:[],_n:0},tree:{columns:Sr,visibleColumns:nn("tests-visible-cols-tree")??Sr}}},Nl=Pt({name:"test",initialState:Qa,reducers:{setDrawerTest:(t,s)=>{t.test=s.payload},updateSettings:(t,s)=>{t.settings[s.payload.key]={...t.settings[s.payload.key],...s.payload.settings}},setSettings:(t,s)=>{t.settings[s.payload.key]=s.payload},setPagination:(t,s)=>{t.settings[s.payload.key]={...t.settings[s.payload.key],page:s.payload.pagination.page,page_size:s.payload.pagination.page_size}},clearSettings:t=>{t.settings={tree:Qa.settings.tree,table:{...Qa.settings.table,page:1,page_size:10}}}},extraReducers:t=>{t.addCase(Rs,s=>{s.settings.table.page=1,s.settings.table.page_size=Qa.settings.table.page_size})}}),{setDrawerTest:As,updateSettings:Ht,setSettings:QI,setPagination:Hx,clearSettings:GI}=Nl.actions,_s=t=>t.test.test,fn=t=>s=>s.test.settings[t],Yx=Nl.reducer,Wx=()=>{const t=ye(),[s,a]=h.useState("results"),[n,i]=h.useState("desc"),r=z(Rx),o=z(_s),[c,l]=h.useState(null),[d,u]=nt(),p=d.get("test"),{data:m,isFetching:g}=yl({testCaseId:String(o==null?void 0:o.case)},{skip:!o}),{data:f,isFetching:x}=Uh(p??"",{skip:!p||!!o}),y=z(Tl),j=()=>{t(Px())},_=()=>{d.delete("test"),u(d),t(As(null))},w=S=>{a(S)},b=()=>{i(n==="asc"?"desc":"asc")};return h.useEffect(()=>{const S=r.find(C=>C.case===(m==null?void 0:m.id));if(S&&m){const C={...m,test_suite_description:S.test_suite_description};l(C);return}l(m??null)},[m,r]),h.useEffect(()=>{!f||!p||o||t(As(f))},[f,p,o]),h.useEffect(()=>()=>{t(As(null))},[]),{drawerTest:o,testCase:c,isFetching:g||x,showArchive:y,commentOrdering:n,tab:s,handleShowArchived:j,handleCloseDetails:_,handleTabChange:w,handleCommentOrderingClick:b}},Qx="_tr_t3dts_1",Gx="_nodeLeftAction_t3dts_9",Kx="_loader_t3dts_29",Jx="_arrowIcon_t3dts_47",Zx="_arrowIconOpen_t3dts_65",Xx="_entityName_t3dts_75",ef="_name_t3dts_89",tf="_containerItem_t3dts_107",sf="_activeLink_t3dts_117",af="_active_t3dts_117",nf="_list_t3dts_135",rf="_avatarBlock_t3dts_151",Ve={tr:Qx,nodeLeftAction:Gx,loader:Kx,arrowIcon:Jx,arrowIconOpen:Zx,entityName:Xx,name:ef,containerItem:tf,activeLink:sf,active:af,list:nf,avatarBlock:rf},{ArrowIcon:of}=Ce,lf=(t,s,a)=>{const n=new URLSearchParams(location.search);return t.props.isLeaf?(n.set("test",String(t.id)),`/projects/${s}/plans/${a??""}?${n.toString()}`):`/projects/${s}/plans/${t.id}?${n.toString()}`},cf=({node:t,visibleColumns:s,projectId:a,testPlanId:n})=>{var g;const{t:i}=T(),r=ye(),o=z(_s),c=t.data,l=t.props.level*20+8,d=n===t.id&&!t.props.isLeaf||String(o==null?void 0:o.id)===String(t.id)&&t.props.isLeaf,u=lf(t,a,n),p=f=>s.some(x=>x.key===f),m=async()=>{await t.more()};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{id:`${t.title}-${t.id}`,className:V(Ve.tr,{[Ve.active]:d}),children:[p("name")&&e.jsxs("td",{className:Ve.containerItem,children:[e.jsx("span",{style:{width:l,height:1,float:"left"}}),e.jsxs("div",{className:Ve.nodeLeftAction,children:[c.is_archive&&e.jsx(wt,{}),t.props.isLoading&&e.jsx(St,{size:"small",className:Ve.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(of,{width:24,height:24,className:V(Ve.arrowIcon,{[Ve.arrowIconOpen]:t.props.isOpen}),onClick:f=>{f.stopPropagation(),t.open()}})]}),e.jsx(ve,{to:u,className:V(Ve.name,{[Ve.entityName]:!t.props.isLeaf,[Ve.activeLink]:d}),onClick:f=>{f.stopPropagation(),t.props.isLeaf&&r(As(t.data))},children:t.props.isLeaf?t.data.name:t.data.title})]}),p("last_status")&&e.jsxs("td",{className:Ve.containerItem,children:[t.props.isLeaf&&!c.last_status&&e.jsx(Ia,{}),t.props.isLeaf&&c.last_status&&e.jsx(Rt,{id:c.last_status,name:c.last_status_name,color:c.last_status_color})]}),p("id")&&e.jsx("td",{className:Ve.containerItem,children:t.data.id}),p("suite_path")&&e.jsx("td",{className:Ve.containerItem,children:t.props.isLeaf&&t.data.suite_path}),p("assignee_username")&&e.jsx("td",{className:Ve.containerItem,children:t.props.isLeaf&&(c.assignee_username?e.jsxs("div",{className:Ve.avatarBlock,children:[e.jsx(Ut,{size:32,avatar_link:c.avatar_link}),e.jsx(Ln,{username:c.assignee_username??""})]}):e.jsx("span",{style:{opacity:.7},children:i("Nobody")}))}),p("estimate")&&e.jsx("td",{className:Ve.containerItem,children:t.data.estimate??"-"}),p("labels")&&e.jsx("td",{className:Ve.containerItem,children:e.jsx("ul",{className:Ve.list,children:t.props.isLeaf&&c.labels.map(f=>e.jsx("li",{children:e.jsx(js,{content:f.name,color:Oe.accent})},f.id))})}),p("started_at")&&e.jsx("td",{className:Ve.containerItem,children:t.props.isLeaf?"":K(c.started_at).format("YYYY-MM-DD HH:mm")}),p("created_at")&&e.jsx("td",{className:Ve.containerItem,children:K(c.created_at).format("YYYY-MM-DD HH:mm")})]}),((g=t.parent)==null?void 0:g.props.hasMore)&&t.isLast&&e.jsx(Rn,{isLoading:t.props.isMoreLoading,node:t,onMore:m,isLast:t.isLast,isRoot:!0,offset:l})]})},Rl=()=>{const{projectId:t}=Q();return{renderBreadCrumbs:a=>{const n=bl(a).reverse();if(n.length>2){const i=[n[0],null,n[n.length-1]];return e.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},"data-testid":"test-plan-activity-breadcrumbs-container",children:i.map(r=>r?e.jsx("div",{"data-testid":`test-plan-activity-breadcrumb-${r.title}`,children:e.jsx(ve,{to:`/projects/${t}/plans/${r.id}`,children:r.title})},r.id):e.jsx(le,{overlayClassName:"test-plan-activity-breadcrumbs",title:n.slice(1,-1).map((o,c,l)=>e.jsx(_r,{projectId:t??"",planId:String(o.id),title:o.title,isVisibleSeparator:l.length>1&&l.length!==c+1},o.id)),children:e.jsx("span",{className:"ant-breadcrumb-separator",children:"..."})},"no-key"))})}return e.jsx("div",{style:{display:"flex",flexDirection:"row"},"data-testid":"test-plan-activity-breadcrumbs",children:n.map((i,r,o)=>e.jsx(_r,{projectId:t??"",planId:String(i.id),title:i.title,isVisibleSeparator:o.length>1&&o.length!==r+1},i.id))})}}},df=t=>{var o,c,l;const{t:s}=T(),{project:a}=h.useContext(J),{testPlanId:n}=Q(),{statusesFilters:i}=qt({project:a.id,plan:n,isActivity:!0});return{filters:[{title:s("Time"),dataIndex:"action_timestamp",key:"action_timestamp",width:"150px",sorter:!0,filteredValue:((o=t.filteredInfo)==null?void 0:o.action_timestamp)??null},{title:s("Action"),dataIndex:"action",key:"action",width:"150px",filteredValue:((c=t.filteredInfo)==null?void 0:c.action)??null,filters:[{value:"added",text:s("added")},{value:"deleted",text:s("deleted")},{value:"updated",text:s("updated")}]},{title:s("Status"),dataIndex:"status",key:"status",width:"150px",filteredValue:((l=t.filteredInfo)==null?void 0:l.status)??null,filters:i},{title:e.jsx(mi,{placeholder:s("Search by test or user"),onSearch:t.handleSearch,value:t.searchText,onChange:d=>t.handleSearchChange(d.target.value),"data-testid":"test-plan-activity-search"})}],handleChange:t.handleTableChange}},uf=({mode:t,setValue:s})=>{const{project:a}=h.useContext(J),{data:n,isLoading:i}=La({project:String(a.id)}),r=h.useMemo(()=>n?n.filter(y=>y.applied_to.testplan).map(y=>Tn({attribute:y,model:"testplan"})):[],[n]),o=y=>{s("attributes",y,{shouldDirty:!0})},{attributes:c,addAttribute:l,getAttributeJson:d,onAttributeChangeName:u,onAttributeChangeType:p,onAttributeChangeValue:m,onAttributeRemove:g,resetAttributes:f,setAttributes:x}=kn({mode:t,initAttributes:r,setValue:o,addAttributeAdditionalParams:{required:!1},getJsonAdditionalParams:{required:!1}});return{attributes:c,isLoading:i,initAttributes:r,setAttributes:x,resetAttributes:f,addAttribute:l,onAttributeChangeType:p,onAttributeChangeValue:m,onAttributeChangeName:u,onAttributeRemove:g,getAttributeJson:d}},Cr={name:"",description:"",parent:null,test_cases:[],parameters:[],started_at:K(),due_date:K().add(1,"day"),attributes:[],attachments:[]},hf=({type:t})=>{const{t:s}=T(),a=Nt(),[n]=nt(),{project:i}=h.useContext(J),{showModal:r}=Ot(),o=De(),c=a.state,{treebar:l}=h.useContext(Us),{handleSubmit:d,reset:u,control:p,setValue:m,formState:{isDirty:g,errors:f},register:x}=we({defaultValues:Cr}),{setDateFrom:y,setDateTo:j,disabledDateFrom:_,disabledDateTo:w}=Ci(),{attachments:b,attachmentsIds:S,isLoading:C,setAttachments:v,onLoad:k,onRemove:$,onChange:I}=ls(p,i.id),{attributes:P,isLoading:N,addAttribute:A,onAttributeChangeName:q,onAttributeChangeType:O,onAttributeChangeValue:Y,onAttributeRemove:ee,getAttributeJson:U,setAttributes:E}=uf({mode:t,setValue:m}),[D,ae]=h.useState((c==null?void 0:c.testPlan)??null),[oe,te]=h.useState([]),[B,ie]=h.useState(null),[ke,qe]=h.useState("general"),[Qe,ge]=h.useState(null),{onHandleError:rt}=We(ge),{data:ze}=Ni(i.id),[pe,{isLoading:_e}]=Kh(),[Ue]=na(),[Ze,{isLoading:Ne}]=Zh(),[Xe,{isLoading:_t}]=ep(),{data:Me,isLoading:et}=ap({testPlanId:String(D==null?void 0:D.id)},{skip:t==="create"&&!D}),tt=async W=>{l.current&&await Aa(l.current,W)},Ie=async(W,me)=>{if(!l.current)return;const be=Ct=>Ue({id:Ct,project:me.project},!1).unwrap();await cl(l.current,W,me,be)},Dt=W=>{qe(W)},bt=()=>{ge(null),u()},ot=()=>{bt();const W=n.get("prevUrl");o(W??`/projects/${i.id}/plans/${(D==null?void 0:D.id)??""}`)},bs=()=>{if(g){r(ot);return}ot()},vs=W=>{const me=n.get("prevUrl");if(me&&t==="edit"){o(me);return}o(`/projects/${i.id}/plans/${W??""}`)},re=async W=>{var Ss;if(!D)return;ge(null);const me=(Ss=W.test_cases)==null?void 0:Ss.filter(gt=>!gt.startsWith("TS")),{isSuccess:be,attributesJson:Ct,errors:Vt}=ps(P);if(!be){ge({attributes:JSON.stringify(Vt)});return}try{const gt=await Xe({id:D.id,body:{...W,due_date:W.due_date.format("YYYY-MM-DDThh:mm"),started_at:W.started_at.format("YYYY-MM-DDThh:mm"),parent:W.parent??null,test_cases:me,attributes:Ct}}).unwrap();H.success({message:s("Success"),closable:!0,description:e.jsx(Re,{id:String(gt.id),action:"updated",title:s("Test Plan"),link:`/projects/${i.id}/plans/${gt.id}`})}),bt(),Ie(gt,D),vs(D.id)}catch(gt){rt(gt)}},Z=async W=>{var me;ge(null);try{const be=(me=W.test_cases)==null?void 0:me.filter(Vs=>!Vs.startsWith("TS")),{isSuccess:Ct,attributesJson:Vt,errors:Ss}=ps(P);if(!Ct){ge({attributes:JSON.stringify(Ss)});return}const gt=await Ze({...W,test_cases:be,project:i.id,attributes:Vt}).unwrap();H.success({message:s("Success"),closable:!0,description:e.jsx(Re,{id:String(gt[0].id),action:"created",title:s("Test Plan"),link:`/projects/${i.id}/plans/${gt[0].id}`})}),bt(),tt(gt[0]),vs(gt[0].id)}catch(be){rt(be)}},ne=W=>{var me;if(ge({parent:""}),t==="edit"&&Number(W==null?void 0:W.value)===Number(D==null?void 0:D.id)){ge({parent:s("Test Plan cannot be its own parent.")});return}m("parent",W?W.value:null,{shouldDirty:!0}),ie(W?{value:W.value,label:((me=W.label)==null?void 0:me.toString())??""}:null)};return h.useEffect(()=>{ze&&te(ko(ze))},[ze]),h.useEffect(()=>{const W=n.get("parentTestPlan");if(!W||W&&D)return;(async()=>{const be=await pe({project:i.id,testPlanId:W}).unwrap();ie({value:be.id,label:be.name})})()},[D,n.get("parentTestPlan")]),h.useEffect(()=>{var W,me;if(!(!D||N)){if(t==="create")u(Cr),ie({value:D.id,label:D.name}),m("parent",D.id,{shouldDirty:!1});else if(t==="edit"&&Me){const be=(W=D==null?void 0:D.attachments)==null?void 0:W.map(Vt=>({...Vt,uid:String(Vt.id)}));be!=null&&be.length&&v(be);const Ct=U(D.attributes);E(Ct),u({name:D.name,description:D.description,parent:((me=D.parent)==null?void 0:me.id)??null,test_cases:Me.case_ids.map(Vt=>String(Vt)),started_at:K(D.started_at),due_date:D.due_date?K(D.due_date):void 0,attributes:Ct}),ie(D.parent?{value:D.parent.id,label:D.parent.name}:null)}}},[D,Me,t,N]),h.useEffect(()=>{ae((c==null?void 0:c.testPlan)??null)},[c==null?void 0:c.testPlan]),{errors:Qe,formErrors:f,tab:ke,isDirty:g,isLoadingSubmit:Ne||_t||_e||C||et,control:p,selectedParent:B,attachments:b,attachmentsIds:S,parametersTreeView:oe,stateTestPlan:D,setDateFrom:y,disabledDateFrom:_,setDateTo:j,disabledDateTo:w,handleSelectTestPlan:ne,setAttachments:v,handleAttachmentLoad:k,handleAttachmentRemove:$,handleAttachmentChange:I,setValue:m,handleTabChange:Dt,handleCancel:bs,handleSubmitForm:d(t==="create"?Z:re),register:x,attributes:P,addAttribute:A,onAttributeChangeName:q,onAttributeChangeType:O,onAttributeChangeValue:Y,onAttributeRemove:ee}},Tr=({type:t})=>{const{t:s}=T(),{control:a,formErrors:n,errors:i,tab:r,isDirty:o,isLoadingSubmit:c,selectedParent:l,attachments:d,parametersTreeView:u,stateTestPlan:p,handleTabChange:m,handleCancel:g,handleSubmitForm:f,setDateFrom:x,disabledDateFrom:y,setDateTo:j,disabledDateTo:_,handleSelectTestPlan:w,setAttachments:b,handleAttachmentLoad:S,setValue:C,attributes:v,addAttribute:k,onAttributeChangeName:$,onAttributeChangeType:I,onAttributeChangeValue:P,onAttributeRemove:N}=hf({type:t}),[A]=Cn(),[q]=na(),O=t==="create"?`${s("Create")} ${s("Test Plan")}`:`${s("Edit")} ${s("Test Plan")} '${p==null?void 0:p.name}'`;return e.jsxs(e.Fragment,{children:[e.jsx(Dn,{model:"test-plan",type:t,title:O,onClose:g,onSubmit:f,isDisabledSubmit:!o,isLoadingSubmit:c}),i?e.jsx(it,{error:i,style:{marginTop:12,marginBottom:12},skipFields:["name","description","parent","parameters","test_cases","started_at","due_date","attributes"]}):null,e.jsx(R,{id:`test-plan-${t}-form`,layout:"vertical",onFinish:f,className:hr.form,children:e.jsx(dt,{defaultActiveKey:"general",onChange:m,activeKey:r,children:e.jsx(dt.TabPane,{tab:s("General"),children:e.jsxs(M,{justify:"space-between",gap:16,style:{marginTop:14},children:[e.jsxs(M,{vertical:!0,style:{width:"40%"},children:[e.jsx(Zo,{id:`${t}-test-plan-name`,control:a,name:"name",label:s("Name"),maxLength:100,required:!0,formErrors:n,externalErrors:i}),e.jsxs("div",{className:hr.datesRow,children:[e.jsx(ln,{id:`${t}-test-plan-start-date`,control:a,label:s("Start date"),name:"started_at",setDate:x,disabledDate:y,formStyles:{width:"100%"},formErrors:n,externalErrors:i,defaultDate:K(),required:!0}),e.jsx("span",{children:"-"}),e.jsx(ln,{id:`${t}-test-plan-due-date`,control:a,label:s("Due date"),name:"due_date",setDate:j,disabledDate:_,formStyles:{width:"100%"},formErrors:n,externalErrors:i,defaultDate:K().add(1,"day"),required:!0})]}),e.jsx(Fa,{id:`${t}-test-plan-parent`,control:a,name:"parent",label:s("Parent plan"),placeholder:s("Search a test plan"),formErrors:n,externalErrors:i,getData:A,getAncestors:q,selected:l,onSelect:w}),t==="create"&&e.jsx(Vp,{id:`${t}-test-plan-parameters`,control:a,name:"parameters",label:s("Parameters"),treeData:u,formErrors:n,externalErrors:i}),e.jsx(R.Item,{label:s("Description"),validateStatus:i!=null&&i.description?"error":"",help:i!=null&&i.description?i.description:"",children:e.jsx(F,{name:"description",control:a,render:({field:Y})=>e.jsx(lt,{uploadId:`${t}-test-plan-desc`,textAreaId:`${t}-test-plan-desc-textarea`,fieldProps:Y,stateAttachments:{attachments:d,setAttachments:b},customRequest:S,setValue:C})})}),e.jsx(F,{name:"attributes",control:a,render:({field:Y})=>e.jsxs(Ye,{style:{flexDirection:"column"},children:[e.jsx(oa,{attributes:v,onChangeName:$,onChangeType:I,onChangeValue:P,onRemove:N,onBlur:Y.onBlur,errors:i!=null&&i.attributes?JSON.parse(i==null?void 0:i.attributes):void 0}),e.jsx(ra,{onClick:k})]})})]}),e.jsx(M,{vertical:!0,style:{width:"60%"},children:e.jsx(Lx,{errors:i,control:a})})]})},"general")})})]})},J=vn.createContext(null),pf=()=>{const{projectId:t}=Q(),{data:s}=$i(Number(t),{skip:!t});return s?e.jsx(J.Provider,{value:{project:s},children:e.jsx(xs,{context:t})}):null},Dl=()=>{const{project:t}=h.useContext(J);return t},Hi=t=>h.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",...t},h.createElement("rect",{width:256,height:256,fill:"none"}),h.createElement("polyline",{points:"144 64 144 112 192 112",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:208,y1:48,x2:144,y2:112,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("polyline",{points:"64 144 112 144 112 192",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:48,y1:208,x2:112,y2:144,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}));class Ml{constructor(s){xe(this,"tree");xe(this,"id");xe(this,"parent");xe(this,"data");xe(this,"title");xe(this,"children");xe(this,"props");this.tree=s.tree,this.id=s.id,this.parent=s.parent,this.data=s.data,this.title=s.title,this.children=s.children,this.props=s.props}get isRoot(){return!this.parent}get isLast(){var s,a,n;return this.id===((n=(a=this.parent)==null?void 0:a.children[((s=this.parent)==null?void 0:s.children.length)-1])==null?void 0:n.id)}open(){this.props.isOpen=!0,this.tree.forceRerender()}close(){this.props.isOpen=!1,this.tree.forceRerender()}select(){this.props.isSelected=!0,this.tree.forceRerender()}unselect(){this.props.isSelected=!1,this.tree.forceRerender()}update(s){Object.assign(this,s),this.tree.forceRerender()}check(){this.props.isChecked=!0,this.updatePropsRecursiveUp({isHalfChecked:!0},s=>s.children.some(a=>a.props.isChecked??a.props.isHalfChecked))}uncheck(){var n,i;const s=((n=this.parent)==null?void 0:n.getRecursiveChildrenBy(r=>r.props.isChecked??!1).length)??0,a=this.getRecursiveChildrenBy(r=>r.props.isChecked??!1).length??0;this.updateProps({isChecked:!1,isHalfChecked:!!a||!1}),s===1&&((i=this.parent)==null||i.updatePropsRecursiveUp({isHalfChecked:!1},r=>!r.children.some(o=>o.props.isChecked??o.props.isHalfChecked)))}updateProps(s,a=!0){Object.assign(this.props,s),a&&this.tree.forceRerender()}addChildren(s){this.children=[...this.children,...s.map(a=>this.tree.createNode(a,this))],this.tree.forceRerender()}updateChildren(s){this.children=[...s(this.children)].map(a=>this.tree.createNode(a,this)),this.tree.forceRerender()}updatePropsRecursiveDown(s,a){for(const n of this.preOrderTraversal([this]))a(n)&&n.updateProps(s,!1);this.tree.forceRerender()}updatePropsRecursiveUp(s,a){a(this)&&this.updateProps(s,!1),this.parent&&this.parent.updatePropsRecursiveUp(s,a),this.tree.forceRerender()}getChildrenBy(s){return this.children.filter(s)}getRecursiveChildrenBy(s){const a=[];for(const n of this.preOrderTraversal(this.children))s(n)&&a.push(n);return a}*preOrderTraversal(s=[this]){for(const a of s)yield a,a.children.length&&(yield*this.preOrderTraversal(a.children))}}class mf extends Ml{constructor(a){super(a);xe(this,"tree");xe(this,"fetcher");xe(this,"props");xe(this,"children",[]);this.tree=a.tree,this.fetcher=a.tree.fetcher,this.props=a.props}async open(){if(this.props.isOpen){this.close();return}const a=this.tree.findById(this.id);if(this.tree.storeOpenId(this.id,!0),!(a!=null&&a.children.length)){this.updateProps({isLoading:!0});const{data:n,nextInfo:i}=await this.fetcher({page:1,level:this.props.level+1,parent:this.id});this.updateChildren(()=>n),this.updateProps({isLoading:!1,hasMore:i.next!==null})}super.open()}close(){this.tree.storeOpenId(this.id,!1),super.close()}async more(){const a=this.fetcher({page:this.props.page+1,level:this.props.level,parent:this.parent?this.parent.id:null});if(this.parent){this.parent.updateProps({isLoading:!0}),this.updateProps({isMoreLoading:!0});const{data:n,nextInfo:i}=await a;this.parent.addChildren(n),this.parent.updateProps({isLoading:!1,hasMore:i.next!==null}),this.updateProps({isMoreLoading:!1})}}async refetch(){this.updateProps({isLoading:!0});const{data:a,nextInfo:n}=await this.fetcher({page:1,level:this.props.level,parent:this.parent?this.parent.id:null});this.updateChildren(()=>a),this.updateProps({isLoading:!1,hasMore:n.next!==null})}updateProps(a,n=!0){Object.assign(this.props,a),n&&this.tree.forceRerender()}}class gf{constructor(s=[],a){xe(this,"nodes",[]);xe(this,"selectedId",null);xe(this,"rootId",null);this.initialNodes=s,this.forceRerender=a,this.nodes=s.map(n=>this.createNode(n,null))}createNode(s,a=null){const n=new Ml({tree:this,id:s.id,parent:a,data:s.data,title:s.title,children:[],props:s.props});return s.children&&(n.children=s.children.map(i=>this.createNode(i,n))),n}removeById(s){const a=n=>{for(let i=0;i<n.length;i++){if(n[i].id===s)return n.splice(i,1),!0;if(n[i].children.length&&a(n[i].children))return!0}return!1};return a(this.nodes)}updateById(s,a){for(const n of this.preOrderTraversal())if(n.id===s)return Object.assign(n,a),!0;return!1}findById(s){for(const a of this.preOrderTraversal())if(a.id===Number(s))return a;return null}findBy(s){for(const a of this.preOrderTraversal())if(s(a))return a;return null}filterBy(s){const a=[];for(const n of this.preOrderTraversal())s(n)&&a.push(n);return a}updateSelectId(s){this.selectedId=s,this.forceRerender()}updateRootId(s){this.rootId=s,this.forceRerender()}closeAll(){for(const s of this.preOrderTraversal())s.props.isOpen&&s.close()}*preOrderTraversal(s=this.nodes){for(const a of s)yield a,a.children.length&&(yield*this.preOrderTraversal(a.children))}}class xf extends gf{constructor({initData:a,fetcher:n,fetcherAncestors:i,forceRerender:r,initParent:o=null,cacheKey:c,selectedId:l=o,rootId:d=null}){super(a,r);xe(this,"initLoading");xe(this,"hasMore");xe(this,"isMoreLoading");xe(this,"page");xe(this,"initParent");xe(this,"rootId");xe(this,"selectedId");xe(this,"cacheKey");xe(this,"openedIds",new Set);xe(this,"nonce");xe(this,"fetcher");xe(this,"fetcherAncestors");xe(this,"currentRequestId");xe(this,"createNode",(a,n=null)=>{const i=new mf({tree:this,id:a.id,parent:n,data:a.data,title:a.title,props:a.props,children:[]});return a.children&&i.addChildren(a.children),i});this.fetcher=n,this.fetcherAncestors=i,this.selectedId=l,this.rootId=d,this.initParent=o,this.cacheKey=c,this.nonce=0,this.page=1,this.isMoreLoading=!1,this.initLoading=!0,this.hasMore=!0,this.initStoreOpenId()}async refetchNodeBy(a){const n=this.findBy(a);if(!n){this.initRoot();return}n.updateProps({isLoading:!0});const{data:i,nextInfo:r}=await this.fetcher({page:1,level:n.props.level+1,parent:n.id,_n:Date.now().toString()});n.updateChildren(()=>i.map(o=>({...o,props:{...o.props,isOpen:this.openedIds.has(o.id)||o.props.isOpen}}))),n.updateProps({isLoading:!1,isOpen:!0,hasMore:r.next!==null}),await this.loadChildrenRecursively(n.children)}getReqid(){return Date.now().toString()}async initRoot(a){this.page=1,this.currentRequestId=this.getReqid(),a!=null&&a.cacheKey&&(this.cacheKey=a.cacheKey,this.initStoreOpenId()),a!=null&&a.fetcher&&(this.fetcher=a.fetcher),a!=null&&a.fetcherAncestors&&(this.fetcherAncestors=a.fetcherAncestors),(a==null?void 0:a.initParent)!==void 0&&(this.initParent=a==null?void 0:a.initParent),this.initLoading=!0;const{data:n,nextInfo:i,_n:r}=await this.fetcher({page:1,level:0,parent:this.initParent,_n:this.currentRequestId});let o=[];if(this.fetcherAncestors&&this.selectedId&&!n.some(c=>Number(c.id)===Number(this.selectedId))){if(r!==this.currentRequestId||(o=await this.fetcherAncestors(this.selectedId),r!==this.currentRequestId))return;this.setOpenIds(new Set(o))}r===this.currentRequestId&&(this.nodes=n.map(c=>this.createNode({...c,props:{...c.props,isOpen:this.openedIds.has(c.id)||c.props.isOpen}},null)),this.hasMore=i.next!==null,this.initLoading=!1,this.nonce+=1,this.forceRerender(),r===this.currentRequestId&&await this.loadChildrenRecursively(this.nodes))}async loadMoreRootPage(){if(this.isMoreLoading)return;this.isMoreLoading=!0,this.page+=1;const{data:a,nextInfo:n}=await this.fetcher({page:this.page,level:0,parent:this.initParent,_n:this.getReqid()});this.nodes=[...this.nodes,...a.map(i=>this.createNode({...i,props:{...i.props,isOpen:this.openedIds.has(i.id)||i.props.isOpen}},null))],this.forceRerender(),await this.loadChildrenRecursively(this.nodes),this.hasMore=n.next!==null,this.isMoreLoading=!1}setOpenIds(a){a.forEach(n=>this.storeOpenId(n,!0))}storeOpenId(a,n){n?this.openedIds.has(a)||(this.openedIds.add(a),this.cacheKey&&localStorage.setItem(`${this.cacheKey}_openedIds`,JSON.stringify([...this.openedIds]))):this.openedIds.has(a)&&(this.openedIds.delete(a),this.cacheKey&&localStorage.setItem(`${this.cacheKey}_openedIds`,JSON.stringify([...this.openedIds])))}openUpwards(a){let n=a.parent;for(;n;)this.storeOpenId(n.id,!0),n.props.isOpen=!0,n=n.parent;this.forceRerender()}async updateSelectId(a){if(super.updateSelectId(a),!a)return;const n=this.findById(a);if(n){this.openUpwards(n);return}if(this.fetcherAncestors){const i=await this.fetcherAncestors(a);this.setOpenIds(new Set(i));for(const r of i)await this.refetchNodeBy(o=>o.id===r)}}initStoreOpenId(){if(this.cacheKey){const a=localStorage.getItem(`${this.cacheKey}_openedIds`);a&&(this.openedIds=new Set(JSON.parse(a)))}}async loadChildrenRecursively(a){for(const n of a){if(!n.props.isOpen||!n.props.canOpen)continue;n.updateProps({isLoading:!0});const{data:i,nextInfo:r}=await this.fetcher({page:1,level:n.props.level+1,parent:Number(n.id),_n:this.getReqid()});n.updateChildren(()=>i.map(o=>({...o,props:{...o.props,isOpen:this.openedIds.has(o.id)||o.props.isOpen}}))),n.updateProps({isLoading:!1,isOpen:!0,hasMore:r.next!==null}),await this.loadChildrenRecursively(n.children)}}}const ff=({initData:t,fetcher:s,fetcherAncestors:a,initDependencies:n=[],initParent:i,skipInit:r,cacheKey:o,selectedId:c,rootId:l})=>{const[,d]=h.useReducer(p=>p+1,0),u=h.useMemo(()=>new xf({initData:t??[],initParent:i,fetcher:s,fetcherAncestors:a,forceRerender:d,cacheKey:o,selectedId:c,rootId:l}),[]);return h.useEffect(()=>{r||u.initRoot({fetcher:s,fetcherAncestors:a,initParent:i,cacheKey:o})},[...n,i,r,o]),h.useEffect(()=>{u.updateSelectId(c??null)},[c]),h.useEffect(()=>{u.updateRootId(l??null)},[l]),u},jf="_container_11ldt_1",yf="_loadMore_11ldt_15",_f="_isRoot_11ldt_39",bf="_isLast_11ldt_47",ws={container:jf,loadMore:yf,isRoot:_f,isLast:bf},Ra=({node:t,isLoading:s,isRoot:a,isLast:n,offset:i,style:r,onMore:o})=>{const{t:c}=T(),l=t?t.props.level:0,d=t?t.title:"root",u=i||l*20;return s?e.jsx("div",{id:`node-${d}-load-more-spinner`,className:ws.container,style:{paddingLeft:u,...r},children:e.jsx("div",{className:V(ws.loadMore,{[ws.isRoot]:a,[ws.isLast]:n}),children:e.jsx(St,{size:"small"})})}):e.jsx("div",{id:`node-${d}-more`,className:ws.container,style:{paddingLeft:u,...r},children:e.jsx("div",{className:V(ws.loadMore,{[ws.isRoot]:a}),children:e.jsx(L,{id:`node-${d}-more-btn`,size:"small",type:"link",onClick:o,children:c("Load more")})})})},kr=162,Fl=({nodes:t,renderNode:s})=>t.map(a=>e.jsxs(h.Fragment,{children:[s(a),a.props.isOpen&&!!a.children.length&&e.jsx(Fl,{nodes:a.children,renderNode:s})]},`${a.title}-${a.id}`)),vf=(t,s)=>{const a=ff(t);h.useImperativeHandle(s,()=>a);const n=async()=>{await a.loadMoreRootPage()};return a.initLoading?e.jsx("div",{style:{height:kr},children:e.jsx("div",{id:"loader-init",children:e.jsx(zt,{})})}):!a.nodes.length&&!a.initLoading?e.jsx("div",{style:{height:kr},children:e.jsx("div",{id:"empty-init",children:e.jsx(xi,{style:{margin:"16px 0"}})})}):e.jsxs(e.Fragment,{children:[e.jsx(Fl,{nodes:a.nodes,renderNode:t.renderNode}),a.hasMore&&(t.renderLoadMore?t.renderLoadMore({onMore:n,isLoading:a.isMoreLoading}):e.jsx(Ra,{isLast:!0,isLoading:a.isMoreLoading,isRoot:!0,onMore:n}))]})},qs=h.forwardRef(vf),Sf="_wrapper_pcy56_1",wf="_collapsed_pcy56_29",Cf="_actionBlock_pcy56_37",Tf="_headerTitle_pcy56_47",kf="_activeTab_pcy56_49",If="_searchBlock_pcy56_51",$f="_treeViewBlock_pcy56_53",Lf="_topBlock_pcy56_61",Af="_headerBlock_pcy56_69",Pf="_backBtn_pcy56_77",Nf="_backBlock_pcy56_87",Rf="_container_pcy56_101",Df="_header_pcy56_47",Mf="_headerBlockMin_pcy56_155",Ff="_actionBlockMin_pcy56_235",Ef="_searchInputWrapper_pcy56_263",Bf="_nodeBody_pcy56_293",Of="_infoIcon_pcy56_325",qf="_nodeBodyContainer_pcy56_333",zf="_nodeLeftAction_pcy56_365",Uf="_arrowIcon_pcy56_385",Vf="_arrowIconOpen_pcy56_403",Hf="_loader_pcy56_413",Yf="_loaderMore_pcy56_431",Wf="_activeNode_pcy56_447",Qf="_activeContextMenu_pcy56_457",Gf="_selectable_pcy56_467",Kf="_noborder_pcy56_475",Jf="_expandIcon_pcy56_483",Zf="_breadcrumbsBlock_pcy56_521",Xf="_breadcrumbsIcons_pcy56_537",ej="_breadCrumbsArrowIcon_pcy56_553",tj="_breadCrumbsArrowIconNoActive_pcy56_575",sj="_breadcrumbsTitle_pcy56_585",aj="_breadcrumbsDiv_pcy56_587",nj="_treebarNodeLink_pcy56_613",ij="_activeLink_pcy56_627",de={wrapper:Sf,collapsed:wf,actionBlock:Cf,headerTitle:Tf,activeTab:kf,searchBlock:If,treeViewBlock:$f,topBlock:Lf,headerBlock:Af,backBtn:Pf,backBlock:Nf,container:Rf,header:Df,headerBlockMin:Mf,actionBlockMin:Ff,searchInputWrapper:Ef,nodeBody:Bf,infoIcon:Of,nodeBodyContainer:qf,nodeLeftAction:zf,arrowIcon:Uf,arrowIconOpen:Vf,loader:Hf,loaderMore:Yf,activeNode:Wf,activeContextMenu:Qf,selectable:Gf,noborder:Kf,expandIcon:Jf,breadcrumbsBlock:Zf,breadcrumbsIcons:Xf,breadCrumbsArrowIcon:ej,breadCrumbsArrowIconNoActive:tj,breadcrumbsTitle:sj,breadcrumbsDiv:aj,treebarNodeLink:nj,activeLink:ij},{ArrowIcon:rj}=Ce,El=(t,s)=>(s.push(t),t.parent&&El(t.parent,s),s),Bl=h.memo(({activeTab:t,entityId:s})=>{const{project:a}=h.useContext(J),n=De(),{data:i}=Pm(Number(s),{skip:t!=="suites"||!s}),{data:r}=up(Number(s),{skip:t!=="plans"||!s}),o=t==="suites"?i:r,c=h.useMemo(()=>s?o?El(o,[]).reverse():[]:[],[o,s]),l=c.find(d=>String(d.id)===s);return e.jsxs("div",{className:de.breadcrumbsBlock,"data-testid":"treebar-breadcrumbs-block",children:[e.jsx("div",{className:de.breadcrumbsIcons,children:!!c.length&&e.jsx(rj,{className:de.breadCrumbsArrowIcon,onClick:d=>{var p,m;d.stopPropagation();const u=l!=null&&l.parent?`${(p=l==null?void 0:l.parent)==null?void 0:p.id}?rootId=${(m=l==null?void 0:l.parent)==null?void 0:m.id}`:"";n(`/projects/${a.id}/${t}/${u}`)},"data-testid":"treebar-breadcrumbs-back"})}),e.jsx(ve,{to:`/projects/${a.id}/${t}/`,className:de.breadcrumbsTitle,"data-testid":"treebar-breadcrumbs-home",children:"HOME"}),c.map(d=>e.jsxs(h.Fragment,{children:[e.jsx("span",{className:de.breadcrumbsDiv,children:"/"}),e.jsx(ve,{to:`/projects/${a.id}/${t}/${d.id}?rootId=${d.id}`,className:de.breadcrumbsTitle,"data-testid":`treebar-breadcrumbs-title-${d.title}`,children:d.title},d.id)]},d.id))]})});Bl.displayName="TreebarBreadcrumbs";const oj=({activeTab:t})=>{const{t:s}=T(),{treeSettings:a,updateTreeSettings:n}=h.useContext(Us),i=[{value:"name",label:s("Name")},{value:"started_at",label:s("Start Date")},{value:"created_at",label:s("Created At")}],r=[{value:"name",label:s("Name")},{value:"created_at",label:s("Created At")}],o=t==="plans"?i:r,c=u=>{n({[t]:{...a[t],sortBy:u}})},l=u=>{n({[t]:{...a[t],filterBy:u}})},d=()=>{n({show_archived:!a.show_archived})};return e.jsxs(M,{gap:8,vertical:!0,style:{minWidth:200},"data-testid":"treebar-filter-container",children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary",children:s("Sort by")})}),e.jsx(jt.Group,{onChange:u=>{l(u.target.value)},value:a[t].filterBy,defaultValue:o[0].value,"data-testid":"treebar-filter-group",children:e.jsx(ce,{direction:"vertical",children:o.map((u,p)=>e.jsx(jt,{value:u.value,"data-testid":`treebar-filter-${u.value}`,children:u.label},p))})}),e.jsx(je,{style:{margin:"4px 0"}}),e.jsx(jt.Group,{onChange:u=>{c(u.target.value)},value:a[t].sortBy,"data-testid":"treebar-filter-sort-by-group",children:e.jsxs(ce,{direction:"vertical",children:[e.jsx(jt,{value:"asc","data-testid":"treebar-filter-ascending",children:s("Ascending")}),e.jsx(jt,{value:"desc","data-testid":"treebar-filter-descending",children:s("Descending")})]})}),t==="plans"&&e.jsxs(e.Fragment,{children:[e.jsx(je,{style:{margin:"4px 0"}}),e.jsx(Qt,{id:"archive-toggle",label:s("Show Archived"),checked:a.show_archived,onChange:d})]})]})},lj="_ul_4i9jy_1",cj="_value_4i9jy_33",Ga={ul:lj,value:cj},dj=({descendant_count:t,total_cases_count:s,cases_count:a,estimate:n})=>{const{t:i}=T();return e.jsxs("ul",{className:Ga.ul,children:[e.jsxs("li",{children:[i("Test Suites")," ",e.jsx("span",{className:Ga.value,children:t??0})]}),e.jsxs("li",{children:[i("Test Cases")," ",e.jsxs("span",{className:Ga.value,children:[a??0," (",s??0,")"]})]}),e.jsxs("li",{children:[i("Estimate")," ",e.jsx("span",{className:Ga.value,children:n??"-"})]})]})},uj="_tr_1k41u_1",hj="_nodeLeftAction_1k41u_9",pj="_arrowIcon_1k41u_25",mj="_arrowIconOpen_1k41u_43",gj="_name_1k41u_53",xj="_entityName_1k41u_71",fj="_containerItem_1k41u_85",jj="_active_1k41u_95",yj="_activeLink_1k41u_103",_j="_list_1k41u_113",bj="_loader_1k41u_131",ft={tr:uj,nodeLeftAction:hj,arrowIcon:pj,arrowIconOpen:mj,name:gj,entityName:xj,containerItem:fj,active:jj,activeLink:yj,list:_j,loader:bj},{ArrowIcon:vj}=Ce,Sj=(t,s,a)=>{const n=new URLSearchParams(location.search);return t.props.isLeaf?(n.set("test_case",String(t.id)),`/projects/${s}/suites/${a??t.data.suite.id}?${n.toString()}`):`/projects/${s}/suites/${t.id}?${n.toString()}`},wj=({node:t,visibleColumns:s,projectId:a,testSuiteId:n})=>{var m;const[i]=nt(),r=ye(),o=t.props.level*20+8,c=i.get("test_case")===String(t.id)&&t.props.isLeaf,l=t.data,d=g=>s.some(f=>f.key===g),u=Sj(t,a,n),p=async()=>{await t.more()};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{id:`${t.title}-${t.id}`,className:V(ft.tr,{[ft.active]:c}),children:[d("name")&&e.jsxs("td",{className:ft.containerItem,children:[e.jsx("span",{style:{width:o,height:1,float:"left"}}),e.jsxs("div",{className:ft.nodeLeftAction,children:[t.props.isLeaf&&t.data.is_archive&&e.jsx(wt,{}),t.props.isLoading&&e.jsx(St,{size:"small",className:ft.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(vj,{width:24,height:24,className:V(ft.arrowIcon,{[ft.arrowIconOpen]:t.props.isOpen}),onClick:g=>{g.stopPropagation(),t.open()}})]}),e.jsx(ve,{to:u,className:V(ft.name,{[ft.entityName]:!t.props.isLeaf,[ft.activeLink]:c}),onClick:g=>{g.stopPropagation(),t.props.isLeaf&&r(hs(t.data))},children:t.data.name})]}),d("id")&&e.jsx("td",{className:ft.containerItem,children:t.id}),d("labels")&&e.jsx("td",{className:ft.containerItem,children:e.jsx("ul",{className:ft.list,children:t.props.isLeaf&&t.data.labels.map((g,f)=>e.jsx("li",{children:e.jsx(js,{content:g.name,color:Oe.accent})},f))})}),d("estimate")&&e.jsx("td",{className:ft.containerItem,children:l.estimates??t.data.estimate??"-"}),d("created_at")&&e.jsx("td",{className:ft.containerItem,children:K(l.created_at).format("YYYY-MM-DD HH:mm")})]}),((m=t.parent)==null?void 0:m.props.hasMore)&&t.isLast&&e.jsx(Rn,{isLoading:t.props.isMoreLoading,node:t,onMore:p,isLast:t.isLast,isRoot:!0,offset:o})]})},Cj=({testCase:t,onSubmit:s})=>{const{t:a}=T(),{testSuiteId:n}=Q(),[i,r]=h.useState(!1),[o,{isLoading:c}]=Hg(),{handleSubmit:l,control:d,formState:{errors:u}}=we({defaultValues:{newName:`${t.name}(Copy)`,suite:null}}),p=()=>{r(!1)},m=()=>{r(!0)};return{isShow:i,isLoading:c,control:d,formErrors:u,handleSubmit:l(async f=>{try{const x=n??"",y=await o({cases:[{id:String(t.id),new_name:f.newName}],dst_suite_id:f.suite?String(f.suite.value):x}).unwrap();H.success({message:a("Success"),closable:!0,description:e.jsx(Re,{id:String(t.id),action:"copied",title:a("Test Case")})}),p(),s==null||s(y[0])}catch(x){Se(x)}}),handleShow:m,handleCancel:p}},Tj=({testCase:t,onSubmit:s})=>{const{t:a}=T(),{projectId:n}=Q(),[i]=Os(),{isShow:r,isLoading:o,control:c,formErrors:l,handleCancel:d,handleShow:u,handleSubmit:p}=Cj({testCase:t,onSubmit:s});return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"copy-test-case",icon:e.jsx(rs,{}),onClick:u,children:a("Copy")}),e.jsx(he,{className:"copy-test-case-modal",title:`${a("Copy Test Case")} '${t.name}'`,open:r,onCancel:d,centered:!0,footer:[e.jsx(L,{id:"cancel-btn",onClick:d,children:a("Cancel")},"back"),e.jsx(L,{id:"save-btn",type:"primary",loading:o,onClick:p,disabled:o,children:a("Save")},"submit")],children:e.jsxs(R,{id:"copy-test-case-form",layout:"vertical",onFinish:p,children:[e.jsx(R.Item,{label:a("New Test Case name"),validateStatus:l!=null&&l.newName?"error":"",help:l!=null&&l.newName?l.newName.message:"",children:e.jsx(F,{name:"newName",control:c,render:({field:m})=>e.jsx(se,{id:"copy-test-case-name",placeholder:a("Please enter a name"),autoFocus:!0,...m})})}),e.jsx(R.Item,{label:a("Suite"),validateStatus:l!=null&&l.suite?"error":"",help:l!=null&&l.suite?l.suite.message:"",children:e.jsx(F,{name:"suite",control:c,render:({field:m})=>{var g;return e.jsx(pc,{id:"copy-test-case-select-suite",getData:i,skipInit:!r,placeholder:a("Search a test suite"),projectId:String(n),onSelect:f=>m.onChange(f?{label:f.title,value:f.id}:null),selectedId:(g=m.value)==null?void 0:g.value})}})})]})})]})},Ol=({as:t,parentSuiteId:s})=>{const{t:a}=T(),{projectId:n,testSuiteId:i}=Q(),r=s??i,o=De(),c=Nt(),l=()=>{const d=new URLSearchParams(c.search),u=pi();d.size&&Ao(u,c.search.slice(1));let p=`/projects/${n}/suites/${r}/new-test-case`;d.size&&(p+=`?prevSearch=${u}`),o(p)};return t?e.jsx("div",{id:"create-test-case",onClick:l,children:t}):e.jsxs(L,{id:"create-test-case",type:"primary",icon:e.jsx(ct,{}),onClick:l,children:[a("Create")," ",a("Test Case")]})},kj=({testCase:t})=>{const{t:s}=T(),{projectId:a,testSuiteId:n}=Q(),i=ye(),r=De(),o=Nt(),c=()=>{i(qi());const l=new URLSearchParams(o.search);l.delete("test_case");const d=pi();l.size&&Ao(d,l.toString()),r(`/projects/${a}/suites/${n}/edit-test-case?test_case=${t.id}${l.size?`&prevSearch=${d}`:""}`)};return e.jsx(L,{id:"edit-test-case-detail",icon:e.jsx(Ke,{}),onClick:c,children:s("Edit")})},Ij=({isShow:t,setIsShow:s,testCase:a,onSubmit:n})=>{const{t:i}=T(),[r,{isLoading:o}]=Ug(),{data:c,isLoading:l,status:d}=Vg(String(a.id),{skip:!t}),[u,p]=nt(),m=ye(),g=()=>{s(!1)},f=async()=>{try{u.delete("test_case"),u.delete("version"),p(()=>(m(qi()),u)),await r(a.id).unwrap(),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"deleted",title:i("Test Case")})}),n==null||n(a)}catch(x){Se(x)}g()};return e.jsx(Bs,{status:d,isShow:t,isLoading:l,isLoadingButton:o,name:a.name,typeTitle:i("Test Case"),type:"test-case",data:c??[],handleClose:g,handleDelete:f,action:"delete"})},ql=({testCase:t,onSubmit:s})=>{const{t:a}=T(),[n,i]=h.useState(!1),r=()=>{i(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"delete-test-case-detail",onClick:r,icon:e.jsx(ut,{}),danger:!0,children:a("Delete")}),e.jsx(Ij,{isShow:n,setIsShow:i,testCase:t,onSubmit:s})]})},{ArchiveIcon:$j}=Ce;function Lj(t){const{t:s}=T(),a=r=>{Aa(t.tree,r)},n=r=>{ll(t.tree,r)},i=r=>{Di(t.tree,r)};return t.type==="plans"?[{label:e.jsx(ta,{type:"create",as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(ct,{style:{fontSize:14}})," ",s("Create child plan")]}),testPlan:t.data}),key:"create_child_plan"},{label:e.jsx(Ei,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(rs,{style:{fontSize:14}}),s("Copy")]}),testPlan:t.data,onSubmit:a}),key:"copy_plan"},!t.data.is_archive&&{label:e.jsx(ta,{type:"edit",as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(Ke,{style:{fontSize:14}}),s("Edit")]}),testPlan:t.data}),key:"edit_plan"},!t.data.is_archive&&{label:e.jsx(Mi,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx($j,{width:14,height:14})," ",s("Archive")]}),testPlan:t.data,onSubmit:n}),key:"archive_plan"},{label:e.jsx(Fi,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(ut,{style:{fontSize:14}}),s("Delete")]}),testPlan:t.data,onSubmit:i}),key:"delete_plan"},{type:"divider"},{label:e.jsxs(ve,{to:`/projects/${t.projectId}/plans/${t.data.id}/activity`,style:{gap:6,display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(jd,{style:{fontSize:14}})," ",s("View activity")]}),key:"view_activity"}].filter(Boolean):[{label:e.jsx(ea,{type:"create",as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(ct,{style:{fontSize:14}}),s("Create child suite")]}),suite:t.data}),key:"create_child_suite"},{label:e.jsx(Ai,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(rs,{style:{fontSize:14}}),s("Copy")]}),suite:t.data,onSubmit:a}),key:"copy_suite"},{label:e.jsx(ea,{type:"edit",as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(Ke,{style:{fontSize:14}}),s("Edit")]}),suite:t.data}),key:"edit_suite"},{label:e.jsx(Pi,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(ut,{style:{fontSize:14}}),s("Delete")]}),suite:t.data,onSubmit:i}),key:"delete_suite"},{type:"divider"},{label:e.jsx(Ol,{as:e.jsxs(M,{gap:6,align:"center",children:[e.jsx(ct,{style:{fontSize:14}}),s("Create Test Case")]}),parentSuiteId:t.data.id}),key:"create_test_case"}]}const{ArrowIcon:Aj,ExpandIcon:Pj,InfoIcon:Nj}=Ce,Rj=({node:t,projectId:s,selectNodeId:a,type:n,searchText:i,onSelect:r,onRoot:o})=>{var w;const{t:c}=T(),[l]=nt(),d=t.props.level*20,u=n==="plans"?t.data.title:t.data.name,p=Lj({type:n,data:t.data,projectId:s,tree:t.tree}),m=()=>{if(t.tree.selectedId===t.id){t.tree.updateSelectId(null);return}t.tree.updateSelectId(t.id),r(t.id)},g=async()=>{await t.open()},f=async()=>{await t.more()},x=b=>{b?t.select():t.unselect()},y=String(a)===String(t.id),j=dl(["rootId","ordering","is_archive"],l);localStorage.getItem("isDrawerRightFixed")&&l.get("test_case")&&j.append("test_case",l.get("test_case")??"");const _=$o(u);return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:`${t.title}`,style:{paddingLeft:d},"data-testid":_("treebar-node-view"),children:e.jsx(Sn,{menu:{items:p},trigger:["contextMenu"],onOpenChange:x,children:e.jsxs("div",{className:V(de.nodeBody,{[de.activeContextMenu]:t.props.isSelected,[de.activeNode]:!!t.props.isSelected||y,[de.noborder]:t.props.level===0}),onClick:b=>{b.stopPropagation(),m()},children:[e.jsxs("div",{className:de.nodeLeftAction,children:[n==="plans"&&t.data.is_archive&&e.jsx(wt,{size:"sm","data-testid":_("treebar-archived-tag")}),t.props.isLoading&&e.jsx(St,{size:"small",className:de.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(Aj,{width:16,height:16,className:V(de.arrowIcon,{[de.arrowIconOpen]:t.props.isOpen}),onClick:b=>{b.stopPropagation(),g()},"data-testid":_("treebar-arrow-icon")})]}),e.jsx(ve,{to:{pathname:`/projects/${s}/${n}/${t.id}`,search:j.toString()},className:V(de.treebarNodeLink,{[de.activeLink]:t.props.isSelected??y}),"data-testid":_("treebar-node-link"),children:e.jsx(Lt,{searchWords:i??"",textToHighlight:u})}),n==="suites"&&e.jsx(Ms,{content:e.jsx(dj,{cases_count:t.data.cases_count,descendant_count:t.data.descendant_count,total_cases_count:t.data.total_cases_count,estimate:t.data.estimates}),placement:"right",children:e.jsx(Nj,{className:de.infoIcon,"data-testid":_("treebar-info-icon")})}),t.props.canOpen&&e.jsx(le,{title:c("Expand"),placement:"right",children:e.jsx(Pj,{width:16,height:16,className:de.expandIcon,onClick:b=>{b.stopPropagation(),o(t.id)},"data-testid":_("treebar-expand-button")})})]})})},`${t.title}-${t.id}-treebar`),((w=t.parent)==null?void 0:w.props.hasMore)&&t.isLast&&e.jsx(Ra,{isLoading:t.parent.props.isLoading,node:t,onMore:f,isLast:!1,isRoot:!1})]})},{BackIcon:Dj,FilterIcon:Mj}=Ce,Ka=72,Ir=374,Fj=70,Ej=172,Bj=()=>{const{t}=T(),{project:s}=h.useContext(J),a=De(),[n,i]=nt(),{testSuiteId:r,testPlanId:o}=Q(),{treebar:c,searchText:l,treeSettings:d,fetcher:u,fetcherAncestors:p,initParent:m,selectedId:g,initDependencies:f,skipInit:x,activeTab:y,updateTreeSettings:j,setSearchText:_}=h.useContext(Us),w={suites:t("Test Suites & Cases"),plans:t("Test Plans & Results")},b=h.useRef(null),{width:S,handleMouseDown:C,setWidth:v}=Bo({key:"treebar",elRef:b,defaultWidth:d.collapsed?Ka:Ir,minWidth:Ka,maxWidth:Fj,maxAsPercent:!0,updater:O=>{j({collapsed:O<200})}}),k=o??r??null,$=()=>{j({collapsed:!d.collapsed}),v(d.collapsed?Ir:Ka)},I=O=>{const Y=O.target.value;if(_(Y),Y.length){const ee=Object.fromEntries([...n]);i({...ee,treeSearch:Y})}else n.delete("treeSearch"),i(n)},P=O=>{const Y=dl(["rootId","ordering","is_archive"],n);localStorage.getItem("isDrawerRightFixed")&&n.get("test_case")&&Y.append("test_case",n.get("test_case")??""),a({pathname:`/projects/${s.id}/${y}/${O}`,search:Y.toString()})},N=O=>{const Y={...Object.fromEntries([...n]),rootId:String(O)},ee=new URLSearchParams(Y);a({pathname:`/projects/${s.id}/${y}/${O}`,search:ee.toString()})},A=()=>{var O;(O=c.current)==null||O.closeAll()},q=S<Ej||d.collapsed;return e.jsxs("div",{className:V(de.wrapper,{[de.collapsed]:d.collapsed}),ref:b,style:{width:d.collapsed?Ka:S},children:[e.jsxs("div",{className:de.container,children:[e.jsxs("div",{className:de.topBlock,children:[e.jsxs("div",{className:de.header,children:[e.jsxs("div",{className:V(de.headerBlock,{[de.headerBlockMin]:q}),children:[e.jsxs(M,{gap:8,children:[s.is_archive&&e.jsx(wt,{size:"lg"}),e.jsx(G.Title,{level:1,className:de.headerTitle,children:s.name})]}),e.jsx("div",{className:de.backBlock,children:e.jsx("button",{className:de.backBtn,type:"button",onClick:$,"data-testid":"treebar-back-button",children:e.jsx(Dj,{width:24,height:24})})})]}),e.jsx("span",{className:de.activeTab,children:y?w[y]:""}),!q&&e.jsx(Bl,{activeTab:y,entityId:r??o}),e.jsx("div",{className:V(de.actionBlock,{[de.actionBlockMin]:q}),children:y==="suites"?e.jsx(ea,{type:"create",size:q?"small":"default",colorType:"primary"}):e.jsx(ta,{type:"create",size:q?"small":"default",colorType:"primary"})})]}),e.jsxs("div",{className:de.searchBlock,children:[e.jsx("div",{className:de.searchInputWrapper,"data-testid":"treebar-search-input-wrapper",children:e.jsx(se.Search,{placeholder:t("Search"),value:l,onChange:I,"data-testid":"treebar-search-input"})}),!q&&y&&e.jsx(le,{title:t("Filter & sort"),children:e.jsx(Ms,{content:e.jsx(oj,{activeTab:y}),arrow:!1,trigger:"click",placement:"bottom",children:e.jsx(L,{style:{minWidth:32},icon:e.jsx(Mj,{width:24,height:24,color:"var(--y-sky-60)"}),"data-testid":"treebar-filter-button"})})}),e.jsx(le,{title:t("Collapse All"),children:e.jsx(L,{style:{minWidth:32},icon:e.jsx(Hi,{width:18,height:18,color:"var(--y-sky-60)"}),onClick:A,"data-testid":"treebar-collapse-all-button"})})]})]}),y&&!d.collapsed&&e.jsx("div",{className:de.treeViewBlock,"data-testid":`tree-view-${y}`,children:e.jsx(qs,{ref:c,cacheKey:`${s.id}-treebar-${y}`,fetcher:u,fetcherAncestors:p,skipInit:x||d.collapsed,initParent:m,selectedId:g,initDependencies:f,renderNode:O=>e.jsx(Rj,{projectId:s.id,selectNodeId:k,type:y,searchText:l,node:O,onSelect:P,onRoot:N})})})]}),!q&&e.jsx(mc,{onMouseDown:C})]})},Oj="_graphsBlock_1hkb8_1",qj="_graphsTitle_1hkb8_15",zj="_pieWrapper_1hkb8_29",Uj="_barWrapper_1hkb8_47",Vj="_pieHeader_1hkb8_83",Hj="_notEstimatedBlock_1hkb8_99",Xt={graphsBlock:Oj,graphsTitle:qj,pieWrapper:zj,barWrapper:Uj,pieHeader:Vj,notEstimatedBlock:Hj},Yj="_filtersBlock_13x2m_1",Wj="_byAttrLabel_13x2m_15",$r={filtersBlock:Yj,byAttrLabel:Wj},Qj=({barType:t,testPlanId:s,dateHistogram:a,setAttribute:n,setDateHistogram:i,setBarType:r})=>{var b,S,C;const{t:o}=T(),{userConfig:c,updateConfig:l}=h.useContext(Pe),[d,u]=h.useState(((b=c==null?void 0:c.ui)==null?void 0:b.graph_base_bar_attribute_input)??""),p=s??"root",m=async(v,k)=>{var $,I;await l({...c,ui:{...c==null?void 0:c.ui,test_plan:{...($=c==null?void 0:c.ui)==null?void 0:$.test_plan,[p]:{[k]:v??((I=c==null?void 0:c.ui)==null?void 0:I.test_plan[p][k])}}}})},g=(v,k)=>{const $=v.format("YYYY-MM-DD")??void 0;i(I=>({...I,[k==="start_date"?"start":"end"]:v})),m($,k)},f=async v=>{if(v.target.value===""){u(""),n(""),await j("by_time"),await l({...c,ui:{...c==null?void 0:c.ui,graph_base_bar_attribute_input:""}});return}u(v.target.value)},x=async()=>{n(d),await l({...c,ui:{...c==null?void 0:c.ui,graph_base_bar_attribute_input:d}})},y=async()=>{var v;i({start:K().subtract(6,"days"),end:K()}),await l({...c,ui:{...c==null?void 0:c.ui,test_plan:{...(v=c==null?void 0:c.ui)==null?void 0:v.test_plan,[p]:void 0}}})},j=async v=>{r(v),await l({...c,ui:{...c==null?void 0:c.ui,graph_base_bar_type:v}})},_=v=>a.start.isSameOrAfter(v),w=!!((C=(S=c==null?void 0:c.ui)==null?void 0:S.test_plan)!=null&&C[p]);return e.jsxs("div",{className:$r.filtersBlock,children:[e.jsxs(M,{gap:8,children:[e.jsx(vt,{onChange:v=>g(v,"start_date"),size:"middle",value:a.start,disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:o("Start date"),needConfirm:!1,maxDate:a.end,allowClear:!1,"data-testid":"test-plan-histogram-start-date-picker"}),e.jsx(vt,{onChange:v=>g(v,"end_date"),size:"middle",value:a.end,disabled:!1,showTime:!1,maxDate:K(),format:"YYYY-MM-DD",picker:"date",placeholder:o("Finish date"),needConfirm:!1,allowClear:!1,disabledDate:_,"data-testid":"test-plan-histogram-end-date-picker"}),w&&e.jsx(L,{onClick:y,id:"reset-date-user-config",children:e.jsx(yd,{})})]}),t==="by_attr"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",position:"relative"},"data-testid":"test-plan-histogram-filters-by-attr",children:[e.jsx("span",{className:$r.byAttrLabel,children:o("Filter by test result attribute")}),e.jsx(se.Search,{style:{width:240},allowClear:!0,onChange:f,value:d,loading:!1,onSearch:x,placeholder:o("Search by attribute")})]}),e.jsx(fo,{id:"test-plan-statistic-histogram-tabs",options:[{value:"by_time",icon:e.jsx(_d,{"data-testid":"histogram-by-time-icon"})},{value:"by_attr",icon:e.jsx(Ym,{"data-testid":"histogram-by-attr-icon"})}],onChange:j,size:"middle",defaultValue:t,value:t})]})},Gj=[{point:"No results",blocked:0,broken:0,failed:0,passed:0,retest:0,skipped:0}],Kj=t=>{const s=[];return t.forEach(a=>{const n={};Object.entries(a).forEach(([i,r])=>{if(i!=="point"){const o=r;n[o.label]=o.count}else{const o=r;n.point=o}}),s.push(n)}),s},Jj=t=>{const s={};return t.forEach(a=>{Object.entries(a).forEach(([n,i])=>{if(n!=="point"){const r=i;s[r.label.toLocaleLowerCase()]=r.color}})}),Object.entries(s).map(([a,n])=>({name:a,color:n}))},Zj=({testPlanId:t})=>{var w,b,S,C,v,k,$,I,P,N,A,q,O,Y,ee,U;const{t:s}=T(),{projectId:a}=Q(),n=z(ys),{userConfig:i}=h.useContext(Pe),[r,o]=h.useState(((w=i==null?void 0:i.ui)==null?void 0:w.graph_base_bar_type)??"by_time"),c=t??"root",[l,d]=h.useState({start:(C=(S=(b=i==null?void 0:i.ui)==null?void 0:b.test_plan)==null?void 0:S[c])!=null&&C.start_date?K(($=(k=(v=i==null?void 0:i.ui)==null?void 0:v.test_plan)==null?void 0:k[c])==null?void 0:$.start_date):K().subtract(6,"days"),end:(N=(P=(I=i==null?void 0:i.ui)==null?void 0:I.test_plan)==null?void 0:P[c])!=null&&N.end_date?K((O=(q=(A=i==null?void 0:i.ui)==null?void 0:A.test_plan)==null?void 0:q[c])==null?void 0:O.end_date):K()}),[u,p]=h.useState(((Y=i==null?void 0:i.ui)==null?void 0:Y.graph_base_bar_attribute_input)??""),{data:m,isFetching:g}=op({project:Number(a),parent:t?Number(t):null,start_date:l.start.format("YYYY-MM-DD"),end_date:l.end.format("YYYY-MM-DD"),attribute:r==="by_attr"?u:void 0,labels:(ee=n.labels)!=null&&ee.length?n.labels:void 0,not_labels:(U=n.not_labels)!=null&&U.length?n.not_labels:void 0,labels_condition:n.labels_condition??void 0,is_archive:n.is_archive}),f=(E,D,ae)=>e.jsx("span",{style:{color:"var(--y-sky-80)"},"data-testid":`test-plan-histogram-legend-${E}`,children:E},ae),y=(()=>{const E=(m==null?void 0:m.length)??1,D=Math.floor(E/8);return E<=10?0:D})(),j=Kj(m??[]),_=Jj(m??[]);return e.jsxs("div",{className:Xt.barWrapper,children:[e.jsxs("div",{className:Xt.pieHeader,children:[e.jsx("h3",{className:Xt.graphsTitle,children:s("Tests Count Histogram")}),e.jsx(Qj,{barType:r,testPlanId:t,setAttribute:p,dateHistogram:l,setDateHistogram:d,setBarType:o})]}),g&&e.jsx(M,{align:"center",justify:"center",style:{height:"100%"},children:e.jsx(St,{size:"large"})}),!g&&e.jsx(ci,{width:"100%",children:e.jsxs(bd,{width:800,height:280,data:j.length?j:Gj,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(vd,{strokeDasharray:"3 3"}),e.jsx(Sd,{dataKey:"point",type:"category",interval:y}),e.jsx(wd,{}),e.jsx(ui,{}),_.map(E=>e.jsx(Cd,{dataKey:E.name,stackId:"a",fill:E.color,barSize:40,name:E.name.toUpperCase(),values:E.name},E.name)),e.jsx(di,{formatter:f})]})})]})},Xj=({testPlanId:t,height:s,onHeightChange:a})=>{var u,p;const{t:n}=T(),{projectId:i}=Q(),r=z(ys),o=ye(),{data:c,isFetching:l}=zo({parent:t?Number(t):null,labels:(u=r.labels)!=null&&u.length?r.labels:void 0,not_labels:(p=r.not_labels)!=null&&p.length?r.not_labels:void 0,labels_condition:r.labels_condition??void 0,is_archive:r.is_archive,project:Number(i)},{skip:!i}),d=m=>{o(Rs({statuses:m}))};return e.jsxs("div",{className:Xt.pieWrapper,children:[e.jsx("h3",{className:Xt.graphsTitle,children:n("Tests Count")}),l&&e.jsx(M,{align:"center",justify:"center",style:{height:"100%"},children:e.jsx(St,{size:"large"})}),!l&&e.jsx(Rp,{statuses:r.statuses,updateStatuses:d,data:c??[],type:"value",height:s,onHeightChange:a})]})},ey=[{label:"minutes",value:"minutes"},{label:"hours",value:"hours"},{label:"days",value:"days"}],ty=({setPeriod:t,value:s})=>{const{t:a}=T(),n=i=>{t(i)};return e.jsx("div",{style:{marginLeft:14,display:"flex",alignItems:"center"},"data-testid":"test-plan-pie-estimates-filters",children:e.jsx(ue,{placeholder:a("Please select"),value:s,style:{width:"100%",minWidth:120,height:32},options:ey,size:"middle",defaultActiveFirstOption:!0,onChange:n})})},Lr="minutes",sy=({testPlanId:t,height:s,onHeightChange:a})=>{var v,k,$;const{t:n}=T(),{projectId:i}=Q(),r=z(ys),o=ye(),{userConfig:c,updateConfig:l}=h.useContext(Pe),[d,u]=h.useState(((v=c==null?void 0:c.ui)==null?void 0:v.test_plan_estimate_everywhere_period)??Lr),{data:p,isFetching:m}=zo({parent:t?Number(t):null,labels:(k=r.labels)!=null&&k.length?r.labels:void 0,not_labels:($=r.not_labels)!=null&&$.length?r.not_labels:void 0,labels_condition:r.labels_condition??void 0,is_archive:r.is_archive,project:Number(i),estimate_period:d},{skip:!i}),g=I=>{o(Rs({statuses:I}))},{formatData:f,total:x,legendFormatter:y,tooltipFormatter:j,handleCellClick:_,checkActive:w,chartRef:b}=Vo({data:p??[],type:"estimates",period:d,statuses:r.statuses,updateStatuses:g,onHeightChange:a}),S=h.useMemo(()=>{const I=(p??[]).reduce((N,A)=>A.label==="UNTESTED"?N:N+A.empty_estimates,0),P=(p??[]).reduce((N,A)=>N+A.empty_estimates,0);return{empty:I,total:P}},[f]),C=async I=>{u(I),await l({...c,ui:{...c==null?void 0:c.ui,test_plan_estimate_everywhere_period:I}})};return h.useEffect(()=>{var I;u(((I=c==null?void 0:c.ui)==null?void 0:I.test_plan_estimate_everywhere_period)??Lr)},[t]),e.jsxs("div",{className:Xt.pieWrapper,children:[e.jsxs("div",{className:Xt.pieHeader,children:[e.jsx("h3",{className:Xt.graphsTitle,children:n("Tests Estimates")}),e.jsx(ty,{setPeriod:C,value:d})]}),m&&e.jsx(M,{align:"center",justify:"center",style:{height:"100%"},children:e.jsx(St,{size:"large"})}),!m&&e.jsxs(e.Fragment,{children:[e.jsx(ci,{width:"100%",height:s,ref:b,children:e.jsxs(io,{margin:{left:0},children:[e.jsxs(ro,{data:f,dataKey:"estimates",nameKey:"label",cx:"50%",cy:"50%",innerRadius:80,outerRadius:94,fill:"#a0a0a0",children:[e.jsx(Uo,{data:f,checkActive:w,handleCellClick:_}),e.jsx(Xa,{position:"centerBottom",fontSize:26,value:n("Total")}),e.jsx(Xa,{value:parseFloat(x.toFixed(2)),position:"centerTop",offset:20,fontSize:28,style:{marginTop:20},dy:12,fill:"#000",fontWeight:"bold"})]}),e.jsx(di,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right",iconType:"circle",formatter:y}),e.jsx(ui,{formatter:j})]})}),e.jsx("div",{className:Xt.notEstimatedBlock,"data-testid":"test-plan-pie-estimates-not-estimated-block",children:e.jsxs("span",{children:[n("Not estimated tests statistics"),":"," ",`${S.empty}/${S.total}`]})})]})]})},zl=h.memo(({testPlanId:t})=>{var m;const s=h.useRef(null),{userConfig:a,updateConfig:n}=h.useContext(Pe),[i,r]=h.useState(208),o=g=>{g>i&&r(g)},[c,l]=h.useState("row");oh({elRef:s,onResize:(g,f)=>{l(f<=800?"column":"row")}});const[d,u]=h.useState(((m=a==null?void 0:a.ui)==null?void 0:m.graph_base_type)??"pie"),p=async g=>{u(g),await n({...a,ui:{...a==null?void 0:a.ui,graph_base_type:g}})};return e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(Ye,{align:"middle",justify:"end",style:{marginBottom:8},children:e.jsx(fo,{id:"test-plan-statistic-tabs",style:{position:"absolute"},options:[{value:"pie",icon:e.jsx(Td,{"data-testid":"pie-chart-icon"})},{value:"bar",icon:e.jsx(co,{"data-testid":"bar-chart-icon"})}],onChange:p,size:"middle",defaultValue:d,value:d})}),e.jsxs("div",{className:Xt.graphsBlock,style:{flexDirection:c},ref:s,children:[d==="pie"&&e.jsxs(e.Fragment,{children:[e.jsx(Xj,{testPlanId:t,onHeightChange:o,height:i}),e.jsx(sy,{testPlanId:t,onHeightChange:o,height:i})]}),d==="bar"&&e.jsx(Zj,{testPlanId:t})]})]})});zl.displayName="TestPlanStatistics";const ay="_actionBtn_qe50g_1",ny="_filterMenuList_qe50g_27",iy="_filterMenuListItem_qe50g_43",ry="_btn_qe50g_71",oy="_renameBtn_qe50g_109",ly="_saveRename_qe50g_135",st={actionBtn:ay,filterMenuList:ny,filterMenuListItem:iy,btn:ry,delete:"_delete_qe50g_93",renameBtn:oy,saveRename:ly},{ContextMenuIcon:cy,ResetIcon:Ar,SaveIcon:dy}=Ce,uy=({type:t,filterData:s,filterSettings:a,onDelete:n,updateSettings:i,resetFilterToSelected:r,clearFilter:o})=>{const{t:c}=T(),{userConfig:l,updateConfig:d}=h.useContext(Pe),{project:u}=h.useContext(J),p=t==="plans"?"test_plans":"test_suites",[m,g]=h.useState(!1),f=async()=>{var v,k,$;if(!a.selected)return;const S=sr(s),C=new URLSearchParams(S);await d({...l,[p]:{...l==null?void 0:l[p],filters:{...(v=l==null?void 0:l[p])==null?void 0:v.filters,[u.id]:{...($=(k=l==null?void 0:l[p])==null?void 0:k.filters)==null?void 0:$[u.id],[a.selected]:C.toString()}}}}),g(!1),H.success({message:c("Success"),closable:!0,description:c("Filter updated successfully")})},x=()=>{i({editing:!0,creatingNew:!0,editingValue:a.selected??""})},y=()=>{if(!a.editingValue.length){H.error({message:c("Error!"),description:c("Name filter cant be empty!")});return}const S=a.creatingNew||!a.selected;S?w():b(),H.success({message:c("Success"),closable:!0,description:c(S?"Filter created successfully":"Filter updated successfully")}),i({selected:a.editingValue,editing:!1,creatingNew:!1,editingValue:""}),g(!1)},j=()=>{i({editing:!1,editingValue:""}),g(!1)},_=()=>{i({editing:!0,creatingNew:!1,editingValue:a.selected??""})},w=async()=>{var v,k,$;const S=sr(s),C=new URLSearchParams(S);await d({...l,[p]:{...l==null?void 0:l[p],filters:{...(v=l==null?void 0:l[p])==null?void 0:v.filters,[u.id]:{...($=(k=l==null?void 0:l[p])==null?void 0:k.filters)==null?void 0:$[u.id],[a.editingValue]:C.toString()}}}})},b=async()=>{var v,k,$,I,P,N;if(!a.selected)return;const S=($=(k=(v=l==null?void 0:l[p])==null?void 0:v.filters)==null?void 0:k[u.id])==null?void 0:$[a.selected],C={...(P=(I=l==null?void 0:l[p])==null?void 0:I.filters)==null?void 0:P[u.id]};delete C[a.selected],await d({...l,[p]:{...l==null?void 0:l[p],filters:{...(N=l==null?void 0:l[p])==null?void 0:N.filters,[u.id]:{...C,[a.editingValue]:S}}}})};return a.editing?e.jsxs(M,{style:{marginLeft:"auto"},gap:7,children:[e.jsx("button",{className:V(st.renameBtn,st.saveRename),onClick:y,"data-testid":"action-buttons-filter-rename-accept",children:e.jsx(ja,{})}),e.jsx("button",{className:st.renameBtn,onClick:j,"data-testid":"action-buttons-filter-rename-close",children:e.jsx(Ta,{})})]}):a.selected?e.jsxs(M,{gap:8,children:[a.hasUnsavedChanges&&e.jsx(le,{title:c("Reset filter"),children:e.jsx("button",{type:"button",className:V("link-button",st.actionBtn),onClick:r,"data-testid":"action-buttons-filter-reset",children:e.jsx(Ar,{})})}),e.jsx(Ms,{id:"menu-filter",overlayInnerStyle:{padding:"8px 0"},content:e.jsxs("ul",{className:st.filterMenuList,children:[a.hasUnsavedChanges&&e.jsxs("li",{className:st.filterMenuListItem,onClick:f,children:[e.jsx("button",{type:"button",className:st.btn,"data-testid":"action-buttons-filter-save-changes",children:e.jsx(ja,{style:{fontSize:14}})}),e.jsx("span",{children:c("Save Changes")})]}),e.jsxs("li",{className:st.filterMenuListItem,onClick:x,children:[e.jsx("button",{type:"button",className:st.btn,"data-testid":"action-buttons-filter-save-as-new",children:e.jsx(rs,{style:{fontSize:14}})}),e.jsx("span",{children:c("Save as New Filter")})]}),e.jsxs("li",{className:st.filterMenuListItem,onClick:_,children:[e.jsx("button",{type:"button",className:st.btn,"data-testid":"action-buttons-filter-rename",children:e.jsx(Ke,{style:{fontSize:14}})}),e.jsx("span",{children:c("Rename")})]}),e.jsxs("li",{className:V(st.filterMenuListItem,st.delete),onClick:()=>n(a.selected??""),children:[e.jsx("button",{type:"button",className:st.btn,"data-testid":"action-buttons-filter-delete",children:e.jsx(ut,{style:{fontSize:14}})}),e.jsx("span",{children:c("Delete")})]})]}),placement:"bottomRight",trigger:"click",open:m,onOpenChange:g,arrow:!1,children:e.jsx("button",{type:"button",className:V("link-button",st.actionBtn),"data-testid":"action-buttons-filter-context-menu",children:e.jsx(cy,{})})})]}):e.jsxs(M,{gap:8,children:[a.hasUnsavedChanges&&e.jsx(le,{title:"Reset filter",children:e.jsx("button",{type:"button",className:V("link-button",st.actionBtn),onClick:o,"data-testid":"action-buttons-filter-reset",children:e.jsx(Ar,{})})}),e.jsx(le,{title:"Save filter",placement:"bottomRight",children:e.jsx("button",{type:"button",className:V("link-button",st.actionBtn),onClick:_,"data-testid":"action-buttons-filter-save",children:e.jsx(dy,{})})})]})},hy="_titleBlock_19u9h_1",py="_title_19u9h_1",my="_list_19u9h_29",gy="_item_19u9h_47",xy="_itemEditing_19u9h_71",fy="_active_19u9h_85",jy="_btns_19u9h_93",yy="_btn_19u9h_93",_y="_deleteBtn_19u9h_143",by="_input_19u9h_151",vy="_itemInput_19u9h_167",Sy="_unsaved_19u9h_181",He={titleBlock:hy,title:py,list:my,item:gy,itemEditing:xy,active:fy,btns:jy,btn:yy,deleteBtn:_y,input:by,itemInput:vy,unsaved:Sy},{ArrowIcon:wy}=Ce,Cy=({type:t,filterData:s,filterSettings:a,configFilters:n,filterSchema:i,onDelete:r,onSelect:o,updateSettings:c})=>{const{t:l}=T(),{userConfig:d,updateConfig:u}=h.useContext(Pe),{project:p}=h.useContext(J),m=t==="plans"?"test_plans":"test_suites",[g,f]=h.useState(!1),[x,y]=h.useState({}),j=h.useRef(null),_=h.useMemo(()=>n?Object.keys(n):[],[n]),w=I=>{!_.length||a.editing||f(I)},b=I=>{c({selected:I}),o(I),f(!1)},S=I=>{y(P=>({...P,[I]:I}))},C=I=>{c({editingValue:I.target.value})},v=(I,P)=>{y(N=>({...N,[I]:P}))},k=async I=>{var O,Y,ee,U,E;const P=x[I];if(!P.length){H.error({message:l("Error!"),description:l("Name filter cant be empty!")});return}const N=(ee=(Y=(O=d==null?void 0:d[m])==null?void 0:O.filters)==null?void 0:Y[p.id])==null?void 0:ee[I],A={...(E=(U=d==null?void 0:d[m])==null?void 0:U.filters)==null?void 0:E[p.id]};delete A[I],await u({...d,[m]:{...d==null?void 0:d[m],filters:{[p.id]:{...A,[P]:N}}}});const q={...x};delete q[I],y(q),H.success({message:l("Success"),closable:!0,description:l("Filter updated successfully")}),I===a.selected&&c({selected:P})},$=I=>{const P={...x};delete P[I],y(P)};return h.useEffect(()=>{var I;a.editing&&((I=j.current)==null||I.focus())},[a.editing]),h.useEffect(()=>{var A,q,O;if(!a.selected)return;const I=(O=(q=(A=d==null?void 0:d[m])==null?void 0:A.filters)==null?void 0:q[p.id])==null?void 0:O[a.selected];if(!I){c({hasUnsavedChanges:!1});return}const P=yt(i,{url:I});if(ya(P,s)){c({hasUnsavedChanges:!1});return}c({hasUnsavedChanges:!0})},[a.selected,s,d]),a.editing?e.jsx(se,{ref:j,className:He.input,variant:"borderless",placeholder:l("Filter name"),value:a.editingValue,onChange:C,"data-testid":"select-filter-input-editing"}):_.length?e.jsxs(Ms,{id:"select-filter-popover",overlayInnerStyle:{padding:"8px 0"},content:e.jsx("ul",{className:He.list,"data-testid":"select-filter-list",children:_.map((I,P)=>{const N=`${I}-${P}`;return Object.keys(x).includes(I)?e.jsxs("li",{className:He.itemEditing,children:[e.jsx(se,{className:He.itemInput,variant:"borderless",placeholder:l("Filter name"),value:x[I]??I,autoFocus:!0,onChange:A=>v(I,A.target.value),"data-testid":`select-filter-input-${I}`}),e.jsxs(M,{style:{marginLeft:"auto"},gap:7,children:[e.jsx("button",{className:V(He.btn,He.saveRename),onClick:()=>k(I),"data-testid":`select-filter-save-rename-${I}`,children:e.jsx(ja,{})}),e.jsx("button",{className:V(He.btn,He.closeRename),onClick:()=>$(I),"data-testid":`select-filter-close-rename-${I}`,children:e.jsx(Ta,{})})]})]},N):e.jsxs("li",{id:N,className:V(He.item,{[He.active]:a.selected===I}),onClick:A=>{A.preventDefault(),b(I)},children:[I,e.jsxs("div",{className:He.btns,children:[e.jsx("button",{className:He.btn,onClick:A=>{A.stopPropagation(),S(I)},"data-testid":`select-filter-edit-${I}`,children:e.jsx(Ke,{style:{fontSize:14}})}),e.jsx("button",{className:V(He.btn,He.deleteBtn),onClick:A=>{A.stopPropagation(),r(I)},"data-testid":`select-filter-delete-${I}`,children:e.jsx(ut,{style:{fontSize:14}})})]})]},N)})}),placement:"bottomLeft",trigger:"click",open:!_.length||a.editing?!1:g,onOpenChange:w,arrow:!1,className:V({[He.disabled]:!_.length||a.editing}),children:[e.jsxs("div",{className:He.titleBlock,children:[!a.editing&&e.jsx("h3",{className:He.title,"data-testid":"select-filter-title",children:a.selected??l("New Filter")}),!!_.length&&!a.editing&&e.jsx(wy,{width:24,height:24,"data-testid":"select-filter-arrow"})]}),a.hasUnsavedChanges&&e.jsx("span",{className:He.unsaved,"data-testid":"select-filter-unsaved-changes",children:l("Unsaved Changes")})]}):e.jsx("h3",{className:He.title,"data-testid":"select-filter-title-new-filter",children:l("New Filter")})},Ul=({type:t,hasSomeFilter:s,filterData:a,filterSchema:n,filterSettings:i,updateFilter:r,updateSettings:o,clearFilter:c})=>{var y,j,_,w;const{t:l}=T(),{userConfig:d,updateConfig:u}=h.useContext(Pe),{project:p}=h.useContext(J),m=t==="plans"?(j=(y=d==null?void 0:d.test_plans)==null?void 0:y.filters)==null?void 0:j[p.id]:(w=(_=d==null?void 0:d.test_suites)==null?void 0:_.filters)==null?void 0:w[p.id],g=b=>{he.confirm({title:l("Do you want to delete this filter?"),okText:l("Delete"),cancelText:l("Cancel"),onOk:async()=>{const S={...m??{}};delete S[b];const C=t==="plans"?"test_plans":"test_suites";await u({...d,[C]:{...d==null?void 0:d[C],filters:{[p.id]:{...S}}}}),i.selected===b&&(o({selected:null}),c()),H.success({message:l("Success"),closable:!0,description:l("Filter deleted successfully")})},okButtonProps:{"data-testid":"delete-filter-button-confirm"},cancelButtonProps:{"data-testid":"delete-filter-button-cancel"}})},f=b=>{const S=m==null?void 0:m[b],C=yt(n,{url:S});r(C)},x=()=>{if(!i.selected)return;const b=m==null?void 0:m[i.selected],S=yt(n,{url:b});r(S)};return h.useEffect(()=>{if(!s||!m||i.selected)return;const b=yt(n);for(const[S,C]of Object.entries(m)){const v=yt(n,{url:C});if(ya(b,v)){o({selected:S});return}}},[s,m,i.selected]),e.jsxs(M,{align:"center",justify:"space-between",style:{width:"100%"},children:[e.jsx(Cy,{type:t,filterData:a,filterSettings:i,configFilters:m,filterSchema:n,onDelete:g,onSelect:f,updateSettings:o}),e.jsx(uy,{type:t,filterData:a,filterSettings:i,onDelete:g,updateSettings:o,resetFilterToSelected:x,clearFilter:c})]})},Ty="_selectRoot_cr1qf_1",ky={selectRoot:Ty},Vl=({options:t,value:s,onChange:a})=>{const{t:n}=T();return e.jsx(ue,{options:t.map(i=>({value:i,label:i})),onChange:a,defaultValue:s,value:s??n("Saved Filters"),rootClassName:ky.selectRoot,"data-testid":"saved-filters-select"})},Iy="_clearFilter_mhfwo_1",$y={clearFilter:Iy},{ResetIcon:Ly}=Ce,Hl=({isVisible:t,onClear:s})=>{const{t:a}=T();return t?e.jsx(L,{id:"btn-clear-filter-test-plan",icon:e.jsx(Ly,{width:16,height:16}),onClick:s,ghost:!0,className:$y.clearFilter,style:{gap:4,width:"fit-content"},children:a("Clear")}):null},Yl=({steps:t,status:s,onApply:a})=>{const{t:n}=T(),i=()=>{if(s){const r={};t.forEach(o=>{o.id!==void 0&&o.id!==null&&(r[o.id.toString()]=s)}),a(r)}};return t.length===0?null:e.jsx(L,{disabled:!s,onClick:i,children:n("Apply to steps")})},Pr=(t,s,a)=>{a(ms.util.invalidateTags([{type:"Test",id:s}])),a(Be.util.invalidateTags([{type:"TestPlanStatistics",id:t}])),a(Be.util.invalidateTags([{type:"TestPlanHistogram",id:t}])),a(wp),a(Qh(t))},Fn="results",jn=Je.createApi({reducerPath:"resultApi",baseQuery:pt,tagTypes:["Result"],endpoints:t=>({getResults:t.query({query:({testId:s,showArchive:a,project:n})=>({url:`${Fn}/`,params:{test:s,is_archive:a,project:n}}),providesTags:s=>$t(s,"Result")}),updateResult:t.mutation({query:({id:s,body:a})=>({url:`${Fn}/${s}/`,method:"PATCH",body:a}),async onQueryStarted({testPlanId:s},{dispatch:a,queryFulfilled:n}){try{const{data:i}=await n;Pr(s??"LIST",i.test,a),a(ms.util.invalidateTags([{type:"Test",id:"LIST"}])),a(Be.util.invalidateTags([{type:"TestPlanTest",id:"LIST"}]))}catch(i){console.error(i)}},invalidatesTags:(s,a)=>a?[]:Ge(s,"Result")}),createResult:t.mutation({query:({body:s})=>({url:`${Fn}/`,method:"POST",body:s}),async onQueryStarted({testPlanId:s},{dispatch:a,queryFulfilled:n}){try{const{data:i}=await n;Pr(s??"LIST",i.test,a),a(ms.util.invalidateTags([{type:"Test",id:"LIST"}])),a(Be.util.invalidateTags([{type:"TestPlanTest",id:"LIST"}]))}catch(i){console.error(i)}},invalidatesTags:[{type:"Result",id:"LIST"}]})})}),{useCreateResultMutation:Wl,useUpdateResultMutation:Ay,useLazyGetResultsQuery:Py}=jn,Ql=({mode:t,setValue:s})=>{const{project:a}=h.useContext(J),{allStatusesId:n}=qt({project:a.id}),i=z(_s),{data:r,isLoading:o}=La({project:String(a.id),test:i==null?void 0:i.id},{skip:!i}),c=h.useMemo(()=>r?r.filter(_=>_.applied_to.testresult).filter(_=>_.applied_to.testresult.suite_ids.length&&(i!=null&&i.suite)?_.applied_to.testresult.suite_ids.includes(i==null?void 0:i.suite):!0).map(_=>Tn({attribute:_,model:"testresult"})):[],[r]),l=_=>{s("attributes",_,{shouldDirty:!0})},{attributes:d,addAttribute:u,getAttributeJson:p,onAttributeChangeName:m,onAttributeChangeType:g,onAttributeChangeValue:f,onAttributeRemove:x,resetAttributes:y,setAttributes:j}=kn({mode:t,initAttributes:c,setValue:l,addAttributeAdditionalParams:{required:!1,status_specific:n},getJsonAdditionalParams:{required:!1,status_specific:n}});return{attributes:d,isLoading:o,setAttributes:j,resetAttributes:y,addAttribute:u,onAttributeChangeType:g,onAttributeChangeValue:f,onAttributeChangeName:m,onAttributeRemove:x,getAttributeJson:p}},Gl=(t,s,a)=>t.filter(n=>{var r,o,c;return!((r=n.status_specific)!=null&&r.length)||((o=n.status_specific)==null?void 0:o.length)===s.length?!0:a&&((c=n.status_specific)==null?void 0:c.includes(a))}),Ny=({setIsShow:t,testCase:s,isShow:a,onSubmit:n})=>{const{t:i}=T(),{project:r}=h.useContext(J),{showModal:o}=Ot(),[c,l]=h.useState(null),[d,{isLoading:u}]=Wl(),{handleSubmit:p,reset:m,control:g,setValue:f,register:x,formState:{isDirty:y},watch:j}=we({defaultValues:{comment:"",status:null,attachments:[],attributes:[],steps:{}}}),_=j("status"),w=z(_s),{testPlanId:b}=Q(),{statuses:S,defaultStatus:C}=qt({project:r.id}),{setAttachments:v,onReset:k,onRemove:$,onLoad:I,onChange:P,removeAttachmentIds:N,attachments:A,attachmentsIds:q,isLoading:O}=ls(g,r.id),{attributes:Y,addAttribute:ee,onAttributeChangeName:U,onAttributeChangeType:E,onAttributeChangeValue:D,onAttributeRemove:ae,resetAttributes:oe}=Ql({mode:"create",setValue:f}),te=Gl(Y,S,_),[B,ie]=h.useState({}),{onHandleError:ke}=We(l),qe=()=>{t(!1),ie({}),l(null),k(),N(),oe(),m()},Qe=()=>{if(!(u||O)){if(y){o(qe);return}qe()}},ge=async ze=>{if(!w)return;l(null);const{isSuccess:pe,attributesJson:_e,errors:Ue}=ps(te);if(!pe){l({attributes:JSON.stringify(Ue)});return}const Ze=[];s.steps.length&&s.steps.forEach(Ne=>{B[Ne.id]===void 0||B[Ne.id]===null?console.error(`Step ${Ne.id} is not selected`):Ze.push({step:Ne.id,status:B[Ne.id]})});try{const Ne={...ze,attributes:_e,test:w.id,steps_results:Ze},Xe=await d({testPlanId:Number(b),body:Ne}).unwrap();qe(),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{action:"created",title:i("Result"),link:`/projects/${r.id}/plans/${b}/?test=${Xe.test}#result-${Xe.id}`,id:String(Xe.id)})}),n==null||n(Xe)}catch(Ne){ke(Ne)}};h.useEffect(()=>{if(C&&!_&&a){f("status",C.id,{shouldDirty:!0});const ze=s.steps.reduce((pe,_e)=>(_e.id&&(pe[_e.id]=C.id),pe),{});ie(ze)}},[C,a,_]);const rt=s.steps.every(ze=>B[ze.id]);return{isLoading:u,isLoadingCreateAttachment:O,isDirty:y,attachments:A,attachmentsIds:q,control:g,attributes:te,steps:B,errors:c,onLoad:I,onChange:P,onRemove:$,handleSubmitForm:p(ge),handleCancel:Qe,setValue:f,register:x,addAttribute:ee,onAttributeChangeName:U,onAttributeChangeType:E,onAttributeChangeValue:D,onAttributeRemove:ae,setSteps:ie,setAttachments:v,statuses:S,disabled:!y||u||!_||!rt}},Ry=t=>{const{t:s}=T(),{isLoading:a,isLoadingCreateAttachment:n,attachments:i,attachmentsIds:r,control:o,attributes:c,steps:l,errors:d,onLoad:u,onChange:p,onRemove:m,handleSubmitForm:g,handleCancel:f,setValue:x,register:y,addAttribute:j,onAttributeChangeName:_,onAttributeChangeType:w,onAttributeChangeValue:b,onAttributeRemove:S,setSteps:C,setAttachments:v,statuses:k,disabled:$}=Ny(t),{isShow:I,testCase:P}=t;return e.jsxs(he,{className:"create-result-modal",width:1200,centered:!0,title:`${s("Create")} ${s("Result")}`,open:I,onCancel:f,footer:[e.jsx(L,{id:"cancel-create-result-modal",onClick:f,children:s("Cancel")},"back"),e.jsx(L,{id:"create-result-modal",type:"primary",loading:a||n,onClick:g,disabled:$,children:s("Create")},"submit")],children:[d?e.jsx(it,{error:d,skipFields:["status","comment","attributes"]}):null,e.jsx(R,{id:"create-result-form",layout:"vertical",onFinish:g,children:e.jsxs(Ye,{children:[e.jsxs(Le,{flex:"1 0",children:[e.jsx(R.Item,{label:s("Status"),validateStatus:d!=null&&d.status?"error":"",help:d!=null&&d.status?d.status:s("Set the test status (passed, failed etc.)."),children:e.jsx(F,{name:"status",control:o,render:({field:N})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(ue,{...N,placeholder:s("Please select"),style:{width:"100%"},id:"create-result-status",children:k.map(A=>e.jsx(ue.Option,{value:A.id,children:e.jsx(Rt,{id:A.id,name:A.name,color:A.color,extraId:"create-result"})},A.id))}),e.jsx(Yl,{steps:P.steps,status:N.value,onApply:C})]})})}),e.jsx(R.Item,{label:s("Comment"),validateStatus:d!=null&&d.comment?"error":"",help:d!=null&&d.comment?d.comment:s("Describe your test result."),children:e.jsx(F,{name:"comment",control:o,render:({field:N})=>e.jsx(lt,{uploadId:"create-result-comment",textAreaId:"create-result-comment-textarea",fieldProps:N,stateAttachments:{attachments:i,setAttachments:v},customRequest:u,setValue:x})})}),e.jsx(mt.DropFiles,{attachments:i,attachmentsIds:r,onChange:p,onLoad:u,onRemove:m,register:y,idInput:"create-result-attachments-input"})]}),e.jsx(Le,{children:e.jsx(je,{type:"vertical",style:{height:"100%"}})}),e.jsxs(Le,{flex:"1 0",children:[!!P.steps.length&&e.jsxs(Ye,{style:{flexDirection:"column"},children:[e.jsx("div",{className:"ant-col ant-form-item-label",children:e.jsx("label",{title:"Steps",children:s("Steps")})}),e.jsx($a.ResultInCreateModal,{testCase:P,steps:l,setSteps:C})]}),e.jsx(R.Item,{children:e.jsx(F,{name:"attributes",control:o,render:({field:N})=>e.jsxs(Ye,{style:{flexDirection:"column",marginTop:P.steps.length?24:0},children:[e.jsx(oa,{attributes:c,onChangeName:_,onChangeType:w,onChangeValue:b,onRemove:S,onBlur:N.onBlur,errors:d!=null&&d.attributes?JSON.parse(d==null?void 0:d.attributes):void 0}),e.jsx(ra,{onClick:j})]})})})]})]})})]})},Dy=({isDisabled:t,testCase:s,onSubmit:a})=>{const{t:n}=T(),[i,r]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"add-result-btn",type:"primary",onClick:()=>r(!0),icon:e.jsx(ct,{}),disabled:t,children:n("Add Result")}),e.jsx(Ry,{isShow:i,setIsShow:r,testCase:s,onSubmit:a})]})},My=({setIsShow:t,testResult:s,isShow:a,isClone:n,onSubmit:i})=>{const{t:r}=T(),{project:o}=h.useContext(J),{showModal:c}=Ot(),[l,d]=h.useState(null),{handleSubmit:u,reset:p,control:m,setValue:g,register:f,formState:{isDirty:x},watch:y}=we({mode:"all",defaultValues:{comment:s.comment,status:s.status,attributes:[],steps:{},attachments:[]}}),j=y("status"),_=y("steps")??{},{testPlanId:w}=Q(),{statuses:b,getStatusById:S,defaultStatus:C}=qt({project:o.id}),{setAttachments:v,onReset:k,onRemove:$,onLoad:I,onChange:P,removeAttachmentIds:N,attachments:A,attachmentsIds:q,isLoading:O}=ls(m,o.id),{onHandleError:Y}=We(d),[ee,{isLoading:U}]=Ay(),[E,{isLoading:D}]=Wl(),ae=U||D||O,{attributes:oe,isLoading:te,setAttributes:B,addAttribute:ie,onAttributeChangeName:ke,onAttributeChangeType:qe,onAttributeChangeValue:Qe,onAttributeRemove:ge,getAttributeJson:rt}=Ql({mode:"edit",setValue:g}),ze=Gl(oe,b,j),pe=Me=>!!S(Me);h.useEffect(()=>{if(!a)return;const Me={};s.steps_results.forEach(Ie=>{const Dt=String(Ie.id);pe(Ie.status)&&(Me[Dt]=Ie.status)});const et=s.attachments.map(Ie=>({...Ie,uid:String(Ie.id)}));et.length&&!n&&v(et);const tt=rt(s.attributes);B(tt),p({comment:s.comment,status:S(s.status)?s.status:void 0,attributes:tt,steps:Me,attachments:s.attachments.map(Ie=>Ie.id)})},[a,n,s,b]),h.useEffect(()=>{if(te)return;if(C&&!j&&a){g("status",C.id,{shouldDirty:!0});const et=s.steps_results.reduce((tt,Ie)=>(Ie.id&&(tt[Ie.id]=pe(Ie.status)?Ie.status:C.id),tt),{});p({comment:s.comment,status:s.status,attributes:rt(s.attributes),steps:et})}},[C,a,j,s.steps_results,te]);const _e=()=>{t(!1),d(null),p(),N(),B([]),k()},Ue=()=>{if(!ae){if(x){c(_e);return}_e()}},Ze=async Me=>{if(!s)return;d(null);const{isSuccess:et,attributesJson:tt,errors:Ie}=ps(ze);if(!et){d({attributes:JSON.stringify(Ie)});return}const Dt=[];Object.keys(_).length&&Object.entries(_).forEach(([bt,ot])=>{Dt.push({id:bt,status:ot})});try{const bt={...Me,attributes:tt,steps_results:Dt,test:s.test};let ot=null;if(!n)ot=await ee({id:s.id,testPlanId:w?Number(w):null,body:bt}).unwrap();else{const bs=re=>{var Z;return(Z=s.steps_results.find(ne=>ne.id===parseInt(re)))==null?void 0:Z.step},vs=Dt.map(re=>{var Z;return{step:(Z=bs(re.id))==null?void 0:Z.toString(),status:re.status}}).filter(re=>re.step!==void 0);ot=await E({testPlanId:w?Number(w):null,body:{...bt,steps_results:vs}}).unwrap()}_e(),H.success({message:r("Success"),closable:!0,description:e.jsx(Re,{action:"updated",title:r("Result"),link:`/projects/${o.id}/plans/${w}/?test=${ot.test}#result-${ot.id}`,id:String(ot.id)})}),i==null||i(ot,s)}catch(bt){Y(bt)}},Ne=Me=>{g("steps",Me,{shouldDirty:!0})},Xe=s.steps_results.every(Me=>_[Me.id]),_t=!x&&!n||!Xe||!j;return{isLoading:ae,errors:l,control:m,attachments:A,attachmentsIds:q,watchSteps:_,isDirty:x,setAttachments:v,handleStepsChange:Ne,handleAttachmentsChange:P,handleAttachmentsLoad:I,handleAttachmentsRemove:$,setValue:g,handleCancel:Ue,register:f,attributes:ze,setAttributes:B,addAttribute:ie,onAttributeChangeType:qe,onAttributeChangeValue:Qe,onAttributeChangeName:ke,onAttributeRemove:ge,handleSubmitForm:u(Ze),statuses:b,isDisabledSubmit:_t}},Fy=({isShow:t,setIsShow:s,testResult:a,testCase:n,isClone:i,onSubmit:r})=>{const{t:o}=T(),{isLoading:c,errors:l,attachments:d,attachmentsIds:u,control:p,attributes:m,watchSteps:g,setAttachments:f,handleStepsChange:x,handleAttachmentsLoad:y,setValue:j,handleCancel:_,handleSubmitForm:w,addAttribute:b,onAttributeChangeType:S,onAttributeChangeValue:C,onAttributeChangeName:v,onAttributeRemove:k,handleAttachmentsChange:$,handleAttachmentsRemove:I,register:P,statuses:N,isDisabledSubmit:A}=My({isShow:t,setIsShow:s,testResult:a,isClone:i,onSubmit:r});return e.jsxs(he,{className:`test-result-edit${i?"-clone":""}-modal`,width:1200,centered:!0,open:t,onCancel:_,title:i?`${o("Clone Test Result")} '${a.id}'`:`${o("Edit Test Result")} '${a.id}'`,destroyOnClose:!0,footer:[e.jsx(L,{onClick:_,children:o("Cancel")},"back"),e.jsx(L,{loading:c,type:"primary",onClick:w,disabled:A,children:o(i?"Clone":"Update")},"submit")],children:[l?e.jsx(it,{error:l,skipFields:["status","comment","attributes"]}):null,e.jsx(R,{id:"test-result-edit-form",layout:"vertical",onFinish:w,children:e.jsxs(Ye,{children:[e.jsxs(Le,{flex:"1 0",children:[e.jsx(R.Item,{label:o("Status"),validateStatus:l!=null&&l.status?"error":"",help:l!=null&&l.status?l.status:"Set the test status (passed, failed etc.).",children:e.jsx(F,{name:"status",control:p,render:({field:q})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(ue,{...q,placeholder:o("Please select"),style:{width:"100%"},id:`${i?"clone":"edit"}-result-status`,children:N.map(O=>e.jsx(ue.Option,{value:Number(O.id),children:e.jsx(Rt,{name:O.name,color:O.color,id:O.id,extraId:`${i?"clone":"edit"}-result`})},O.id))}),e.jsx(Yl,{steps:a.steps_results,status:q.value,onApply:x})]})})}),e.jsx(R.Item,{label:o("Comment"),validateStatus:l!=null&&l.comment?"error":"",help:l!=null&&l.comment?l.comment:"",children:e.jsx(F,{name:"comment",control:p,render:({field:q})=>e.jsx(lt,{uploadId:`${i?"clone":"edit"}-result-comment`,textAreaId:`${i?"clone":"edit"}-result-comment-textarea`,fieldProps:q,stateAttachments:{attachments:d,setAttachments:f},customRequest:y,setValue:j})})}),e.jsx(mt.DropFiles,{attachments:d,attachmentsIds:u,onChange:$,onLoad:y,onRemove:I,register:P,idInput:`${i?"clone":"edit"}-result-attachments-input`})]}),e.jsx(Le,{children:e.jsx(je,{type:"vertical",style:{height:"100%"}})}),e.jsxs(Le,{flex:"1 0",children:[!!n.steps.length&&e.jsxs(Ye,{style:{flexDirection:"column",marginTop:0},children:[e.jsx("div",{className:"ant-col ant-form-item-label",children:e.jsx("label",{title:"Steps",children:o("Steps")})}),e.jsx($a.ResultInEditModal,{stepResultsData:a.steps_results,stepResults:g,setStepsResult:x,id:`${i?"clone":"edit"}`})]}),e.jsx(F,{name:"attributes",control:p,render:({field:q})=>e.jsxs(Ye,{style:{flexDirection:"column",marginTop:n.steps.length?24:0},children:[e.jsx(oa,{attributes:m,onChangeName:v,onChangeType:S,onChangeValue:C,onRemove:k,onBlur:q.onBlur,errors:l!=null&&l.attributes?JSON.parse(l==null?void 0:l.attributes):void 0}),e.jsx(ra,{onClick:b})]})})]})]})})]})},Nr=({testCase:t,testResult:s,isDisabled:a,isClone:n,onSubmit:i})=>{const{t:r}=T(),[o,c]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:`edit${n?"-clone":""}-result`,onClick:()=>c(!0),type:"link",style:{border:"none",padding:0,height:"auto",lineHeight:1},disabled:a,children:e.jsx("span",{style:{textDecoration:"underline"},children:n?e.jsx(le,{placement:"topRight",title:r("Clone test result"),children:e.jsx(rs,{})}):r("Edit")})}),e.jsx(Fy,{isShow:o,setIsShow:c,testResult:s,testCase:t,isClone:n,onSubmit:i})]})},Ey="_assignBlock_1b8ap_1",By="_assignRow_1b8ap_15",Oy="_assignToMe_1b8ap_31",qy="_assignToMeModal_1b8ap_53",Za={assignBlock:Ey,assignRow:By,assignToMe:Oy,assignToMeModal:qy},Kl=({isOpenModal:t,errors:s,isDirty:a,isLoadingUpdateTest:n,selectedUser:i,handleClose:r,handleSubmitForm:o,handleAssignUserChange:c,handleAssignUserClear:l,handleAssignToMe:d,isAssignToMe:u})=>{const{t:p}=T(),{project:m}=h.useContext(J);return e.jsx(he,{className:"test-assign-to-modal",title:p("Assign To"),open:t,onCancel:r,footer:[e.jsx(L,{onClick:r,children:p("Cancel")},"back"),e.jsx(L,{type:"primary",onClick:o,disabled:!a&&!!i,loading:n,children:p("Save")},"submit")],children:e.jsx(R,{id:"test-assign-form",layout:"vertical",onFinish:o,children:e.jsxs(R.Item,{label:p("Name"),validateStatus:s!=null&&s.assignUserId?"error":"",help:(s==null?void 0:s.assignUserId)??"",children:[e.jsx(Il,{selectedUser:i,handleChange:c,handleClear:l,project:m}),!u&&e.jsx("button",{className:Za.assignToMeModal,onClick:d,type:"button",children:p("Assign To Me")})]})})})},Jl=({onSubmit:t})=>{const{t:s}=T(),{me:a}=h.useContext(Pe),[n,i]=h.useState(null),[r,o]=h.useState(!1),{handleSubmit:c,reset:l,setValue:d,formState:{isDirty:u}}=we(),[p,m]=h.useState(null),{onHandleError:g}=We(m),f=()=>{o(!1),l()},x=()=>{o(!0)},y=async S=>{m(null);try{await t(S),f(),H.success({message:s("Success"),closable:!0,description:s("User assigned successfully")})}catch(C){g(C)}},j=()=>{a&&y(String(a.id))},_=S=>{y(S.assignUserId)},w=S=>{S&&(i(S),d("assignUserId",String(S.value)||"",{shouldDirty:!0}))},b=()=>{i(null),d("assignUserId","",{shouldDirty:!0})};return{isOpenModal:r,errors:p,isDirty:u,me:a,selectedUser:n??void 0,handleClose:f,handleSubmitForm:c(_),handleOpenAssignModal:x,handleAssignUserChange:w,handleAssignUserClear:b,handleAssignToMe:j,setSelectedUser:i}},zy=({onSuccess:t})=>{const s=z(_s),a=ye(),[n,{isLoading:i}]=Vh(),r=async _=>{if(!s)return;const w=await n({id:s.id,body:{assignee:_}}).unwrap();a(As(w)),t==null||t()},{isOpenModal:o,errors:c,isDirty:l,me:d,handleClose:u,handleOpenAssignModal:p,handleAssignUserChange:m,handleAssignUserClear:g,handleAssignToMe:f,setSelectedUser:x,handleSubmitForm:y,selectedUser:j}=Jl({onSubmit:r});return h.useEffect(()=>{s!=null&&s.assignee&&x({label:String(s.assignee_username),value:Number(s.assignee)})},[s]),{activeTest:s,isOpenModal:o,errors:c,isDirty:l,isLoadingUpdateTest:i,me:d,selectedUser:j,handleClose:u,handleSubmitForm:y,handleOpenAssignModal:p,handleAssignUserChange:m,handleAssignUserClear:g,handleAssignToMe:f}},Uy=({onSuccess:t})=>{const{t:s}=T(),{activeTest:a,isOpenModal:n,errors:i,isDirty:r,isLoadingUpdateTest:o,me:c,selectedUser:l,handleClose:d,handleOpenAssignModal:u,handleSubmitForm:p,handleAssignUserChange:m,handleAssignUserClear:g,handleAssignToMe:f}=zy({onSuccess:t}),x=Number(a==null?void 0:a.assignee)===Number(c==null?void 0:c.id);return e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:s("Assign To")}),e.jsx("div",{style:{padding:8,marginBottom:8},children:e.jsx(G,{id:"test-case-assign-to",children:e.jsxs("div",{className:Za.assignBlock,children:[e.jsx(Ut,{size:32,avatar_link:(a==null?void 0:a.avatar_link)??null}),e.jsx(G.Text,{id:"test-case-assign-to-user",children:a!=null&&a.assignee_username?a==null?void 0:a.assignee_username:s("Nobody")}),e.jsxs("div",{className:Za.assignRow,children:[e.jsx(L,{id:"assign-to-btn",icon:e.jsx(jo,{style:{fontSize:14}}),onClick:u,size:"small",children:s("Assign To")},"submit"),!x&&e.jsx("button",{className:Za.assignToMe,onClick:f,"data-testid":"test-detail-assign-to-me",children:s("Assign To Me")})]})]})})}),e.jsx(Kl,{isOpenModal:n,errors:i,isDirty:r,isLoadingUpdateTest:o,selectedUser:l,handleClose:d,handleOpenAssignModal:u,handleSubmitForm:p,handleAssignUserChange:m,handleAssignUserClear:g,handleAssignToMe:f,isAssignToMe:x})]})},Vy=({isLoading:t,onSubmit:s})=>{const{t:a}=T(),{isOpenModal:n,errors:i,isDirty:r,selectedUser:o,handleClose:c,handleOpenAssignModal:l,handleSubmitForm:d,handleAssignUserChange:u,handleAssignUserClear:p,handleAssignToMe:m}=Jl({onSubmit:s});return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"assign-to-btn",icon:e.jsx(jo,{style:{fontSize:14}}),onClick:l,children:a("Assign To")},"submit"),e.jsx(Kl,{isOpenModal:n,errors:i,isDirty:r,isLoadingUpdateTest:t??!1,selectedUser:o,handleClose:c,handleOpenAssignModal:l,handleSubmitForm:d,handleAssignUserChange:u,handleAssignUserClear:p,handleAssignToMe:m,isAssignToMe:!1})]})},Hy=({result:t})=>{const{t:s}=T();return e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0,fontSize:14},children:s("Comment")}),e.jsx("div",{className:"content markdown",id:"test-result-comment",children:e.jsx(At,{content:t.comment?t.comment:s("No Comment")})})]})},Yy=({stepsResult:t})=>{const{t:s}=T();return e.jsxs(e.Fragment,{children:[e.jsx(je,{orientation:"left",style:{margin:0,fontSize:14},children:s("Steps")}),e.jsx($a.Result,{stepsResult:t})]})},Wy="_resultList_1nyey_1",Qy="_resultListItem_1nyey_9",Gy="_resultListHeader_1nyey_19",Ky="_resultListBody_1nyey_29",Jy="_resultListFooter_1nyey_37",Zy="_resultListHeaderBase_1nyey_55",Xy="_resultListHeaderStatus_1nyey_63",e_="_status_1nyey_73",t_="_divider_1nyey_83",s_="_link_1nyey_93",a_="_activeHashResult_1nyey_103",Bt={resultList:Wy,resultListItem:Qy,resultListHeader:Gy,resultListBody:Ky,resultListFooter:Jy,resultListHeaderBase:Zy,resultListHeaderStatus:Xy,status:e_,divider:t_,link:s_,activeHashResult:a_},n_=()=>{const{t}=T();return e.jsx("div",{style:{padding:8},id:"test-result",children:e.jsx(G,{children:e.jsx(G.Paragraph,{children:e.jsx(G.Text,{style:{whiteSpace:"pre-wrap"},children:t("No test results")})})})})},i_=({testId:t,testCase:s,isProjectArchive:a})=>{const{t:n}=T(),{testsTree:i}=h.useContext(la),r=Nt(),{projectId:o,testPlanId:c}=Q(),l=z(Tl),d=z(_s),[u,{data:p,isFetching:m,isSuccess:g}]=Py(),f=async()=>{var x,y;if(String(d==null?void 0:d.plan)===String(c)){await((x=i.current)==null?void 0:x.initRoot({initParent:c}));return}await((y=i.current)==null?void 0:y.refetchNodeBy(j=>j.id===(d==null?void 0:d.plan)))};return h.useEffect(()=>{u({testId:String(t),showArchive:l,project:o??""})},[t,l]),h.useEffect(()=>{if(r.hash&&g){const x=document.getElementById(r.hash.substring(1));x==null||x.scrollIntoView({behavior:"smooth"})}},[r,g]),m||!p?e.jsx(zt,{}):p.length===0?e.jsx(n_,{}):e.jsx("div",{className:Bt.resultList,id:"test-result",children:p.map(x=>e.jsxs("div",{id:`result-${x.id}`,className:V(Bt.resultListItem,{[Bt.activeHashResult]:r.hash===`#result-${x.id}`}),children:[e.jsxs("div",{className:Bt.resultListHeader,children:[e.jsx("div",{className:Bt.resultListHeaderBase,children:e.jsxs(ce,{children:[e.jsx(Ut,{size:32,avatar_link:x.avatar_link}),e.jsx("p",{style:{margin:0,fontWeight:500},id:"test-result-username",children:x.user_full_name?x.user_full_name:"-"})]})}),e.jsxs(ce,{children:[x.is_archive?e.jsx("div",{children:e.jsx(Ps,{color:Oe.error,children:n("Archived")})}):null,e.jsx("div",{className:Bt.resultListHeaderStatus,children:x.status_text&&e.jsx(Rt,{name:x.status_text,id:x.status,color:x.status_color})})]})]}),e.jsxs("div",{className:Bt.resultListBody,children:[e.jsx(Hy,{result:x}),!!x.steps_results.length&&e.jsx(Yy,{stepsResult:x.steps_results}),e.jsx(Oo,{attributes:x.attributes}),!!x.attachments.length&&e.jsx(mt.Field,{attachments:x.attachments})]}),e.jsxs("div",{className:Bt.resultListFooter,"data-testid":"test-result-footer",children:[e.jsxs("span",{children:[e.jsx(yo,{className:Bt.link,to:`/projects/${x.project}/plans/${c}/?test=${t}#result-${x.id}`,"data-testid":"test-result-footer-created-at",children:K(x.created_at).format("YYYY-MM-DD HH:mm")}),e.jsx("span",{className:Bt.divider,children:"|"}),x.test_case_version&&e.jsxs(ve,{className:Bt.link,to:`/projects/${x.project}/suites/${s.suite.id}/?test_case=${s.id}&version=${x.test_case_version}`,"data-testid":"test-result-footer-version",children:[n("ver.")," ",x.test_case_version]})]}),e.jsxs("span",{children:[e.jsx(Nr,{isDisabled:a,testCase:s,testResult:x,isClone:!0,onSubmit:f}),e.jsx("span",{className:Bt.divider,children:"|"}),e.jsx(Nr,{isDisabled:a,testCase:s,testResult:x,isClone:!1,onSubmit:f})]})]})]},x.id))})},Zl=({testCase:t})=>{const{t:s}=T();return e.jsxs(e.Fragment,{children:[!!t.labels.length&&e.jsx(dx,{title:s("Labels"),labels:t.labels}),t.test_suite_description&&e.jsx(Up,{id:"test-suite-description",title:"Test Suite description",value:t.test_suite_description}),e.jsx(at,{id:"test-case-desc",markdown:!0,title:s("Description"),value:t.description}),e.jsx(at,{id:"test-case-setup",markdown:!0,title:s("Setup"),value:t.setup}),t.steps.length?e.jsx($a.Field,{steps:[...t.steps].sort((a,n)=>a.sort_order-n.sort_order)}):e.jsx(at,{id:"test-case-scenario",markdown:!0,title:s("Scenario"),value:t.scenario??""}),!t.steps.length&&e.jsx(at,{id:"test-case-expected",markdown:!0,title:s("Expected"),value:t.expected??""}),e.jsx(at,{id:"test-case-teardown",markdown:!0,title:"Teardown",value:t.teardown}),e.jsx(at,{id:"test-case-estimate",title:s("Estimate"),value:t.estimate??""}),!!t.attributes&&!!Object.keys(t.attributes).length&&e.jsx(at,{id:"test-case-attributes",title:s("Attributes"),value:e.jsx(Oo,{attributes:t.attributes})}),!!t.attachments.length&&e.jsx(mt.Field,{attachments:t.attachments})]})},r_=(t,s)=>t.is_leaf||!s?!1:t.id===Number(s==null?void 0:s.plan),la=h.createContext(null),o_=({children:t})=>{const{project:s}=h.useContext(J),a=h.useRef(null),n=z(ys),i=z(Na),r=z(_s),[o]=Jh(),[c]=na(),l=h.useCallback(async p=>{const m=await o({project:s.id,page:p.page,parent:p.parent?Number(p.parent):null,page_size:Ae.defaultTreePageSize,ordering:i,is_archive:n.is_archive,labels:n.labels,not_labels:n.not_labels,labels_condition:n.labels_condition,last_status:n.statuses,search:n.name_or_id,plan:n.plans,suite:n.suites,assignee:n.assignee,test_plan_started_after:n.test_plan_started_after,test_plan_started_before:n.test_plan_started_before,test_plan_created_after:n.test_plan_created_after,test_plan_created_before:n.test_plan_created_before,test_created_after:n.test_created_after,test_created_before:n.test_created_before,_n:p._n},!1).unwrap();return{data:fs(m.results,p,f=>({isOpen:r_(f,r),isLeaf:f.is_leaf})),nextInfo:m.pages,_n:p._n}},[n,i,r]),d=p=>c({project:s.id,id:Number(p)}).unwrap(),u=h.useMemo(()=>({testsTree:a,fetcher:l,fetcherAncestors:d,skipInit:!1}),[a,l,d]);return e.jsx(la.Provider,{value:u,children:t})},l_=({testPlanId:t=null})=>{const{project:s}=h.useContext(J),{testsTree:a,skipInit:n,fetcher:i,fetcherAncestors:r}=h.useContext(la),o=z(ys),c=z(Na),l=z(fn("tree"));return e.jsx(gc,{visibleColumns:l.visibleColumns,children:e.jsx(qs,{ref:a,cacheKey:`${s.id}-tests-tree`,fetcher:i,fetcherAncestors:r,initParent:t,initDependencies:[o,c],skipInit:n,rootId:t,renderNode:d=>e.jsx(cf,{node:d,visibleColumns:l.visibleColumns,projectId:s.id,testPlanId:t}),renderLoadMore:({isLoading:d,onMore:u})=>e.jsx(Rn,{isLast:!0,isRoot:!0,isLoading:d,onMore:u})})})},c_="_title_1y3b3_1",d_={title:c_},u_=()=>{const{t}=T(),{project:s}=h.useContext(J),{testsTree:a}=h.useContext(la),{testPlanId:n}=Q(),{drawerTest:i,testCase:r,isFetching:o,showArchive:c,commentOrdering:l,tab:d,handleShowArchived:u,handleCloseDetails:p,handleCommentOrderingClick:m,handleTabChange:g}=Wx(),[f,x]=h.useState(0),y=o||!s||!i;h.useEffect(()=>{!y&&location.hash&&location.hash.includes("comment")&&g("comments")},[location,y]);const j=async()=>{var b,S;if(String(i==null?void 0:i.plan)===String(n)){await((b=a.current)==null?void 0:b.initRoot({initParent:n}));return}await((S=a.current)==null?void 0:S.refetchNodeBy(C=>C.id===(i==null?void 0:i.plan)))},_=h.useMemo(()=>!i||!r?[]:[{label:t("Results"),key:"results",children:e.jsx(i_,{testId:i.id,testCase:r,isProjectArchive:s.is_archive})},{label:`${t("Comments")} (${f})`,key:"comments",forceRender:!0,children:e.jsx(sc,{model:"test",object_id:String(i.id),ordering:l,onUpdateCommentsCount:x})}],[l,i,r,f]),w=h.useMemo(()=>d==="comments"?e.jsx(L,{type:"text",onClick:m,children:e.jsx(_o,{style:{rotate:l==="asc"?"180deg":"0deg"}})}):e.jsx(Qt,{id:"result-show-archived-toggle",checked:c,onChange:u,label:t("Show Archived")}),[d,l,c,u]);return e.jsx(Nn,{id:"drawer-test-detail",isOpen:!!i,isLoading:y,onClose:p,minWidth:400,extra:r&&e.jsx(Dy,{isDisabled:s.is_archive,testCase:r,onSubmit:j}),title:r&&i&&e.jsx(M,{align:"flex-start",style:{width:"fit-content",marginRight:"auto"},children:e.jsxs(M,{vertical:!0,children:[e.jsxs(M,{gap:8,children:[i.is_archive&&e.jsx(M,{justify:"center",align:"center",style:{height:32},"data-testid":"test-detail-archive-tag",children:e.jsx(wt,{})}),e.jsx(G.Title,{level:3,className:d_.title,"data-testid":"test-detail-title",children:i.name})]}),e.jsxs(ve,{style:{color:"var(--y-grey-30)",fontSize:14,textDecoration:"underline"},to:`/projects/${i.project}/suites/${r.suite.id}/?test_case=${r.id}&version=${r.current_version}`,"data-testid":"test-detail-version",children:[t("Actual ver.")," ",r.current_version]})]})}),children:r&&i&&e.jsxs(e.Fragment,{children:[e.jsx(Zl,{testCase:r}),e.jsx(Uy,{onSuccess:j}),e.jsx(dt,{defaultActiveKey:"results",activeKey:d,onChange:g,tabBarExtraContent:w,items:_})]})})},h_="_btnShowArchive_1rfp1_1",p_="_btnsRow_1rfp1_11",m_="_list_1rfp1_23",g_="_link_1rfp1_41",Rr={btnShowArchive:h_,btnsRow:p_,list:m_,link:g_},x_=({testPlanId:t})=>{const{t:s}=T(),{project:a}=h.useContext(J),[n,i]=nt(),r=ye(),o=z(_s),c=z(ys),l=z(Na),d=z(fn("table")),u=h.useMemo(()=>({...c,testPlanId:d.testPlanId??t,ordering:l,page:d.page,page_size:d.page_size}),[d,l,c]);h.useEffect(()=>(r(Ht({key:"table",settings:{testPlanId:t}})),()=>{r(Ht({key:"table",settings:{page:1}}))}),[t]);const p={page:d.page,page_size:d.page_size};sa({params:p,queryParamsSchema:$n,updateParams:k=>{const $=k;r(Hx({key:"table",pagination:{page:($==null?void 0:$.page)??1,page_size:($==null?void 0:$.page_size)??d.page_size}}))}});const m={project:a.id,testPlanId:u.testPlanId??void 0,nested_search:!0,is_archive:u.is_archive,labels:u.labels,not_labels:u.not_labels,labels_condition:u.labels_condition,suite:u.suites,plan:u.plans,last_status:u.statuses,ordering:u.ordering,page:u.page,page_size:u.page_size,assignee:u.assignee.filter(k=>k!==kl),unassigned:u.assignee.includes("null")?!0:void 0,search:u.name_or_id,show_descendants:!0,test_plan_started_before:u.test_plan_started_before,test_plan_started_after:u.test_plan_started_after,test_plan_created_before:u.test_plan_created_before,test_plan_created_after:u.test_plan_created_after,test_created_before:u.test_created_before,test_created_after:u.test_created_after,_n:u._n},{data:g,isFetching:f}=hp(m,{skip:!u.testPlanId}),{data:x,isFetching:y}=Yh(m,{skip:!!u.testPlanId}),j=u.testPlanId?g:x,_=u.testPlanId?f:y;h.useEffect(()=>{if(d.isAllSelectedTableBulk&&(j!=null&&j.results)){const k=j.results.map($=>$.id).filter($=>!d.excludedRows.includes($));r(Ht({key:"table",settings:{selectedRows:k}}))}},[j]);const w=k=>{r(Ht({key:"table",settings:{page:k.current,page_size:k.pageSize}}))},b=k=>{n.set("test",String(k.id)),i(n),r(As(k))},S=(k,$,I)=>{if(r(Ht({key:"table",settings:{selectedRows:k,hasBulk:!!k.length}})),I.type==="all"){const P=!d.isAllSelectedTableBulk;r(Ht({key:"table",settings:{excludedRows:[],isAllSelectedTableBulk:P}})),r(Ht(P?{key:"table",settings:{selectedRows:(j==null?void 0:j.results.map(N=>N.id))??[]}}:{key:"table",settings:{selectedRows:[],hasBulk:!1}}))}else if(d.isAllSelectedTableBulk){const P=d.excludedRows.filter(A=>!(j!=null&&j.results.find(q=>q.id===A))),N=(j==null?void 0:j.results.filter(A=>!k.includes(A.id)).map(A=>A.id))??[];r(Ht({key:"table",settings:{excludedRows:[...P,...N],hasBulk:!0}}))}},C=h.useMemo(()=>[{title:s("ID"),dataIndex:"id",key:"id",width:"70px"},{title:s("Name"),dataIndex:"name",key:"name",render:(k,$)=>{const I=new URLSearchParams(location.search);return I.delete("test"),e.jsxs(ve,{id:$.name,to:`/projects/${$.project}/plans/${t??""}?test=${$.id}${I.size?`&${I.toString()}`:""}`,className:Rr.link,onClick:P=>{P.stopPropagation(),r(As($))},children:[$.is_archive&&e.jsx(wt,{}),e.jsx(Lt,{searchWords:c.name_or_id,textToHighlight:k})]})}},{title:s("Test Plan"),dataIndex:"plan_path",key:"plan_path"},{title:s("Test Suite"),dataIndex:"suite_path",key:"suite_path"},{title:s("Estimate"),dataIndex:"estimate",key:"estimate",width:"100px",render:k=>k??"-"},{title:s("Labels"),dataIndex:"labels",key:"labels",render:k=>e.jsx("ul",{className:Rr.list,children:k.map($=>e.jsx("li",{children:e.jsx(js,{content:$.name,color:Oe.accent})},$.id))})},{title:s("Last status"),dataIndex:"last_status",key:"last_status",width:"150px",filteredValue:c.statuses??null,render:(k,$)=>k?e.jsx(Rt,{name:$.last_status_name,color:$.last_status_color,id:$.last_status}):e.jsx(Ia,{})},{title:s("Assignee"),dataIndex:"assignee_username",key:"assignee_username",render:(k,$)=>$.assignee_username?e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:8},children:[e.jsx(Ut,{size:32,avatar_link:$.avatar_link}),e.jsx(Ln,{username:$.assignee_username})]}):e.jsx("span",{style:{opacity:.7},children:s("Nobody")})},{title:s("Created At"),dataIndex:"created_at",key:"created_at",width:150,render:k=>K(k).format("YYYY-MM-DD HH:mm")}].filter(k=>d.visibleColumns.some($=>$.key===k.key)),[c,d]),v={hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:d.page,pageSize:d.page_size,total:(j==null?void 0:j.count)??0};return{activeTestId:o==null?void 0:o.id,data:j==null?void 0:j.results,columns:C,isLoading:_,paginationTable:v,selectedRows:d.selectedRows,handleTableChange:w,handleRowClick:b,handleSelectRows:S}},Xl=h.memo(({testPlanId:t})=>{const{activeTestId:s,data:a,isLoading:n,paginationTable:i,columns:r,selectedRows:o,handleTableChange:c,handleRowClick:l,handleSelectRows:d}=x_({testPlanId:t?Number(t):null});return e.jsx(ht,{style:{cursor:"pointer"},rowClassName:u=>u.id===s?"active":"",columns:r,pagination:i,dataSource:a,loading:n,size:"small",onChange:c,onRow:u=>({onClick:()=>l(u)}),rowSelection:{selectedRowKeys:o,onChange:d,preserveSelectedRowKeys:!0},rowKey:"id"})});Xl.displayName="TestsTable";const f_="_select_44bu6_1",j_={select:f_},y_=({value:t,onChange:s,onClose:a,onClear:n,...i})=>{const{t:r}=T(),{project:o}=h.useContext(J),{statuses:c,isLoading:l}=qt({project:o.id}),[d,u]=h.useState(!1),p=g=>{if(!g.length){n==null||n();return}s(g)},m=g=>{u(g),g||a==null||a()};return e.jsxs(ue,{placeholder:r("Filter by Status"),mode:"multiple",showSearch:!0,style:{width:"100%"},loading:l,allowClear:!0,className:j_.select,value:l?[]:t,onChange:p,onClear:n,open:d,onDropdownVisibleChange:m,...i,children:[e.jsx(ue.Option,{value:"null","data-testid":"status-filter-untested",children:e.jsx(Ia,{})},"untested"),c.map(g=>e.jsx(ue.Option,{value:String(g.id),"data-testid":`status-filter-status-${g.name}`,children:e.jsx(Rt,{id:g.id,name:g.name,color:g.color})},g.id))]})},__="_formBetween_h3g45_1",b_="_formLabel_h3g45_27",v_="_assigneeToMe_h3g45_43",pa={formBetween:__,formLabel:b_,assigneeToMe:v_},{FilterPlusIcon:S_}=Ce,w_=()=>{const{t}=T(),{project:s}=h.useContext(J),{me:a}=h.useContext(Pe),{testPlanId:n}=Q(),i=ye(),r=z(ys),o=z(Na),c=z(Pl),l=z(Al),[d,u]=h.useState(!1),[p]=tp(),[m]=pp(),[g,f]=h.useState(s.id),{control:x,handleSubmit:y,setValue:j,reset:_,getValues:w,watch:b}=we({defaultValues:r}),S=b("is_archive");h.useEffect(()=>{_(r)},[r]);const C=B=>{i(Rs(B))};sa({params:{ordering:o},queryParamsSchema:xl(),updateParams:B=>{i(ai(B.ordering))}}),sa({params:r,queryParamsSchema:xn,updateParams:C});const k=B=>{i(Vi(B))},$=()=>{i(si())},I=()=>{u(!0)},P=()=>{u(!1)},N=B=>{i(Rs(B))},A=()=>{y(N)()},q=B=>{j("labels_condition",B),A()},O=()=>{if(!a)return;const B=w("assignee").filter(ie=>ie!==String(a.id));j("assignee",[String(a.id),...B]),A()},Y=B=>{j("labels",B.labels),j("not_labels",B.not_labels),j("labels_condition",B.labels.length+B.not_labels.length<2?void 0:B.labels_condition),A()},ee=(B,ie)=>{ie.includes("_after")&&B===null?(j(ie,void 0,{shouldDirty:!0}),j(ie.replace("_after","_before"),void 0,{shouldDirty:!0})):j(ie,B?B.format("YYYY-MM-DD"):void 0,{shouldDirty:!0}),A()},U=B=>{j("is_archive",B||void 0),A()},E=()=>p({parent:n?Number(n):null,project:s.id}).unwrap(),D=()=>m({parent:n?Number(n):null,project:s.id}).unwrap(),ae=()=>p({project:s.id,parent:null}).unwrap(),oe=()=>m({project:s.id,parent:null}).unwrap(),te=B=>w(B)?K(w(B)):void 0;return h.useEffect(()=>{g!==s.id&&(i(si()),i(Ux()),f(s.id))},[s.id]),e.jsxs(e.Fragment,{children:[e.jsxs(L,{id:"btn-filter-test-plan",icon:e.jsx(S_,{}),onClick:I,style:{gap:4,width:"fit-content"},children:[t("Filter")," ",!!l&&e.jsx(hi,{color:"var(--y-interactive-default)",count:l,"data-testid":"tests-button-filter-drawer-badge"})]}),e.jsx(Nn,{id:"tests-drawer-filter",title:e.jsx(Ul,{type:"plans",hasSomeFilter:!!l,filterData:r,filterSchema:xn,filterSettings:c,updateFilter:C,updateSettings:k,clearFilter:$}),onClose:P,isOpen:d,isLoading:!1,children:d&&e.jsxs(R,{onFinish:y(N),layout:"vertical",children:[e.jsx(R.Item,{label:t("Name or ID"),"data-testid":"tests-button-filter-drawer-name-or-id-label",children:e.jsx(F,{name:"name_or_id",control:x,render:({field:B})=>e.jsx(se,{...B,placeholder:t("Search"),onBlur:A,onKeyDown:ie=>{ie.key==="Enter"&&A()},onChange:ie=>B.onChange(ie.target.value),suffix:e.jsx(wn,{style:{color:"rgba(0,0,0,.45)"}}),allowClear:!0,"data-testid":"tests-button-filter-drawer-name-or-id-input"})})}),e.jsx(R.Item,{label:t("Test Plan"),"data-testid":"tests-button-filter-drawer-test-plan-container",children:e.jsx(F,{name:"plans",control:x,render:({field:B})=>e.jsx(ri,{getData:D,getDataFromRoot:oe,type:"plans",value:B.value,onChange:ie=>{B.onChange(ie),A()},onClear:()=>{B.onChange([]),A()}})})}),e.jsx(R.Item,{label:t("Test Suite"),"data-testid":"tests-button-filter-drawer-test-suite-container",children:e.jsx(F,{name:"suites",control:x,render:({field:B})=>e.jsx(ri,{getData:E,getDataFromRoot:ae,type:"suites",value:B.value,onChange:ie=>{B.onChange(ie),A()},onClear:()=>{B.onChange([]),A()}})})}),e.jsx(R.Item,{label:t("Status"),"data-testid":"tests-button-filter-drawer-status-container",children:e.jsx(F,{name:"statuses",control:x,render:({field:B})=>e.jsx(y_,{value:B.value,onChange:ie=>{B.onChange(ie),A()},onClear:()=>{B.onChange([]),A()},"data-testid":"tests-button-filter-drawer-status-filter-select"})})}),e.jsx(R.Item,{className:pa.formBetween,label:e.jsxs("div",{className:pa.formLabel,children:[e.jsx("span",{children:t("Assignee")}),e.jsx("button",{type:"button",className:pa.assigneeToMe,onClick:O,"data-testid":"tests-button-filter-drawer-assignee-to-me",children:t("Assigned to me")})]}),"data-testid":"tests-button-filter-drawer-assignee-container",children:e.jsx(F,{name:"assignee",control:x,render:({field:B})=>e.jsx(Fx,{value:B.value,onChange:ie=>{B.onChange(ie),A()},onClear:()=>{B.onChange([]),A()},project:s,placeholder:t("Search a user")})})}),e.jsx(R.Item,{className:pa.formBetween,label:e.jsxs("div",{className:pa.formLabel,"data-testid":"tests-button-filter-drawer-labels-label",children:[e.jsx("span",{children:t("Label")}),e.jsx(wl,{value:w("labels_condition")??"and",onChange:q,disabled:w("labels").length+w("not_labels").length<2})]}),children:e.jsx(F,{name:"labels",control:x,render:()=>e.jsx(Sl,{value:{labels:w("labels"),not_labels:w("not_labels"),labels_condition:w("labels_condition")??"and"},onChange:Y})})}),e.jsx(R.Item,{label:t("Test Plan Start Date"),style:{width:"100%"},children:e.jsxs(M,{gap:16,style:{width:"100%"},children:[e.jsx(vt,{onChange:B=>ee(B,"test_plan_started_after"),style:{width:"100%"},size:"middle",value:te("test_plan_started_after"),disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,maxDate:te("test_plan_started_before"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-plan-start-date-after"}),e.jsx(vt,{onChange:B=>ee(B,"test_plan_started_before"),style:{width:"100%"},size:"middle",value:te("test_plan_started_before"),showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,disabled:!w("test_plan_started_after"),minDate:te("test_plan_started_after"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-plan-start-date-before"})]})}),e.jsx(R.Item,{label:t("Test Plan Created At"),style:{width:"100%"},children:e.jsxs(M,{gap:16,style:{width:"100%"},children:[e.jsx(vt,{onChange:B=>ee(B,"test_plan_created_after"),style:{width:"100%"},size:"middle",value:te("test_plan_created_after"),disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,maxDate:te("test_plan_created_before"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-plan-created-at-after"}),e.jsx(vt,{onChange:B=>ee(B,"test_plan_created_before"),style:{width:"100%"},size:"middle",value:te("test_plan_created_before"),showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,disabled:!w("test_plan_created_after"),minDate:te("test_plan_created_after"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-plan-created-at-before"})]})}),e.jsx(R.Item,{label:t("Test Created At"),style:{width:"100%"},children:e.jsxs(M,{gap:16,style:{width:"100%"},children:[e.jsx(vt,{onChange:B=>ee(B,"test_created_after"),style:{width:"100%"},size:"middle",value:te("test_created_after"),disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,maxDate:te("test_created_before"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-created-at-after"}),e.jsx(vt,{onChange:B=>ee(B,"test_created_before"),style:{width:"100%"},size:"middle",value:te("test_created_before"),showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,disabled:!w("test_created_after"),minDate:te("test_created_after"),allowClear:!0,"data-testid":"tests-button-filter-drawer-test-created-at-before"})]})}),e.jsx(R.Item,{children:e.jsx(F,{name:"is_archive",control:x,render:()=>e.jsx(Qt,{id:"archive-toggle",label:t("Show Archived"),labelFontSize:14,checked:S,onChange:U,size:"lg"})})})]})})]})},C_=()=>{var c,l;const{project:t}=h.useContext(J),{userConfig:s}=h.useContext(Pe),a=ye(),n=z(Pl),i=(l=(c=s==null?void 0:s.test_plans)==null?void 0:c.filters)==null?void 0:l[t.id],r=d=>{const u=i==null?void 0:i[d],p=yt(xn,{url:u});a(Vi({selected:d})),a(Rs(p))},o=h.useMemo(()=>i?Object.keys(i):[],[s]);return o.length?e.jsx(M,{align:"center",children:e.jsx(Vl,{options:o,value:n.selected,onChange:r})}):null},{SorterIcon:T_}=Ce,k_=()=>{const{t}=T(),s=[{value:"id",label:t("ID")},{value:"name",label:t("Name")},{value:"suite_path",label:t("Test Suite")},{value:"assignee_username",label:t("Assignee")},{value:"started_at",label:t("Start Date")},{value:"created_at",label:t("Created At")}],a=ye(),n=z(Na),i=n.replace("-","")??s[1].value,r=n.startsWith("-")?"desc":"asc",o=l=>{a(ai(`${r==="desc"?`-${l}`:l}`))},c=l=>{a(ai(`${l==="desc"?`-${i}`:i}`))};return e.jsx(le,{title:t("Sort"),children:e.jsx(Ms,{content:e.jsxs(M,{gap:8,vertical:!0,style:{minWidth:200},children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary","data-testid":"tests-sorter-sort-by-title",children:t("Sort by")})}),e.jsx(jt.Group,{onChange:l=>{o(l.target.value)},value:i,defaultValue:s[1].value,"data-testid":"tests-sorter-sort-by-group",children:e.jsx(ce,{direction:"vertical",children:s.map((l,d)=>e.jsx(jt,{value:l.value,"data-testid":`tests-sorter-sort-by-${l.value}`,children:l.label},d))})}),e.jsx(je,{orientation:"left",style:{margin:"4px 0"},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary","data-testid":"tests-sorter-order-by-title",children:t("Order by")})}),e.jsx(jt.Group,{onChange:l=>{c(l.target.value)},value:r,"data-testid":"tests-sorter-order-by-group",children:e.jsxs(ce,{direction:"vertical",children:[e.jsx(jt,{value:"asc","data-testid":"tests-sorter-order-by-asc",children:t("Ascending")}),e.jsx(jt,{value:"desc","data-testid":"tests-sorter-order-by-desc",children:t("Descending")})]})})]}),arrow:!1,trigger:"click",placement:"bottom",children:e.jsx(L,{style:{minWidth:32},icon:e.jsx(T_,{color:"var(--y-sky-60)"}),"data-testid":"tests-sorter-button"})})})},ec=h.memo(({testPlanId:t,dataView:s,setDataView:a})=>{const{t:n}=T(),{testsTree:i}=h.useContext(la),r=ye(),o=z(fn("table")),c=z(fn("tree")),l=z(ys),d=z(Al),[u,{isLoading:p}]=Hh(),m=s==="list",g=m?o.visibleColumns:c.visibleColumns,f=m?o.columns:c.columns,x=S=>{const C=m?"table":"tree";r(Ht({key:C,settings:{visibleColumns:S}})),Lo(`tests-visible-cols-${C}`,S)},y=()=>{r(Ht({key:"table",settings:{selectedRows:[],excludedRows:[],isAllSelectedTableBulk:!1,hasBulk:!1}}))},j=()=>{const S={is_archive:l.is_archive,last_status:l.statuses,search:l.name_or_id,labels:l.labels,not_labels:l.not_labels,labels_condition:l.labels_condition,suite:l.suites,plan:l.plans};Object.keys(S).forEach(v=>{var $;const k=S[v];if(Array.isArray(k)){if(k.length){const I=k;S[v]=I.filter(P=>P!=="")}(($=S[v])==null?void 0:$.length)===0&&delete S[v]}k===void 0&&delete S[v]});const C={filter_conditions:S,included_tests:[],excluded_tests:[],current_plan:Number(t)};return o.isAllSelectedTableBulk?C.excluded_tests=o.excludedRows:C.included_tests=o.selectedRows,C},_=async S=>{const C=j();C.plan=S;const v=await u(C);if(v.error)throw new Error(v.error);y()},w=async S=>{const C=j();C.assignee=S??"";const v=await u(C);if(v.error)throw new Error(v.error);y()},b=()=>{r(Vi({selected:null})),r(si())};return e.jsxs(M,{justify:"space-between",align:"flex-end",style:{width:"100%",marginBottom:24},children:[e.jsx(M,{vertical:!0,gap:16,children:e.jsxs(M,{align:"center",wrap:!0,gap:16,children:[e.jsx(G.Title,{level:2,style:{marginBottom:0,textWrap:"nowrap"},children:n("Tests")}),o.hasBulk&&s==="list"&&e.jsxs(M,{gap:8,children:[e.jsx(kg,{onSubmit:_,isLoading:p}),e.jsx(Vy,{onSubmit:w,isLoading:p})]})]})}),e.jsxs(M,{gap:8,wrap:!0,justify:"flex-end",align:"center",children:[e.jsxs(M,{gap:8,align:"center",children:[e.jsx(Hl,{isVisible:!!d,onClear:b}),e.jsx(w_,{}),e.jsx(C_,{}),e.jsx(k_,{})]}),!m&&e.jsx(le,{title:n("Collapse All"),children:e.jsx(L,{icon:e.jsx(Hi,{width:18,height:18,color:"var(--y-sky-60)"}),onClick:()=>{var S;return(S=i.current)==null?void 0:S.closeAll()},"data-testid":"test-plan-detail-action-collapse-all-button"})}),e.jsx(tc,{id:m?"tests-table-setting-columns-btn":"tests-tree-setting-columns-btn",columns:f,visibilityColumns:g,onChange:x}),e.jsx(je,{type:"vertical",style:{height:"1.5em"}}),e.jsx(xc,{value:s,onChange:a})]})]})});ec.displayName="TestPlanDataActions";const I_="_title_1s529_1",$_="_infoTitle_1s529_13",L_="_infoValue_1s529_27",Cs={title:I_,infoTitle:$_,infoValue:L_},A_=()=>e.jsxs(M,{vertical:!0,children:[e.jsx(fe,{width:"30%",height:28,style:{marginBottom:4}}),e.jsxs(M,{gap:96,style:{marginBottom:12},children:[e.jsxs(M,{gap:16,children:[e.jsx(fe,{width:100,height:16}),e.jsx(fe,{width:100,height:16})]}),e.jsxs(M,{gap:16,children:[e.jsx(fe,{width:100,height:16}),e.jsx(fe,{width:100,height:16})]})]}),e.jsxs(M,{gap:8,wrap:!0,style:{marginBottom:8},children:[e.jsx(fe,{width:200,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:100,height:32})]})]}),P_=()=>{const{t}=T(),{testPlanId:s}=Q(),{treebar:a}=h.useContext(Us),{testsTree:n}=h.useContext(la),{testPlan:i,isFetching:r}=Ma(),o=async d=>{var p,m;const u=((p=d==null?void 0:d.parent)==null?void 0:p.id)??null;await((m=n.current)==null?void 0:m.refetchNodeBy(g=>g.id===u&&!g.props.isLeaf)),a.current&&await Aa(a.current,d)},c=async d=>{var p,m;const u=((p=d==null?void 0:d.parent)==null?void 0:p.id)??null;await((m=n.current)==null?void 0:m.refetchNodeBy(g=>g.id===u&&!g.props.isLeaf)),a.current&&await ll(a.current,d)},l=async d=>{var p,m;const u=((p=d==null?void 0:d.parent)==null?void 0:p.id)??null;await((m=n.current)==null?void 0:m.refetchNodeBy(g=>g.id===u&&!g.props.isLeaf)),a.current&&await Di(a.current,d)};return s?!i||r?e.jsx(A_,{}):e.jsxs(e.Fragment,{children:[e.jsxs(M,{gap:8,children:[i.is_archive&&e.jsx(wt,{size:"lg"}),e.jsx(G.Title,{id:"test-plan-title",level:2,className:Cs.title,children:i.title})]}),e.jsx(M,{style:{marginBottom:12},vertical:!0,gap:16,children:e.jsxs(M,{children:[i.started_at&&e.jsxs(G.Text,{"data-testid":"test-plan-detail-start-date-block",className:Cs.infoTitle,children:[t("Start date")," ",e.jsx(G.Text,{className:Cs.infoValue,children:K(i.started_at).format("YYYY-MM-DD")})]}),i.due_date&&e.jsxs(e.Fragment,{children:[e.jsx(je,{type:"vertical"}),e.jsxs(G.Text,{"data-testid":"test-plan-detail-due-date-block",className:Cs.infoTitle,children:[t("Due date")," ",e.jsx(G.Text,{className:Cs.infoValue,children:K(i.due_date).format("YYYY-MM-DD")})]})]}),i.finished_at&&e.jsxs(e.Fragment,{children:[e.jsx(je,{type:"vertical"}),e.jsxs(G.Text,{"data-testid":"test-plan-detail-finish-date-block",className:Cs.infoTitle,children:[t("Finish date")," ",e.jsx(G.Text,{className:Cs.infoValue,children:K(i.finished_at).format("YYYY-MM-DD")})]})]})]})}),e.jsxs(M,{wrap:!0,gap:8,style:{marginBottom:8},children:[e.jsx(ta,{testPlan:i,type:"create"}),e.jsx(Ei,{testPlan:i,onSubmit:o}),e.jsx(ta,{testPlan:i,type:"edit"}),!i.is_archive&&e.jsx(Mi,{testPlan:i,onSubmit:c}),e.jsx(Fi,{testPlan:i,onSubmit:l})]})]}):null},N_=({columns:t,id:s,visibilityColumns:a,onChange:n})=>{const{t:i}=T(),r=c=>{const l=t.filter(d=>c.includes(d.key));n==null||n(l)},o=t.map(c=>({label:i(c.title),value:c.key}));return e.jsx(Ms,{content:e.jsx(ts.Group,{options:o,value:a.map(c=>c.key),onChange:r,"data-testid":"settings-column-visibility-popover"}),title:e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary",children:i("Shown columns")})}),trigger:"click",placement:"bottomRight",children:e.jsx(le,{title:i("Shown columns"),children:e.jsx(L,{id:s,icon:e.jsx(ho,{style:{color:"var(--y-sky-60)"}})})})})},tc=h.memo(N_),R_=({isShow:t,setIsShow:s,testCase:a,onSubmit:n})=>{const{t:i}=T(),[r,{isLoading:o}]=zg(),{data:c,isLoading:l,status:d}=Qg(String(a.id),{skip:!t}),u=ye(),[p,m]=nt(),g=()=>{s(!1)},f=async()=>{try{await r(a.id).unwrap(),H.success({message:i("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"archived",title:i("Test Case")})}),p.delete("test_case"),p.delete("version"),m(p),u(qi()),n==null||n(a)}catch(x){Se(x)}g()};return e.jsx(Bs,{status:d,isShow:t,isLoading:l,isLoadingButton:o,name:a.name,typeTitle:i("Test Case"),type:"test-case",data:c??[],handleClose:g,handleDelete:f,action:"archive"})},D_=({testCase:t,onSubmit:s})=>{const{t:a}=T(),[n,i]=h.useState(!1),r=[{key:"1",label:e.jsx(ql,{testCase:t,onSubmit:s})}];return e.jsxs(e.Fragment,{children:[e.jsx(Sn.Button,{className:"archive-test-case",menu:{items:r},danger:!0,style:{width:"fit-content"},onClick:()=>i(!0),"data-testid":"archive-test-case-btn",children:a("Archive")}),e.jsx(R_,{isShow:n,setIsShow:i,testCase:t,onSubmit:s})]})},M_="_title_1y3b3_1",F_={title:M_},E_=({comments:t})=>{const s=z(aa);return e.jsx("ul",{style:{paddingLeft:8},"data-testid":"comment-list",children:t.map(a=>{const n=Number(a.user.id)===Number(s==null?void 0:s.id)&&a.deleted_at===null;return e.jsx(tb,{comment:a,isVisibleActions:n},a.id)})})},B_="_userInfo_1tpyn_1",O_="_edited_1tpyn_15",q_="_link_1tpyn_23",En={userInfo:B_,edited:O_,link:q_},z_=({commentId:t,username:s,avatarLink:a,createdAt:n,updatedAt:i})=>{const{t:r}=T(),o=window.location.pathname+window.location.search;return e.jsxs("div",{className:En.userInfo,children:[e.jsx(Ut,{size:32,avatar_link:a}),e.jsx("span",{children:s}),e.jsx("span",{children:r("added a comment")}),e.jsx(yo,{to:o+`#comment-${t}`,className:En.link,"data-testid":"comment-user-info-created-at",children:K(n).format("DD MMM YYYY HH:mm")}),!K(i).isSame(n)&&e.jsxs("span",{className:En.edited,children:[" - ",r("edited")]})]})},ma="comments",yn=Je.createApi({reducerPath:"commentsApi",tagTypes:["Comments"],baseQuery:pt,endpoints:t=>({getComments:t.query({query:s=>({url:`${ma}/`,params:s}),providesTags:()=>[{type:"Comments",id:"LIST"}]}),getCommentById:t.query({query:s=>`${ma}/${s}/`,providesTags:(s,a,n)=>[{type:"Comments",id:n}]}),addComment:t.mutation({query:s=>({url:`${ma}/`,method:"POST",body:s}),invalidatesTags:[{type:"Comments",id:"LIST"}]}),updateComment:t.mutation({query:({comment_id:s,...a})=>({url:`${ma}/${s}/`,method:"PUT",body:a}),invalidatesTags:s=>Ge(s,"Comments")}),deleteComment:t.mutation({query:s=>({url:`${ma}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"Comments",id:"LIST"}]})})}),{useGetCommentsQuery:U_,useLazyGetCommentsQuery:KI,useAddCommentMutation:V_,useDeleteCommentMutation:H_,useUpdateCommentMutation:Y_}=yn,W_=({setIsShowAdd:t,model:s,object_id:a})=>{const{t:n}=T(),{project:i}=h.useContext(J),[r,o]=h.useState(""),[c,l]=h.useState(null),{onHandleError:d}=We(l),[u,{isLoading:p}]=V_(),{control:m}=we(),{attachments:g,isLoading:f,onChange:x,onRemove:y,onLoad:j}=ls(m,i.id);return{isLoadingAddComment:p,isLoadingCreateAttachment:f,attachments:g,comment:r,errors:c,handleAddClick:async()=>{const w=g.map(b=>String(b.id));try{await u({model:s,object_id:a,content:r,attachments:w}).unwrap(),H.success({message:n("Success"),closable:!0}),o(""),t(!1)}catch(b){d(b)}},handleAttachmentRemove:y,handleAttachmentLoad:j,handleLoadAttachmentChange:x,setComment:o}},Q_=({model:t,object_id:s,setIsShowAdd:a})=>{var f;const{errors:n,comment:i,attachments:r,isLoadingAddComment:o,isLoadingCreateAttachment:c,setComment:l,handleAddClick:d,handleAttachmentRemove:u,handleLoadAttachmentChange:p,handleAttachmentLoad:m}=W_({setIsShowAdd:a,model:t,object_id:s}),{t:g}=T();return e.jsxs("div",{style:{marginTop:12,gap:12,display:"flex",flexDirection:"column"},children:[e.jsx(Qo,{id:"add-comments-text-area",style:{fontSize:13},rows:4,value:i,onChange:x=>l(x.target.value),placeholder:g("Type a comment"),autoFocus:!0}),!!((f=n==null?void 0:n.errors)!=null&&f.length)&&e.jsx(gs,{description:n.errors,type:"error"}),e.jsx(mt.List,{handleAttachmentRemove:u,attachments:r,isShowNoAttachment:!1}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(Ns,{showUploadList:!1,onChange:p,customRequest:m,children:e.jsx(L,{icon:e.jsx(bo,{}),children:g("Upload file")})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginLeft:"auto"},children:[e.jsx(L,{id:"add-comment-btn",type:"primary",onClick:d,loading:o||c,disabled:!i.length&&!r.length,children:g("Add")}),e.jsx(L,{id:"cancel-comment-btn",onClick:()=>a(!1),type:"text",children:g("Cancel")})]})]})]})},G_=({commentId:t})=>{const{t:s}=T(),[a]=H_(),n=async()=>{try{await a(t).unwrap(),H.success({message:s("Success"),closable:!0,description:s("Comment deleted successfully")})}catch(i){Se(i)}};return e.jsx(L,{id:"delete-comment",type:"link",style:{border:"none",padding:0,height:"auto",lineHeight:1},onClick:()=>{he.confirm({title:s("Do you want to delete this comment?"),okText:s("Delete"),cancelText:s("Cancel"),onOk:n,okButtonProps:{"data-testid":"delete-comment-button-confirm"},cancelButtonProps:{"data-testid":"delete-comment-button-cancel"}})},children:e.jsx("span",{style:{textDecoration:"underline"},children:s("Delete")})})},K_=t=>{const{t:s}=T(),{project:a}=h.useContext(J),[n,i]=h.useState(!1),[r,o]=h.useState(t.content),[c,{isLoading:l}]=Y_(),{control:d}=we(),{attachments:u,isLoading:p,onChange:m,onRemove:g,onLoad:f,setAttachments:x}=ls(d,a.id),y=()=>i(!1),j=()=>i(!0),_=b=>o(b.target.value),w=async()=>{try{const b=u.map(S=>String(S.id));await c({comment_id:t.id,content:r,attachments:b}),H.success({message:s("Success"),closable:!0}),y()}catch(b){Se(b)}};return h.useEffect(()=>{if(t.attachments.length){const b=t.attachments.map(S=>({...S,uid:String(S.id)}));x(b)}o(t.content)},[t]),{isShow:n,isLoading:l||p,commentValue:r,attachments:u,handleSaveClick:w,handleClose:y,handleShow:j,handleChangeComment:_,handleAttachmentLoad:f,handleAttachmentRemove:g,handleLoadAttachmentChange:m}},J_=({comment:t})=>{const{t:s}=T(),{isShow:a,isLoading:n,commentValue:i,attachments:r,handleShow:o,handleClose:c,handleSaveClick:l,handleChangeComment:d,handleAttachmentRemove:u,handleAttachmentLoad:p,handleLoadAttachmentChange:m}=K_(t);return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"edit-comment",onClick:o,type:"link",style:{border:"none",padding:0,height:"auto",lineHeight:1},children:e.jsx("span",{style:{textDecoration:"underline"},children:s("Edit")})}),e.jsxs(he,{className:"edit-comment-modal",title:s("Edit comment"),open:a,onCancel:c,footer:[e.jsx(L,{onClick:c,type:"text",children:s("Cancel")},"back"),e.jsx(L,{type:"primary",onClick:l,loading:n,disabled:!i.length,children:s("Save")},"submit")],children:[e.jsx(Qo,{id:"edit-comments-text-area",style:{fontSize:13},rows:4,value:i,onChange:d}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{marginBottom:r.length?12:0},children:e.jsx(Ns,{showUploadList:!1,onChange:m,customRequest:p,children:e.jsx(L,{icon:e.jsx(bo,{}),children:s("Upload file")})})}),e.jsx(mt.List,{handleAttachmentRemove:u,attachments:r,isShowNoAttachment:!1})]})]})]})},Z_="_wrapper_s2jfo_1",X_="_actions_s2jfo_17",eb="_hashActive_s2jfo_39",Bn={wrapper:Z_,actions:X_,hashActive:eb},tb=({comment:t,isVisibleActions:s})=>{const a=Nt();return h.useEffect(()=>{if(a.hash&&a.hash.includes("comment")){const n=document.getElementById(a.hash.substring(1));n==null||n.scrollIntoView({behavior:"smooth"})}},[a]),e.jsxs("li",{id:`comment-${t.id}`,className:V(Bn.wrapper,{[Bn.hashActive]:a.hash===`#comment-${t.id}`}),children:[e.jsx(z_,{commentId:t.id,username:t.user.username,avatarLink:t.user.avatar_link,createdAt:t.created_at,updatedAt:t.updated_at}),t.deleted_at===null?e.jsx("div",{"data-testid":`comment-${t.id}-content`,children:e.jsx(At,{content:t.content})}):e.jsx("span",{style:{fontStyle:"italic"},"data-testid":`comment-${t.id}-content-deleted`,children:t.content}),e.jsx(Wo,{attachments:t.attachments,isDivider:!1}),s&&e.jsxs("div",{className:Bn.actions,children:[e.jsx(J_,{comment:t}),e.jsx(G_,{commentId:t.id})]})]})},sb="_footer_1uqs3_1",ab={footer:sb},sc=({model:t,object_id:s,ordering:a,onUpdateCommentsCount:n})=>{const{t:i}=T(),[r,o]=h.useState(!1),c=h.useRef(null),l=a==="asc"?"created_at":"-created_at",[d,u]=h.useState({page:1,page_size:5}),p=window.location.hash.split("#comment-")[1],{data:m,isFetching:g}=U_({comment_id:p,model:t,object_id:s,page:d.page,page_size:d.page_size,ordering:l});h.useEffect(()=>{m&&n&&n(m.count)},[m]);const f=(y,j)=>{u({page:y,page_size:j})},x=()=>{o(!0)};return h.useEffect(()=>{r&&c.current&&c.current.scrollIntoView({behavior:"smooth"})},[r]),g||!m?e.jsx(zt,{}):e.jsxs(e.Fragment,{children:[e.jsx(E_,{comments:m.results??[]}),e.jsxs("div",{className:ab.footer,children:[!r&&e.jsx(L,{id:"add-comment-btn",onClick:x,icon:e.jsx(kd,{}),children:i("Add comment")}),e.jsx(fi,{defaultCurrent:1,current:d.page,pageSize:d.page_size,size:"small",total:m.count,style:{width:"fit-content",marginLeft:"auto"},onChange:f})]}),r&&e.jsx(Q_,{model:t,object_id:s,setIsShowAdd:o}),e.jsx("div",{ref:c})]})},nb="_item_1db7g_1",ib="_userInfo_1db7g_17",rb="_info_1db7g_29",On={item:nb,userInfo:ib,info:rb},ob=({testCase:t})=>{const{t:s}=T(),[a,n]=h.useState({page:1,page_size:5}),{data:i,isLoading:r}=Yg({testCaseId:t.id,page:a.page,page_size:a.page_size}),o=(c,l)=>{n({page:c,page_size:l})};return r||!i?e.jsx(zt,{}):e.jsxs(e.Fragment,{children:[e.jsx("ul",{style:{paddingLeft:8},children:i.results.map((c,l)=>{var d,u;return e.jsx("li",{className:On.item,children:e.jsxs("div",{className:On.userInfo,children:[e.jsx("div",{style:{display:"flex",marginRight:4},children:e.jsx(Ut,{size:32,avatar_link:((d=c.user)==null?void 0:d.avatar_link)??null})}),e.jsx(Ln,{username:((u=c.user)==null?void 0:u.username)??"unknown"}),e.jsxs("div",{className:On.info,children:[e.jsx("span",{style:{fontWeight:500},children:c.action.toLowerCase()})," a test case",e.jsxs("span",{children:["at ",K(c.history_date).format("DD MMM YYYY HH:mm")]}),"|",e.jsxs(ve,{to:`/projects/${t.project}/suites/${t.suite.id}?version=${c.version}&test_case=${t.id}`,id:`${c.version}-${l}`,children:[s("ver.")," ",c.version]})]})]})},l)})}),e.jsx(fi,{defaultCurrent:1,pageSize:a.page_size,size:"small",total:i.count,style:{width:"fit-content",marginLeft:"auto"},onChange:o})]})},lb=({testCase:t,isShowArchive:s})=>{var x,y;const{t:a}=T(),{projectId:n}=Q(),{renderBreadCrumbs:i}=Rl(),[r,o]=h.useState({sorter:"",filters:{}}),[c,l]=h.useState({page:1,page_size:5}),{statusesFiltersWithUntested:d}=qt({project:n}),{data:u,isFetching:p}=Wg({testCaseId:t.id,page:c.page,page_size:c.page_size,ordering:r.sorter?r.sorter:"",last_status:((y=(x=r.filters)==null?void 0:x.last_status)==null?void 0:y.join(","))??void 0,is_archive:s},{refetchOnMountOrArgChange:!0}),m=(j,_)=>{l({page:j,page_size:_})},g=[{title:a("ID"),dataIndex:"id",key:"id",width:"70px",sorter:!0,render:(j,_)=>e.jsx(ve,{to:`/projects/${_.project}/plans/${_.plan}?test=${_.id}`,children:_.id})},{title:a("Test Plan"),dataIndex:"breadcrumbs",key:"breadcrumbs",render:j=>i(j)},{title:a("Last status"),dataIndex:"last_status",key:"last_status",width:"150px",filters:d,render:(j,_)=>j?e.jsx(Rt,{id:_.last_status,name:_.last_status_name,color:_.last_status_color}):e.jsx(Ia,{})},{title:a("Assignee"),dataIndex:"assignee_username",key:"assignee_username",sorter:!0,render:(j,_)=>_.assignee_username?e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:8},children:[e.jsx(Ut,{size:32,avatar_link:_.avatar_link}),e.jsx(Ln,{username:_.assignee_username})]}):e.jsx("span",{style:{opacity:.7},children:a("Nobody")})}],f=(j,_,w)=>{const b=wi(w,"tests");o({sorter:b,filters:_})};return e.jsx(e.Fragment,{children:e.jsx(ht,{dataSource:(u==null?void 0:u.results)??[],style:{cursor:"pointer"},columns:g,pagination:{onChange:m,pageSize:c.page_size,current:c.page,total:(u==null?void 0:u.count)??0},size:"small",onChange:f,rowKey:"id",loading:p})})},cb=({testCase:t})=>{const{t:s}=T(),[a,n]=h.useState("comments"),[i,r]=h.useState(!1),[o,c]=h.useState(0),[l,d]=h.useState("desc"),u=()=>{d(l==="asc"?"desc":"asc")},p=x=>{n(x)},m=x=>{c(x)},g=h.useMemo(()=>[{key:"comments",label:`${s("Comments")} (${o})`,forceRender:!0,children:e.jsx(sc,{model:"testcase",object_id:String(t.id),ordering:l,onUpdateCommentsCount:m})},{key:"tests",label:s("Tests"),children:e.jsx(lb,{testCase:t,isShowArchive:i})},{key:"history",label:s("History"),children:e.jsx(ob,{testCase:t})}],[o,l,t,i]),f=h.useMemo(()=>{switch(a){case"comments":return e.jsx(L,{type:"text",onClick:u,"data-testid":"test-case-detail-comments-order-btn",children:e.jsx(_o,{style:{rotate:l==="asc"?"180deg":"0deg"}})});default:return e.jsx(Qt,{id:"archive-toggle",label:s("Show Archived"),checked:i,onChange:r})}},[a,l,i]);return e.jsx(dt,{defaultActiveKey:"comments",activeKey:a,items:g,onChange:p,tabBarExtraContent:f,"data-testid":"test-case-detail-tabs"})},db=(t,s)=>t.is_leaf||!s?!1:t.id===Number(s==null?void 0:s.suite.id),Da=h.createContext(null),ub=({children:t})=>{const{project:s}=h.useContext(J),a=h.useRef(null),n=z(In),i=z(Pa),r=z(zi),[o]=Tm(),[c]=ia(),l=h.useCallback(async p=>{const m=await o({project:s.id,page:p.page,parent:p.parent?Number(p.parent):null,page_size:Ae.defaultTreePageSize,ordering:i,is_archive:n.is_archive,search:n.name_or_id,suite:n.suites,labels:n.labels,not_labels:n.not_labels,labels_condition:n.labels_condition,test_case_created_after:n.test_case_created_after,test_case_created_before:n.test_case_created_before,test_suite_created_after:n.test_suite_created_after,test_suite_created_before:n.test_suite_created_before,_n:p._n},!1).unwrap();return{data:fs(m.results,p,f=>({isOpen:db(f,r),isLeaf:f.is_leaf})),nextInfo:m.pages,_n:p._n}},[n,i,r]),d=p=>c({project:s.id,id:Number(p)}).unwrap(),u=h.useMemo(()=>({fetcher:l,fetcherAncestors:d,testCasesTree:a,skipInit:!1}),[a,l,d]);return e.jsx(Da.Provider,{value:u,children:t})},hb=()=>{const{testSuiteId:t=null}=Q(),{project:s}=h.useContext(J),{testCasesTree:a,skipInit:n,fetcher:i,fetcherAncestors:r}=h.useContext(Da),o=z(mn("tree")),c=z(In),l=z(Pa);return e.jsx(gc,{visibleColumns:o.visibleColumns,children:e.jsx(qs,{ref:a,cacheKey:`${s.id}-test-cases-tree`,fetcher:i,fetcherAncestors:r,initParent:t,initDependencies:[c,l],skipInit:n,rootId:t,renderNode:d=>e.jsx(wj,{node:d,visibleColumns:o.visibleColumns,projectId:s.id,testSuiteId:t}),renderLoadMore:({isLoading:d,onMore:u})=>e.jsx(Rn,{isLast:!0,isRoot:!0,isLoading:d,onMore:u})})})},pb=()=>{const{t}=T(),{testSuiteId:s}=Q(),{testCasesTree:a}=h.useContext(Da),n=ye(),i=z(zi),[r,o]=nt(),c=r.get("version"),l=r.get("test_case"),[d,u]=h.useState(null),{control:p}=we(),[m,{isFetching:g}]=Bg(),[f]=Gg(),x=async(S,C)=>{try{const v=await m({testCaseId:S,version:C}).unwrap();n(hs(v))}catch(v){Se(v)}};h.useEffect(()=>{i&&u(Number(i.current_version))},[i]),h.useEffect(()=>{!l||i||x(String(l),c??void 0)},[l,i,c]),h.useEffect(()=>()=>{n(hs(null))},[]);const y=h.useMemo(()=>i!=null&&i.versions?[...i.versions].sort((C,v)=>v-C).map(C=>({value:C,label:`${t("ver.")} ${C}`})):[],[i]);return{testCase:i,showVersion:d,versionData:y,control:p,isFetching:g,handleClose:()=>{r.delete("test_case"),r.delete("version"),o(r),n(hs(null))},handleChangeVersion:async S=>{u(S),r.set("version",String(S)),o(r),await x(String(l),String(S))},handleRestoreVersion:()=>{!d||!i||he.confirm({title:t("Do you want to restore this version of test case?"),okText:t("Restore"),cancelText:t("Cancel"),onOk:async()=>{try{const S=await f({testCaseId:i.id,version:d}).unwrap();o({version:String(S.versions[0]),test_case:String(i.id)}),H.success({message:t("Success"),closable:!0,description:e.jsx(Re,{id:String(i.id),action:"restore",title:t("Test Case"),link:`/projects/${i.project}/suites/${i.suite.id}?version=${S.versions[0]}&test_case=${i.id}`})})}catch(S){Se(S)}},okButtonProps:{"data-testid":"restore-test-case-button-confirm"},cancelButtonProps:{"data-testid":"restore-test-case-button-cancel"}})},handleRefetch:async S=>{var C;if(a.current){if(String(s)===String(S.suite.id)){await a.current.initRoot();return}await((C=a.current)==null?void 0:C.refetchNodeBy(v=>v.id===S.suite.id))}}}},mb=()=>{const{t}=T(),{testCase:s,showVersion:a,versionData:n,control:i,isFetching:r,handleClose:o,handleChangeVersion:c,handleRestoreVersion:l,handleRefetch:d}=pb(),u=(s==null?void 0:s.versions[0])===a;return e.jsx(Nn,{id:"drawer-test-case-details",title:s&&e.jsx(M,{align:"flex-start",style:{width:"fit-content",marginRight:"auto"},children:e.jsxs(M,{gap:8,children:[s.source_archived&&e.jsx(M,{justify:"center",align:"center",style:{height:32},children:e.jsx(wt,{})}),e.jsx(G.Title,{level:3,className:F_.title,children:s.name})]})}),onClose:o,isOpen:!!s,isLoading:r,extra:s&&e.jsxs(M,{wrap:!0,gap:8,justify:"flex-end",children:[!!s.versions&&s.versions.length>1&&e.jsx(F,{name:"select",control:i,defaultValue:s.current_version,render:({field:p})=>e.jsx(ue,{...p,placeholder:t("Version"),style:{minWidth:"100px"},options:n,defaultValue:Number(s.current_version),onChange:c,value:a,"data-testid":"test-case-detail-version-select"})}),e.jsx(Tj,{testCase:s,onSubmit:d}),e.jsx(kj,{testCase:s}),s.source_archived?e.jsx(ql,{testCase:s,onSubmit:d}):e.jsx(D_,{testCase:s,onSubmit:d})]}),children:e.jsxs(e.Fragment,{children:[s&&!u&&e.jsx(gs,{showIcon:!0,closable:!0,type:"warning",description:e.jsxs("span",{children:[t("Attention! This isn't the latest version.")," ",e.jsx("a",{onClick:l,children:t("Restore")})]}),"data-testid":"test-case-detail-version-warning",style:{marginBottom:20}}),s&&e.jsxs(e.Fragment,{children:[e.jsx(Zl,{testCase:s}),e.jsx(cb,{testCase:s})]})]})})},gb="_link_1mu5e_1",xb="_list_1mu5e_13",Dr={link:gb,list:xb},fb=()=>{const{t}=T(),{testSuiteId:s,projectId:a}=Q(),n=ye(),[i,r]=nt(),o=z(In),c=z(Pa),l=z(mn("table")),d={page:l.page,page_size:l.page_size};sa({params:d,queryParamsSchema:$n,updateParams:C=>{const v=C;n(Rg({key:"table",pagination:{page:(v==null?void 0:v.page)??1,page_size:(v==null?void 0:v.page_size)??l.page_size}}))}});const u={project:a??"",suite:o.suites,is_archive:o.is_archive,labels:o.labels,not_labels:o.not_labels,labels_condition:o.labels_condition,page:l.page,page_size:l.page_size,ordering:c,search:o.name_or_id,show_descendants:!0,_n:o._n},{data:p,isFetching:m}=Rm({testSuiteId:Number(s),...u},{skip:!a||!s}),{data:g,isFetching:f}=Kg(u,{skip:!a||!!s}),x=s?p:g,y=s?m:f,j=C=>{i.set("test_case",String(C.id)),r(i),n(hs(C))},_=C=>{n(jl({key:"table",settings:{page:C.current,page_size:C.pageSize}}))},w=z(zi),b={hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:l.page,pageSize:l.page_size,total:(x==null?void 0:x.count)??0},S=h.useMemo(()=>[{title:t("ID"),dataIndex:"id",key:"id",width:"70px"},{title:t("Name"),dataIndex:"name",key:"name",render:(C,v)=>{const k=new URLSearchParams(location.search);return k.delete("test_case"),e.jsxs(ve,{id:v.name,to:`/projects/${v.project}/suites/${s??""}?test_case=${v.id}${k.size?`&${k.toString()}`:""}`,className:Dr.link,onClick:$=>{$.stopPropagation(),n(hs(v))},children:[v.is_archive&&e.jsx(wt,{}),e.jsx(Lt,{searchWords:o.name_or_id,textToHighlight:C})]})}},{title:t("Test Suite"),dataIndex:"suite_path",key:"suite_path"},{title:t("Labels"),dataIndex:"labels",key:"labels",render:C=>e.jsx("ul",{className:Dr.list,children:C.map(v=>e.jsx("li",{children:e.jsx(js,{content:v.name,color:Oe.accent})},v.id))})},{title:t("Estimate"),dataIndex:"estimate",key:"estimate",width:"100px",render:C=>C??"-"},{title:t("Created At"),dataIndex:"created_at",key:"created_at",width:150,render:C=>K(C).format("YYYY-MM-DD HH:mm")}].filter(C=>l.visibleColumns.some(v=>v.key===C.key)),[o,l,s]);return{data:x==null?void 0:x.results,columns:S,isLoading:y,selectedTestCase:w,paginationTable:b,handleTableChange:_,handleRowClick:j}},ac=h.memo(()=>{const{data:t,columns:s,isLoading:a,selectedTestCase:n,paginationTable:i,handleTableChange:r,handleRowClick:o}=fb();return e.jsx(ht,{loading:a,rowKey:"id",rowClassName:c=>c.id===(n==null?void 0:n.id)?"active":"",style:{cursor:"pointer"},columns:s,dataSource:t,size:"small",pagination:i,onChange:r,onRow:c=>({onClick:()=>o(c)})})});ac.displayName="TestCasesTable";const jb="_formBetween_h3g45_1",yb="_formLabel_h3g45_27",_b="_assigneeToMe_h3g45_43",Mr={formBetween:jb,formLabel:yb,assigneeToMe:_b},{FilterPlusIcon:bb}=Ce,vb=()=>{const{t}=T(),{project:s}=h.useContext(J),{testSuiteId:a}=Q(),n=ye(),i=z(In),r=z(Pa),o=z(ml),c=z(gl),[l,d]=h.useState(!1),[u,p]=h.useState(s.id),[m]=Nm(),{control:g,handleSubmit:f,getValues:x,setValue:y,reset:j,watch:_}=we({defaultValues:i}),w=_("is_archive");h.useEffect(()=>{j(i)},[i]);const b=E=>{n(wa(E))},S=E=>{n(Oi(E))},C=()=>{n(ei())};sa({params:{ordering:r},queryParamsSchema:ul,updateParams:E=>{n(ti(E.ordering))}}),sa({params:i,queryParamsSchema:pn,updateParams:b});const k=()=>{d(!0)},$=()=>{d(!1)},I=E=>{n(wa(E))},P=()=>{f(I)()},N=E=>{y("labels_condition",E),P()},A=E=>{y("labels",E.labels),y("not_labels",E.not_labels),y("labels_condition",E.labels.length+E.not_labels.length<2?void 0:E.labels_condition),P()},q=(E,D)=>{D.includes("_after")&&E===null?(y(D,void 0,{shouldDirty:!0}),y(D.replace("_after","_before"),void 0,{shouldDirty:!0})):y(D,E?E.format("YYYY-MM-DD"):void 0,{shouldDirty:!0}),P()},O=E=>{y("is_archive",E||void 0),P()},Y=()=>m({parent:a?Number(a):null,project:s.id},!0).unwrap(),ee=()=>m({project:s.id,parent:null},!0).unwrap(),U=E=>x(E)?K(x(E)):void 0;return h.useEffect(()=>{u!==s.id&&(n(ei()),n(Ag()),p(s.id))},[s.id]),e.jsxs(e.Fragment,{children:[e.jsxs(L,{id:"btn-filter-test-plan",icon:e.jsx(bb,{}),onClick:k,style:{gap:4,width:"fit-content"},children:[t("Filter")," ",!!c&&e.jsx(hi,{color:"var(--y-interactive-default)",count:c,"data-testid":"test-cases-button-filter-drawer-badge"})]}),e.jsx(Nn,{id:"tests-drawer-filter",title:e.jsx(Ul,{type:"suites",filterData:i,hasSomeFilter:!!c,filterSchema:pn,filterSettings:o,updateFilter:b,updateSettings:S,clearFilter:C}),onClose:$,isOpen:l,isLoading:!1,children:l&&e.jsxs(R,{onFinish:f(I),layout:"vertical",children:[e.jsx(R.Item,{label:t("Name or ID"),"data-testid":"test-cases-button-filter-drawer-name-or-id-container",children:e.jsx(F,{name:"name_or_id",control:g,render:({field:E})=>e.jsx(se,{...E,placeholder:t("Search"),onBlur:P,onKeyDown:D=>{D.key==="Enter"&&P()},onChange:D=>E.onChange(D.target.value),suffix:e.jsx(wn,{style:{color:"rgba(0,0,0,.45)"}}),allowClear:!0,"data-testid":"test-cases-button-filter-drawer-name-or-id-input"})})}),e.jsx(R.Item,{label:t("Test Suite"),"data-testid":"test-cases-button-filter-drawer-test-suite-container",children:e.jsx(F,{name:"suites",control:g,render:({field:E})=>e.jsx(ri,{getData:Y,getDataFromRoot:ee,type:"suites",value:E.value,onChange:D=>{E.onChange(D),P()},onClear:()=>{E.onChange([]),P()}})})}),e.jsx(R.Item,{className:Mr.formBetween,label:e.jsxs("div",{className:Mr.formLabel,children:[e.jsx("span",{children:t("Label")}),e.jsx(wl,{value:x("labels_condition")??"and",onChange:N,disabled:x("labels").length+x("not_labels").length<2})]}),"data-testid":"test-cases-button-filter-drawer-labels-container",children:e.jsx(F,{name:"labels",control:g,render:()=>e.jsx(Sl,{value:{labels:x("labels"),not_labels:x("not_labels"),labels_condition:x("labels_condition")??"and"},onChange:A})})}),e.jsx(R.Item,{label:t("Test Suite Created At"),style:{width:"100%"},children:e.jsxs(M,{gap:16,style:{width:"100%"},children:[e.jsx(vt,{onChange:E=>q(E,"test_suite_created_after"),style:{width:"100%"},size:"middle",value:U("test_suite_created_after"),disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,maxDate:U("test_suite_created_before"),allowClear:!0,"data-testid":"test-cases-button-filter-drawer-test-suite-created-at-after"}),e.jsx(vt,{onChange:E=>q(E,"test_suite_created_before"),style:{width:"100%"},size:"middle",value:U("test_suite_created_before"),showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,disabled:!x("test_suite_created_after"),minDate:U("test_suite_created_after"),allowClear:!0,"data-testid":"test-cases-button-filter-drawer-test-suite-created-at-before"})]})}),e.jsx(R.Item,{label:t("Test Case Created At"),style:{width:"100%"},children:e.jsxs(M,{gap:16,style:{width:"100%"},children:[e.jsx(vt,{onChange:E=>q(E,"test_case_created_after"),style:{width:"100%"},size:"middle",value:U("test_case_created_after"),disabled:!1,showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,maxDate:U("test_case_created_before"),allowClear:!0,"data-testid":"test-cases-button-filter-drawer-test-case-created-at-after"}),e.jsx(vt,{onChange:E=>q(E,"test_case_created_before"),style:{width:"100%"},size:"middle",value:U("test_case_created_before"),showTime:!1,format:"YYYY-MM-DD",picker:"date",placeholder:"YYYY-MM-DD",needConfirm:!1,disabled:!x("test_case_created_after"),minDate:U("test_case_created_after"),allowClear:!0,"data-testid":"test-cases-button-filter-drawer-test-case-created-at-before"})]})}),e.jsx(R.Item,{children:e.jsx(F,{name:"is_archive",control:g,render:()=>e.jsx(Qt,{id:"archive-toggle",label:t("Show Archived"),labelFontSize:14,checked:w,onChange:O,size:"lg"})})})]})})]})},Sb=()=>{var c,l;const{project:t}=h.useContext(J),{userConfig:s}=h.useContext(Pe),a=ye(),n=z(ml),i=(l=(c=s==null?void 0:s.test_suites)==null?void 0:c.filters)==null?void 0:l[t.id],r=d=>{const u=i==null?void 0:i[d],p=yt(pn,{url:u});a(Oi({selected:d})),a(wa(p))},o=h.useMemo(()=>i?Object.keys(i):[],[s]);return o.length?e.jsx(M,{align:"center",children:e.jsx(Vl,{options:o,value:n.selected,onChange:r})}):null},{SorterIcon:wb}=Ce,Cb=()=>{const{t}=T(),s=[{value:"id",label:t("ID")},{value:"name",label:t("Name")},{value:"created_at",label:t("Created At")}],a=ye(),n=z(Pa),i=n.replace("-","")??s[1].value,r=n.startsWith("-")?"desc":"asc",o=l=>{a(ti(`${r==="desc"?`-${l}`:l}`))},c=l=>{a(ti(`${l==="desc"?`-${i}`:i}`))};return e.jsx(le,{title:t("Sort"),children:e.jsx(Ms,{content:e.jsxs(M,{gap:8,vertical:!0,style:{minWidth:200},children:[e.jsx(je,{orientation:"left",style:{margin:0},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary",children:t("Sort by")})}),e.jsx(jt.Group,{onChange:l=>{o(l.target.value)},value:i??s[1].value,defaultValue:s[1].value,"data-testid":"test-cases-sort-by",children:e.jsx(ce,{direction:"vertical",children:s.map((l,d)=>e.jsx(jt,{value:l.value,"data-testid":`test-cases-sort-by-${l.value}`,children:l.label},d))})}),e.jsx(je,{orientation:"left",style:{margin:"4px 0"},orientationMargin:0,children:e.jsx(G.Text,{type:"secondary",children:t("Order by")})}),e.jsx(jt.Group,{onChange:l=>{c(l.target.value)},value:r,"data-testid":"test-cases-order-by",children:e.jsxs(ce,{direction:"vertical",children:[e.jsx(jt,{value:"asc","data-testid":"test-cases-order-by-asc",children:t("Ascending")}),e.jsx(jt,{value:"desc","data-testid":"test-cases-order-by-desc",children:t("Descending")})]})})]}),arrow:!1,trigger:"click",placement:"bottom","data-testid":"test-cases-sorter-popover",children:e.jsx(L,{style:{minWidth:32},icon:e.jsx(wb,{color:"var(--y-sky-60)"}),"data-testid":"test-cases-sorter"})})})},nc=h.memo(({dataView:t,setDataView:s,suite:a})=>{const{t:n}=T(),{testCasesTree:i}=h.useContext(Da),r=ye(),o=z(mn("table")),c=z(mn("tree")),l=z(gl),d=t==="list",u=d?o.visibleColumns:c.visibleColumns,p=d?o.columns:c.columns,m=f=>{const x=d?"table":"tree";r(jl({key:x,settings:{visibleColumns:f}})),Lo(`test-cases-visible-cols-${x}`,f)},g=()=>{r(Oi({selected:null})),r(ei())};return e.jsxs(M,{justify:"space-between",align:"center",style:{width:"100%",marginBottom:24},children:[e.jsxs(M,{gap:16,wrap:!0,children:[e.jsx(G.Title,{level:2,style:{marginBottom:0,alignSelf:"center",textWrap:"nowrap"},children:n("Test Cases")}),!!a&&e.jsx(Ol,{})]}),e.jsxs(M,{gap:8,wrap:!0,justify:"flex-end",align:"center",children:[e.jsxs(M,{gap:8,align:"center",children:[e.jsx(Hl,{isVisible:!!l,onClear:g}),e.jsx(vb,{}),e.jsx(Sb,{}),e.jsx(Cb,{})]}),!d&&e.jsx(le,{title:n("Collapse All"),children:e.jsx(L,{icon:e.jsx(Hi,{width:18,height:18,color:"var(--y-sky-60)"}),onClick:()=>{var f;return(f=i.current)==null?void 0:f.closeAll()},"data-testid":"test-cases-collapse-all-btn"})}),e.jsx(tc,{id:d?"test-cases-table-setting-columns-btn":"test-cases-tree-setting-columns-btn",columns:p,visibilityColumns:u,onChange:m}),e.jsx(je,{type:"vertical",style:{height:"1.5em"}}),e.jsx(xc,{value:t,onChange:s})]})]})});nc.displayName="TestSuiteDataActions";const Tb="_title_1s529_1",kb="_infoTitle_1s529_13",Ib="_infoValue_1s529_27",qn={title:Tb,infoTitle:kb,infoValue:Ib},$b=()=>e.jsxs(M,{vertical:!0,children:[e.jsx(fe,{width:"30%",height:28,style:{marginBottom:4}}),e.jsxs(M,{gap:96,style:{marginBottom:12},children:[e.jsxs(M,{gap:16,children:[e.jsx(fe,{width:100,height:16}),e.jsx(fe,{width:100,height:16})]}),e.jsxs(M,{gap:16,children:[e.jsx(fe,{width:100,height:16}),e.jsx(fe,{width:100,height:16})]})]}),e.jsxs(M,{gap:8,wrap:!0,style:{marginBottom:8},children:[e.jsx(fe,{width:200,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:85,height:32}),e.jsx(fe,{width:100,height:32})]})]}),Lb=()=>{const{t}=T(),{testSuiteId:s}=Q(),{treebar:a}=h.useContext(Us),{testCasesTree:n}=h.useContext(Da),{suite:i,isFetching:r}=Pn(),o=async l=>{var u,p;const d=((u=l==null?void 0:l.parent)==null?void 0:u.id)??null;await((p=n.current)==null?void 0:p.refetchNodeBy(m=>m.id===d&&!m.props.isLeaf)),a.current&&await Aa(a.current,l)},c=async l=>{var u,p;const d=((u=l==null?void 0:l.parent)==null?void 0:u.id)??null;await((p=n.current)==null?void 0:p.refetchNodeBy(m=>m.id===d&&!m.props.isLeaf)),a.current&&await Di(a.current,l)};return s?!i||r?e.jsx($b,{}):e.jsxs(e.Fragment,{children:[e.jsx(M,{gap:8,children:e.jsx(G.Title,{id:"test-suite-title",level:2,className:qn.title,children:i.name})}),e.jsx(M,{style:{marginBottom:12},vertical:!0,gap:16,children:e.jsx(M,{children:i.created_at&&e.jsxs(G.Text,{className:qn.infoTitle,children:[t("Created At")," ",e.jsx(G.Text,{className:qn.infoValue,children:K(i.created_at).format("YYYY-MM-DD")})]})})}),e.jsxs(M,{wrap:!0,gap:8,style:{marginBottom:8},children:[e.jsx(ea,{suite:i,type:"create"}),e.jsx(Ai,{suite:i,onSubmit:o}),e.jsx(ea,{suite:i,type:"edit"}),e.jsx(Pi,{suite:i,onSubmit:c})]})]}):null},Ab="_wrapper_pb2ag_1",Pb="_avatarBlock_pb2ag_15",Nb="_editBlock_pb2ag_35",Rb="_wrapperBtns_pb2ag_51",Db="_btns_pb2ag_67",Mb="_imageView_pb2ag_97",Ts={wrapper:Ab,avatarBlock:Pb,editBlock:Nb,wrapperBtns:Rb,btns:Db,imageView:Mb},Fr=new li,Fb=()=>{const{t}=T(),{me:s}=h.useContext(Pe),[a,n]=h.useState(1),[i,r]=h.useState(!1),[o,c]=h.useState({url:"",file:null}),[l,d]=h.useState(!1),[u]=zu(),[p]=Uu(),[m,g]=h.useState({unit:"%",x:25,y:25,width:50,height:50}),f=async b=>{if(!b.file.originFileObj)return;const S=await vi(b.file);c({url:S.url??"",file:S.file??null}),r(!0)},x=b=>{const S=b.type==="image/png"||b.type==="image/jpeg";return S||H.error({message:t("Error!"),description:`${b.name} is not a png or jpg file`}),S||Ji.LIST_IGNORE},y=(b,S)=>{g(S)},j=()=>{c({url:"",file:null})},_=()=>{p()},w=async()=>{if(d(!0),!o.file)return;const b={left:Hs(m.x/100,6),right:Hs(m.width/100,6),lower:Hs(m.height/100,6),upper:Hs(m.y/100,6)},S={left:b.left,right:Hs(b.left+b.right,6),lower:Hs(b.lower+b.upper,6),upper:b.upper},C=new FormData;C.append("avatar",o.file),C.append("crop",JSON.stringify(S)),await Fr.waitForUnlock();const v=await Fr.acquire();try{await u(C).unwrap(),H.success({message:t("Success"),closable:!0,description:t("Avatar was updated successfully")}),n(a+1)}catch(k){const $=k;console.error($),H.error({message:t("Error!"),description:`${$.data.errors[0]}. ${t("Showing detail in console log.")}`})}finally{v(),d(!1),r(!1)}};return i&&o.url?e.jsxs("div",{className:Ts.editBlock,children:[e.jsx(Id,{crop:m,onChange:y,aspect:1,circularCrop:!0,disabled:!1,minHeight:10,minWidth:10,keepSelection:!0,children:e.jsx("img",{id:"profile-avatar-crop-image",src:o.url})}),e.jsxs("div",{className:Ts.btns,children:[e.jsx(L,{onClick:j,id:"profile-avatar-edit-button",children:t("Edit")}),e.jsx(L,{type:"primary",onClick:w,loading:l,id:"profile-avatar-save-button",children:t("Save")})]})]}):e.jsxs("div",{className:Ts.wrapper,children:[e.jsx("div",{className:Ts.avatarBlock,children:s&&e.jsx("div",{className:Ts.imageView,children:e.jsx(Ut,{avatar_link:s.avatar_link,size:180,nonce:a})})}),e.jsx("div",{className:Ts.wrapperBtns,children:e.jsxs("div",{className:Ts.btns,children:[e.jsx(Ji,{name:"avatar",showUploadList:!1,onChange:f,style:{width:180},customRequest:()=>{},beforeUpload:x,id:"profile-avatar-upload",children:e.jsx(L,{id:"profile-avatar-edit-button",children:t("Edit")})}),(s==null?void 0:s.avatar_link)&&e.jsx(L,{danger:!0,onClick:_,id:"profile-avatar-delete-button",children:t("Delete")})]})})]})},Eb={messages:[],hiddenMessageIds:[],theme:"light"},ic=Pt({name:"system",initialState:Eb,reducers:{setMessages:(t,s)=>{t.messages=s.payload},addHiddenMessageId:(t,s)=>{t.hiddenMessageIds=(t.hiddenMessageIds??[]).concat(s.payload)},setTheme:(t,s)=>{t.theme=s.payload,localStorage.setItem("theme",s.payload)}}}),{setMessages:JI,addHiddenMessageId:Bb,setTheme:ZI}=ic.actions,Ob=t=>t.system.hiddenMessageIds,qb=ic.reducer,Er={0:"info",1:"warning",2:"error"},rc=()=>{const t=ye(),s=z(Ob),{data:a,isLoading:n}=Bh(),i=o=>{t(Bb(o))},r=h.useMemo(()=>a?s.length?a.filter(o=>!s.includes(o.id)):a:[],[a]);return n||!(a!=null&&a.length)?null:e.jsx("div",{className:"wrapper-system-messages",children:r.map(o=>e.jsx("div",{className:"system-message",children:e.jsx(gs,{message:o.content,type:Er[o.level],showIcon:!0,closable:o.is_closing,className:`system-alert-type-${Er[o.level]}`,onClose:()=>i(o.id)})},o.id))})},ga="notifications",_n=Je.createApi({reducerPath:"notificationApi",baseQuery:pt,tagTypes:["Notification","NotificationSettings"],endpoints:t=>({getNotificationSettings:t.query({query:()=>`${ga}/settings/`,providesTags:s=>$t(s,"NotificationSettings")}),enableNotification:t.mutation({query:({settings:s})=>({url:`${ga}/enable/`,method:"POST",body:{settings:s}}),invalidatesTags:["NotificationSettings"]}),disableNotification:t.mutation({query:({settings:s})=>({url:`${ga}/disable/`,method:"POST",body:{settings:s}}),invalidatesTags:["NotificationSettings"]}),getNotificationsList:t.query({query:s=>({url:`${ga}/`,params:s}),providesTags:()=>[{type:"Notification",id:"LIST"}]}),markAs:t.mutation({query:s=>({url:`${ga}/mark-as/`,method:"POST",body:{...s}}),invalidatesTags:()=>[{type:"Notification",id:"LIST"}]})})}),{useGetNotificationSettingsQuery:zb,useEnableNotificationMutation:Ub,useDisableNotificationMutation:Vb,useGetNotificationsListQuery:XI,useLazyGetNotificationsListQuery:Hb,useMarkAsMutation:Yb}=_n,Wb=()=>{const{t}=T(),{data:s,isFetching:a}=zb(),[n]=Ub(),[i]=Vb(),[r,o]=h.useState(!1),c=async(d,u)=>{const p={settings:[d]};try{o(!0),u?await n(p):await i(p)}catch(m){Se(m)}finally{o(!1)}},l=[{title:t("Name"),dataIndex:"verbose_name",key:"name"},{width:100,title:t("Enabled"),dataIndex:"enabled",key:"enabled",render:(d,u)=>e.jsx(Wt,{checked:d,onChange:p=>c(u.action_code,p)})}];return e.jsx(ht,{loading:a||r,dataSource:s,columns:l,rowKey:"action_code",style:{marginTop:12},id:"administration-projects-labels",rowClassName:"administration-projects-labels-row",pagination:!1})},Qb="_readRow_tbqhm_1",Gb="_unreadRow_tbqhm_9",Kb="_linkRow_tbqhm_17",ni={readRow:Qb,unreadRow:Gb,linkRow:Kb},Jb="{{placeholder}}",Zb=t=>{const{template:s,placeholder_link:a,placeholder_text:n}=t,i=s.split(Jb),r=o=>!!o.length&&e.jsx("p",{style:{margin:0},children:o});return e.jsxs("span",{className:ni.linkRow,children:[r(i[0]),e.jsx(ve,{to:a,children:n}),r(i[1])]})},Xb=()=>{const{t}=T(),[s,a]=h.useState(!1),[n,i]=h.useState([]),[r,o]=h.useState({current:1,pageSize:10}),[c]=Hb(),[l,d]=h.useState([]),[u]=Yb(),p=[{title:t("ID"),dataIndex:"id",key:"id",width:"70px"},{title:t("Message"),dataIndex:"message",key:"message",render:j=>j?Zb(j):null},{title:t("Actor"),dataIndex:"actor",key:"actor"},{title:t("Time"),dataIndex:"timeago",key:"timeago"}],m=async({force:j=!1,paginationData:_=r})=>{var w,b;a(!0);try{const S=await c({page:_.current,page_size:_.pageSize,v:j?Date.now():void 0},!1);i(((w=S==null?void 0:S.data)==null?void 0:w.results)??[]),o({..._,total:(b=S==null?void 0:S.data)==null?void 0:b.count})}catch(S){Se(S)}finally{a(!1)}};return h.useEffect(()=>{m({})},[]),{isLoading:s,data:n,pagination:r,columns:p,handleChange:j=>{m({paginationData:j})},handleSelectRows:j=>{d(j)},handleRead:async()=>{try{await u({unread:!1,notifications:l.map(j=>Number(j))}),m({force:!0}),d([])}catch(j){Se(j)}},handleUnread:async()=>{try{await u({unread:!0,notifications:l.map(j=>Number(j))}),m({force:!0}),d([])}catch(j){Se(j)}},selectedRowKeys:l}},ev=()=>{const{t}=T(),{isLoading:s,data:a,pagination:n,selectedRowKeys:i,columns:r,handleChange:o,handleSelectRows:c,handleRead:l,handleUnread:d}=Xb();return e.jsxs(e.Fragment,{children:[!!i.length&&e.jsxs("div",{children:[e.jsx(L,{onClick:l,icon:e.jsx($d,{}),disabled:!i.length,children:t("Mark as read")},"mark-as-read"),e.jsx(L,{onClick:d,icon:e.jsx(Ld,{}),disabled:!i.length,style:{marginLeft:8},children:t("Mark as unread")},"mark-as-unread")]}),e.jsx(ht,{loading:s,dataSource:a,columns:r,rowKey:"id",style:{marginTop:12},id:"notifications-table",rowClassName:u=>u.unread?ni.unreadRow:ni.readRow,pagination:n,onChange:o,rowSelection:{type:"checkbox",onChange:c,selectedRowKeys:i}})]})},{Content:tv}=es,An=h.createContext(null),sv=()=>{const[t,s]=h.useState(""),[a,n]=h.useState("");return e.jsxs(An.Provider,{value:{activeTab:t,setActiveTab:s,setTitle:n},children:[e.jsx(ka,{title:a,ghost:!1,footer:e.jsx(av,{}),style:{paddingBottom:0}}),e.jsx(tv,{style:{margin:"24px"},children:e.jsx(xs,{})})]})},av=()=>{const{t}=T(),s=De(),{activeTab:a,setActiveTab:n}=h.useContext(An),i=[{label:t("Overview"),key:"overview",path:"/notifications"},{label:t("Settings"),key:"settings",path:"/notifications/settings"}],r=o=>{const c=i.find(l=>l.key===o);c&&(s(c.path),n(o))};return e.jsx(dt,{activeKey:a,items:i,onChange:r})},nv=t=>{switch(t){case 0:return"System";case 1:return"Custom";default:return"None"}},Yi=({data:t})=>{const{t:s}=T(),{title:a,isShow:n,mode:i,isLoading:r,errors:o,control:c,isDirty:l,handleCancel:d,handleSubmitForm:u}=t;return e.jsx(he,{className:"create-edit-status-modal",title:a,open:n,onCancel:d,width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-update-create-status",onClick:d,children:s("Close")},"back"),e.jsx(L,{id:"update-create-status",loading:r,onClick:u,type:"primary",disabled:!l,children:s(i==="edit"?"Update":"Create")},"submit")],children:e.jsxs(e.Fragment,{children:[o?e.jsx(it,{error:o,skipFields:["name"]}):null,e.jsxs(R,{layout:"vertical",onFinish:u,"data-testid":`${i}-status-form`,children:[e.jsx(R.Item,{label:s("Name"),validateStatus:o!=null&&o.name?"error":"",help:o!=null&&o.name?o.name:"",children:e.jsx(F,{name:"name",control:c,render:({field:p})=>e.jsx(se,{...p,"data-testid":`${i}-status-name`})})}),e.jsx(R.Item,{label:s("Color"),validateStatus:o!=null&&o.color?"error":"",help:o!=null&&o.color?o.color:"",children:e.jsx(F,{name:"color",control:c,render:({field:p})=>e.jsx(Ad,{value:p.value,showText:!0,format:"rgb",onChangeComplete:m=>{p.onChange(m.toRgbString())},"data-testid":`${i}-status-color-picker-button`})})})]})]})})},oc=0,lc=1,iv={[oc]:"System",[lc]:"Custom"};Object.entries(iv).map(([t,s])=>({value:Number(t),label:s}));const Wi=()=>{const{t}=T(),{projectId:s}=Q(),[a,{isLoading:n}]=kp(),[i,{isLoading:r}]=Ip(),[o]=$p(),[c,l]=h.useState(!1),[d,u]=h.useState(void 0),[p,m]=h.useState("edit"),g={isShow:c,mode:p,status:d},[f,x]=h.useState(null),{onHandleError:y}=We(x),{handleSubmit:j,reset:_,control:w,setValue:b,formState:{isDirty:S}}=we({defaultValues:{name:"",type:lc,color:"#000"}}),C=({mode:A,status:q})=>{l(!0),m(A),u(q)},v=()=>{l(!1),u(void 0)},k=async A=>{x(null);try{g.mode==="edit"&&g.status&&s?await i({id:Number(g.status.id),body:A}).unwrap():await a({...A,project:Number(s)}).unwrap(),H.success({message:t("Success"),description:g.mode==="edit"?t("Status updated successfully"):t("Status created successfully")}),I()}catch(q){y(q)}},$=A=>{he.confirm({title:t("Do you want to delete these status?"),okText:t("Delete"),cancelText:t("Cancel"),onOk:async()=>{try{await o(A).unwrap(),H.success({message:t("Success"),description:t("Status deleted successfully")})}catch(q){Se(q)}},okButtonProps:{"data-testid":"delete-status-button-confirm"},cancelButtonProps:{"data-testid":"delete-status-button-cancel"}})},I=()=>{x(null),_(),v()},P=()=>{(!n||!r)&&I()},N=h.useMemo(()=>{var A;return g.mode==="edit"?`${t("Edit status")} ${(A=g.status)==null?void 0:A.name}`:t("Create status")},[g]);return h.useEffect(()=>{!g.isShow||g.mode!=="edit"||!g.status||(b("name",g.status.name),b("type",g.status.type),b("color",g.status.color))},[g.isShow]),{title:N,isShow:g.isShow,mode:g.mode,control:w,errors:f,isLoading:n||r,isDirty:S,handleCancel:P,handleDeleteStatus:$,handleSubmitForm:j(k),handleModalOpen:C}},rv=({record:t,onDisableTable:s})=>{const a=Wi();return h.useEffect(()=>{s==null||s(a.isShow)},[a.isShow]),e.jsxs(e.Fragment,{children:[e.jsx(L,{id:`${t.name}-edit`,icon:e.jsx(Ke,{}),shape:"circle",onClick:()=>a.handleModalOpen({status:t,mode:"edit"})}),a.isShow&&e.jsx(Yi,{data:a})]})},ov=({record:t})=>{const s=Wi();return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:`${t.name}-delete`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:()=>s.handleDeleteStatus(Number(t.id))}),s.isShow&&e.jsx(Yi,{data:s})]})},lv=()=>{const{t}=T(),s=Wi(),a=()=>{s.handleModalOpen({mode:"create"})};return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"create-status",type:"primary",icon:e.jsx(ct,{}),onClick:a,style:{marginBottom:16,float:"right"},children:t("Create status")}),s.isShow&&e.jsx(Yi,{data:s})]})},cv=({record:t})=>{const{projectId:s}=Q(),{data:a,isLoading:n}=$i(Number(s),{skip:!s}),[i,{isLoading:r}]=Li(),o=(a==null?void 0:a.settings.default_status)===t.id,c=async()=>{if(!a)return;const l=o?null:t.id;try{await i({id:a.id,body:{settings:{...a.settings,default_status:l}}}).unwrap(),l?H.success({message:`Default status updated to ${t.name}`}):H.success({message:"Default status removed"})}catch(d){console.error("Failed to update default status:",d),H.error({message:"Failed to update default status"})}};return e.jsx(le,{title:"Set as default status for the project",children:e.jsx(Wt,{id:`${t.name}-set-default`,checked:o,onChange:c,loading:n||r})})},dv=t=>{const{attributes:s,listeners:a,setNodeRef:n,transform:i,transition:r,isDragging:o}=Ed({id:t["data-row-key"]}),c={...t.style,transform:Bd.Translate.toString(i),transition:r,cursor:"move",...o?{position:"relative",zIndex:9999}:{}};return e.jsx("tr",{...t,ref:n,style:c,...s,...a})},uv=({onChangeOrder:t})=>{const[s,a]=h.useState(!1),{project:n}=h.useContext(J),{data:i,isFetching:r}=Cp({project:n.id}),o=(i==null?void 0:i.map(m=>({key:m.id,...m})))??[],[c,l]=h.useState(o);h.useEffect(()=>{l(o)},[i]),h.useEffect(()=>{const m=(i==null?void 0:i.map(x=>x.id))??[],g=c.map(x=>x.id);m.every((x,y)=>x===g[y])||t(c)},[c]);const d=[{title:"Id",dataIndex:"id",key:"id",width:"70px"},{title:"Name",dataIndex:"name",key:"name",render:(m,g)=>e.jsx(Rt,{id:g.id,name:m,color:g.color})},{title:"Type",dataIndex:"type",key:"type",render:(m,g)=>nv(g.type)},{title:"Default",dataIndex:"default",key:"default",render:(m,g)=>e.jsx(cv,{record:g})},{title:"Actions",key:"action",width:100,render:(m,g)=>g.type===oc?null:e.jsxs(ce,{children:[e.jsx(rv,{record:g,onDisableTable:a}),e.jsx(ov,{record:g})]})}],u=Pd(Nd(Od,{activationConstraint:{distance:1}})),p=({active:m,over:g})=>{(m==null?void 0:m.id)!==(g==null?void 0:g.id)&&l(f=>{const x=f.findIndex(j=>j.key===m.id),y=f.findIndex(j=>j.key===(g==null?void 0:g.id));return qd(f,x,y)})};return e.jsx(Rd,{sensors:u,modifiers:[Dd],onDragEnd:p,children:e.jsx(Md,{items:c.map(m=>m.key),strategy:Fd,disabled:s,children:e.jsx(ht,{components:{body:{row:dv}},loading:r,dataSource:c,columns:d,rowKey:"id",style:{marginTop:12},id:"administration-projects-statuses",rowClassName:"administration-projects-statuses-row",pagination:!1})})})},cc=vn.createContext(null),hv=["overview","activity","custom-attributes","attachments"],pv=()=>{var g;const{t}=T(),s=Dl(),{testPlanId:a}=Q(),{userConfig:n}=h.useContext(Pe),i=De(),r=Nt(),[o,c]=h.useState("overview"),{data:l,isFetching:d,refetch:u}=Gh({testPlanId:a??"",is_archive:(g=n==null?void 0:n.test_plans)==null?void 0:g.is_show_archived,project:s.id,parent:null},{skip:!a});h.useEffect(()=>{const f=r.pathname.split("/"),x=f[f.length-1];c(hv.includes(x)?x:"overview")},[r.pathname]);const p=f=>{if(c(f),f==="overview"){i(`/projects/${s.id}/plans/${a}`);return}i(`/projects/${s.id}/plans/${a}/${f}`)},m=[{key:"overview",label:t("Overview")},{key:"activity",label:t("Activity")},{key:"custom-attributes",label:t("Custom Attributes")}];return e.jsx(cc.Provider,{value:{testPlan:l,isFetching:d,refetch:u,hasTestPlan:!!a&&!!l},children:e.jsxs(o_,{children:[e.jsx(P_,{}),a&&e.jsx(dt,{defaultActiveKey:"overview",activeKey:o,items:m,onChange:p,style:{marginBottom:24}}),e.jsx(xs,{})]})})},Ma=()=>h.useContext(cc),mv="_collapseTitle_9bo27_1",Br={collapseTitle:mv},Or=()=>{const{t}=T(),[s,a]=Es("test-plan-detail-tests-view","tree"),{testPlan:n,hasTestPlan:i}=Ma();return e.jsxs(M,{vertical:!0,style:{width:"100%"},children:[i&&(n==null?void 0:n.description)&&e.jsxs(e.Fragment,{children:[e.jsx(ii,{cacheKey:"test-plan-description",defaultCollapse:!1,title:e.jsx("span",{className:Br.collapseTitle,children:t("Description")}),"data-testid":"test-plan-description-collapse",children:e.jsx("div",{"data-testid":"test-plan-description",children:e.jsx(At,{content:n.description})})}),e.jsx(je,{})]}),e.jsx(ii,{cacheKey:"test-plan-statistic",defaultCollapse:!0,title:e.jsx("span",{"data-testid":"test-plan-statistic-title",className:Br.collapseTitle,children:t("Statistic")}),children:e.jsx(zl,{testPlanId:n==null?void 0:n.id})}),e.jsx(je,{}),e.jsx(ec,{testPlanId:n==null?void 0:n.id,dataView:s,setDataView:a}),s==="list"&&e.jsx(Xl,{testPlanId:n==null?void 0:n.id}),s==="tree"&&e.jsx(l_,{testPlanId:n==null?void 0:n.id}),e.jsx(u_,{})]})},gv=()=>{const t=Bx(),{testPlanId:s,projectId:a}=Q(),{testPlan:n,isFetching:i}=Ma();return i||!n||!a||!s?e.jsx(zt,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ox,{testPlanActivity:t}),e.jsx(qx,{testPlanActivity:t})]})},xv=()=>{const{t}=T(),{testPlan:s}=Ma();return!s||!Object.keys(s.attributes).length?e.jsx("p",{children:t("No custom attributes")}):e.jsx(M,{vertical:!0,children:Object.entries(s.attributes).map(([a,n],i)=>e.jsx(il,{title:a,value:n,isRequired:!1},i))})},fv=()=>{const{testPlan:t}=Ma();return e.jsx(mt.List,{attachments:(t==null?void 0:t.attachments)??[]})},dc=vn.createContext(null),jv=["overview","custom-attributes","attachments"],yv=()=>{const{t}=T(),s=Dl(),{testSuiteId:a}=Q(),n=De(),i=Nt(),[r,o]=h.useState("overview"),{data:c,isFetching:l,refetch:d}=Cm({suiteId:a??""},{skip:!a});h.useEffect(()=>{const m=i.pathname.split("/"),g=m[m.length-1];o(jv.includes(g)?g:"overview")},[i.pathname]);const u=m=>{if(o(m),m==="overview"){n(`/projects/${s.id}/suites/${a}`);return}n(`/projects/${s.id}/suites/${a}/${m}`)},p=[{key:"overview",label:t("Overview")},{key:"custom-attributes",label:t("Custom Attributes")}];return e.jsx(dc.Provider,{value:{suite:c,isFetching:l,refetch:d,hasTestSuite:!!a&&!!c},children:e.jsxs(ub,{children:[e.jsx(Lb,{}),a&&e.jsx(dt,{defaultActiveKey:"overview",activeKey:r,items:p,onChange:u,style:{marginBottom:24}}),e.jsx(xs,{})]})})},Pn=()=>h.useContext(dc),_v="_collapseTitle_9bo27_1",bv={collapseTitle:_v},qr=()=>{const{t}=T(),[s,a]=Es("test-suite-detail-test-cases-view","tree"),{suite:n,hasTestSuite:i}=Pn();return e.jsxs(M,{vertical:!0,style:{width:"100%"},children:[i&&(n==null?void 0:n.description)&&e.jsxs(e.Fragment,{children:[e.jsx(ii,{cacheKey:"test-suite-description",defaultCollapse:!1,title:e.jsx("span",{className:bv.collapseTitle,children:t("Description")}),"data-testid":"test-suite-description-collapse",children:e.jsx("div",{"data-testid":"test-suite-description",children:e.jsx(At,{content:n.description})})}),e.jsx(je,{})]}),e.jsx(nc,{dataView:s,setDataView:a,suite:n}),s==="list"&&e.jsx(ac,{}),s==="tree"&&e.jsx(hb,{}),e.jsx(mb,{})]})},vv=()=>{const{t}=T(),{suite:s}=Pn();return!s||!Object.keys(s.attributes).length?e.jsx("p",{children:t("No custom attributes")}):e.jsx(M,{vertical:!0,children:Object.entries(s.attributes).map(([a,n],i)=>e.jsx(il,{title:a,value:n,isRequired:!1},i))})},Sv=()=>{const{suite:t}=Pn();return e.jsx(mt.List,{attachments:(t==null?void 0:t.attachments)??[]})},wv=t=>{const a=t.split(" ").filter(Boolean);return a.length<2?t.charAt(0).toUpperCase():a.map(n=>Array.from(n)[0].toUpperCase()).slice(0,3).join("")},ca=({icon:t,name:s,size:a=40,dataTestId:n="project-icon"})=>e.jsx(xo,{style:{verticalAlign:"middle",width:a,height:a,fontSize:a/2.7,lineHeight:`${a}px`,userSelect:"none",marginRight:12},size:"large",src:t!=null&&t.length?t:void 0,"data-testid":n,children:!t&&wv(s)}),Cv=({isShow:t,setIsShow:s,project:a})=>{const{t:n}=T(),i=De(),[r,{isLoading:o}]=fp(),{data:c,isLoading:l,status:d}=yp(String(a.id),{skip:!t}),u=()=>{s(!1)},p=async()=>{try{await r(Number(a.id)).unwrap(),H.success({message:n("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"deleted",title:"Project"})})}catch(m){Se(m)}i("/administration/projects"),u()};return e.jsx(Bs,{status:d,isShow:t,isLoading:l,isLoadingButton:o,name:a.name,typeTitle:n("Project"),type:"project",data:c??[],handleClose:u,handleDelete:p,action:"delete"})},uc=({project:t})=>{const{t:s}=T(),[a,n]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"delete-project",icon:e.jsx(ut,{}),danger:!0,onClick:()=>n(!0),children:s("Delete")}),e.jsx(Cv,{isShow:a,setIsShow:n,project:t})]})},Tv=({isShow:t,setIsShow:s,project:a})=>{const{t:n}=T(),[i,{isLoading:r}]=_p(),{data:o,isLoading:c,status:l}=bp(String(a.id),{skip:!t}),d=()=>{s(!1)},u=async()=>{try{await i(Number(a.id)),H.success({message:n("Success"),closable:!0,description:e.jsx(Re,{id:String(a.id),action:"archived",title:"Project"})})}catch(p){Se(p)}d()};return e.jsx(Bs,{status:l,isShow:t,isLoading:c,isLoadingButton:r,name:a.name,typeTitle:n("Project"),type:"project",data:o??[],handleClose:d,handleDelete:u,action:"archive"})},kv=({project:t})=>{const{t:s}=T(),[a,n]=h.useState(!1),i=[{key:"1",label:e.jsx(uc,{project:t})}];return e.jsxs(e.Fragment,{children:[e.jsx(Sn.Button,{className:"archive-project",menu:{items:i},danger:!0,onClick:()=>n(!0),children:s("Archive")}),e.jsx(Tv,{isShow:a,setIsShow:n,project:t})]})},{TextArea:Iv}=se,$v=({isShow:t,setIsShow:s})=>{const{t:a}=T(),{showModal:n}=Ot(),[i,r]=h.useState(null),{handleSubmit:o,reset:c,control:l,setValue:d,watch:u,formState:{isDirty:p}}=we({defaultValues:{name:"",description:"",icon:"",is_archive:!1,is_private:!1}}),[m,{isLoading:g}]=gp(),{onHandleError:f}=We(r),[x,y]=h.useState(null),j=u("name"),_=u("is_private"),w=async $=>{r(null);try{const I=new FormData;I.append("name",$.name),I.append("description",$.description),I.append("is_archive",String($.is_archive)),I.append("icon",$.icon??""),I.append("is_private",String($.is_private));const P=await m(I).unwrap();b(),H.success({message:a("Success"),closable:!0,description:e.jsx(Re,{action:"created",title:"Project",link:`/administration/projects/${P.id}/overview/`,id:String(P.id)})})}catch(I){f(I)}},b=()=>{s(!1),r(null),y(null),c()},S=()=>{if(!g){if(p){n(b);return}b()}},C=async $=>{if(!$.file.originFileObj)return;const I=await vi($.file);y(I.url),d("icon",I.file,{shouldDirty:!0,shouldTouch:!0})},v=$=>{const I=$.type==="image/png"||$.type==="image/jpeg";return I||H.error({message:a("Error!"),description:`${$.name} ${a("is not a png or jpg file")}`}),I||Ns.LIST_IGNORE},k=()=>{y(null),d("icon","",{shouldDirty:!0,shouldTouch:!0})};return e.jsx(he,{className:"create-project-modal",title:`${a("Create")} ${a("Project")}`,open:t,onCancel:S,width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-create-project",onClick:S,children:a("Close")},"back"),e.jsx(L,{id:"create-project",loading:g,onClick:o(w),type:"primary",disabled:!p,children:a("Create")},"submit")],children:e.jsxs(e.Fragment,{children:[i?e.jsx(it,{error:i,skipFields:["name","description","is_archive","is_private"]}):null,e.jsxs(R,{id:"create-edit-project-form",layout:"vertical",onFinish:o(w),children:[e.jsx(R.Item,{label:a("Icon"),children:e.jsx(F,{name:"icon",control:l,render:()=>e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:14},children:[e.jsx(ca,{name:j||"T",icon:x,dataTestId:"create-project-icon"}),e.jsx(Ns,{name:"avatar",showUploadList:!1,onChange:C,style:{width:180},customRequest:()=>{},beforeUpload:v,"data-testid":"create-project-upload-icon-input",children:e.jsx(L,{size:"middle","data-testid":"create-project-upload-icon-button",children:a("Upload icon")})}),x&&e.jsx(L,{size:"middle",danger:!0,onClick:k,"data-testid":"create-project-delete-icon-button",children:a("Delete icon")})]})})}),e.jsx(R.Item,{label:a("Name"),validateStatus:i!=null&&i.name?"error":"",help:i!=null&&i.name?i.name:"",children:e.jsx(F,{name:"name",control:l,render:({field:$})=>e.jsx(se,{...$,"data-testid":"create-project-name"})})}),e.jsx(R.Item,{label:a("Description"),validateStatus:i!=null&&i.description?"error":"",help:i!=null&&i.description?i.description:"",children:e.jsx(F,{name:"description",control:l,render:({field:$})=>e.jsx(Iv,{rows:4,...$,"data-testid":"create-project-description"})})}),e.jsx(R.Item,{label:a("Private"),validateStatus:i!=null&&i.is_private?"error":"",help:i!=null&&i.is_private?i.is_private:"",children:e.jsx(F,{name:"is_private",control:l,render:({field:$})=>e.jsx(Wt,{checked:_,...$,"data-testid":"create-project-is-private"})})})]})]})})},Lv=()=>{const{t}=T(),[s,a]=h.useState(!1),n=()=>{a(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{id:"create-project",icon:e.jsx(ct,{}),type:"primary",onClick:n,children:[t("Create")," ",t("Project")]}),e.jsx($v,{isShow:s,setIsShow:a})]})},{TextArea:Av}=se,Pv=({isShow:t,setIsShow:s,project:a})=>{const{t:n}=T(),{me:i}=h.useContext(Pe),{showModal:r}=Ot(),[o,c]=h.useState(null),{handleSubmit:l,reset:d,control:u,setValue:p,watch:m,formState:{isDirty:g}}=we(),[f,{isLoading:x}]=xp(),{onHandleError:y}=We(c),j=m("is_archive"),_=m("name"),w=m("is_private"),[b,S]=h.useState(null);h.useEffect(()=>{p("name",a.name),p("description",a.description),S(a.icon??null),p("is_private",a.is_private??!1),i!=null&&i.is_superuser&&p("is_archive",a.is_archive)},[t,a,i]);const C=async N=>{c(null);try{const A=new FormData;A.append("name",N.name),A.append("description",N.description),i!=null&&i.is_superuser&&A.append("is_archive",String(N.is_archive)),N.icon!==void 0&&A.append("icon",N.icon??""),a.is_manageable&&A.append("is_private",String(N.is_private));const q=await f({id:a.id,body:A}).unwrap();v(),H.success({message:n("Success"),closable:!0,description:e.jsx(Re,{action:"updated",title:n("Project"),link:`/administration/projects/${q.id}/overview/`,id:String(q.id)})})}catch(A){y(A)}},v=()=>{s(!1),c(null),S(null),d()},k=()=>{if(!x){if(g){r(v);return}v()}},$=async N=>{if(!N.file.originFileObj)return;const A=await vi(N.file);S(A.url),p("icon",A.file,{shouldDirty:!0,shouldTouch:!0})},I=N=>{const A=N.type==="image/png"||N.type==="image/jpeg";return A||H.error({message:"Error!",description:`${N.name} is not a png or jpg file`}),A||Ns.LIST_IGNORE},P=()=>{S(null),p("icon","",{shouldDirty:!0,shouldTouch:!0})};return e.jsx(he,{className:"edit-project-modal",title:`${n("Edit Project")} '${a.name}'`,open:t,onCancel:k,width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-update-project",onClick:k,children:n("Close")},"back"),e.jsx(L,{id:"update-project",loading:x,onClick:l(C),type:"primary",disabled:!g,children:n("Update")},"submit")],children:e.jsxs(e.Fragment,{children:[o?e.jsx(it,{error:o,skipFields:["name","description","is_archive","is_private"]}):null,e.jsxs(R,{id:"create-edit-project-form",layout:"vertical",onFinish:l(C),children:[e.jsx(R.Item,{label:n("Icon"),children:e.jsx(F,{name:"icon",control:u,render:()=>e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row",gap:14},children:[e.jsx(ca,{name:_,icon:b,dataTestId:"edit-project-icon"}),e.jsx(Ns,{name:"avatar",showUploadList:!1,onChange:$,style:{width:180},customRequest:()=>{},beforeUpload:I,"data-testid":"edit-project-upload-icon-input",children:e.jsx(L,{size:"middle","data-testid":"edit-project-upload-icon-button",children:n("Upload icon")})}),b&&e.jsx(L,{size:"middle",danger:!0,onClick:P,"data-testid":"edit-project-delete-icon-button",children:n("Delete icon")})]})})}),e.jsx(R.Item,{label:n("Name"),validateStatus:o!=null&&o.name?"error":"",help:o!=null&&o.name?o.name:"",children:e.jsx(F,{name:"name",control:u,render:({field:N})=>e.jsx(se,{...N,"data-testid":"edit-project-name"})})}),e.jsx(R.Item,{label:n("Description"),validateStatus:o!=null&&o.description?"error":"",help:o!=null&&o.description?o.description:"",children:e.jsx(F,{name:"description",control:u,render:({field:N})=>e.jsx(Av,{rows:4,...N,"data-testid":"edit-project-description"})})}),(i==null?void 0:i.is_superuser)&&e.jsx(R.Item,{label:n("Archive"),validateStatus:o!=null&&o.is_archive?"error":"",help:o!=null&&o.is_archive?o.is_archive:"",children:e.jsx(F,{name:"is_archive",control:u,render:({field:N})=>e.jsx(Wt,{checked:j,...N,"data-testid":"edit-project-is-archive"})})}),a.is_manageable&&e.jsx(R.Item,{label:n("Private"),validateStatus:o!=null&&o.is_private?"error":"",help:o!=null&&o.is_private?o.is_private:"",children:e.jsx(F,{name:"is_private",control:u,render:({field:N})=>e.jsx(Wt,{checked:w,...N,"data-testid":"edit-project-is-private"})})})]})]})})},Nv=({project:t})=>{const{t:s}=T(),[a,n]=h.useState(!1),i=()=>{n(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"edit-project",icon:e.jsx(Ke,{}),onClick:i,children:s("Edit")}),e.jsx(Pv,{isShow:a,setIsShow:n,project:t})]})},Rv="_icon_1qhwe_1",Dv={icon:Rv},{BookmarkIcon:Mv,BookmarkFillIcon:Fv}=Ce,Qi=({project:t})=>{var o,c;const{t:s}=T(),{userConfig:a,updateConfig:n}=h.useContext(Pe),i=async l=>{var m,g,f;if(l.preventDefault(),l.stopPropagation(),!t.is_visible)return;const d=!((m=a==null?void 0:a.projects)!=null&&m.favorite.some(x=>x===t.id)),u=d?(g=a==null?void 0:a.projects)==null?void 0:g.favorite.concat([t.id]):(f=a==null?void 0:a.projects)==null?void 0:f.favorite.filter(x=>Number(x)!==Number(t.id)),p={...a,projects:{...a==null?void 0:a.projects,favorite:u}};try{await n(p),H.success({message:s("Success"),closable:!0,description:`${t.name} ${s(d?"has been added to favorites":"has been removed to favorites")}`})}catch(x){H.error({message:s("Error!"),closable:!0,description:s("Error when try to change follow project")}),console.error(x)}},r=!!((c=(o=a==null?void 0:a.projects)==null?void 0:o.favorite)!=null&&c.some(l=>l===t.id));return e.jsx(le,{title:s("Add to favorites"),children:e.jsx("div",{id:`${t.name}-project-favorite-btn`,"data-test-active":r,className:Dv.icon,onClick:i,children:r?e.jsx(Fv,{}):e.jsx(Mv,{})})})},Ev="_requestBtn_119du_1",Bv={requestBtn:Ev},hc=({project:t,type:s="default"})=>{const{t:a}=T(),[n]=zd.useForm(),[i]=Sp(),r=()=>{n.validateFields().then(async l=>{try{const{reason:d}=l;await i({id:t.id,reason:d}).unwrap(),H.success({message:a("Success"),closable:!0,description:a("Request has been sent")})}catch{H.error({message:a("Error!"),closable:!0,description:a("Failed to send a reqeust")})}})},o=`${a("Request access to")} ${t.name}`,c=e.jsx(L,{type:"primary",block:!0,className:Bv.requestBtn,icon:e.jsx(Ud,{}),style:{width:"fit-content",padding:"5px 8px"},onClick:()=>he.confirm({title:a("Request Access"),icon:null,content:e.jsx(R,{form:n,children:e.jsx(R.Item,{name:"reason",label:a("Reason"),children:e.jsx(se,{})})}),onOk:r,cancelText:a("Cancel"),okText:a("Send"),okButtonProps:{"data-testid":"request-access-button-confirm"},cancelButtonProps:{"data-testid":"request-access-button-cancel"}}),children:s==="default"?o:null});return s==="default"?c:e.jsx(le,{title:o,placement:"top",children:c})},Ov="_cardWrapper_15dk6_1",qv="_cardContainer_15dk6_19",zv="_nameBlock_15dk6_43",Uv="_name_15dk6_43",Vv="_projectTitle_15dk6_71",Hv="_dataBlock_15dk6_81",Yv="_link_15dk6_107",Wv="_dataTitle_15dk6_107",Qv="_dataCount_15dk6_115",Gv="_btnsBlock_15dk6_141",Kv="_btnBlock_15dk6_163",Jv="_btnBlockTitle_15dk6_177",Zv="_action_15dk6_199",Xv="_cardBlured_15dk6_217",Ee={cardWrapper:Ov,cardContainer:qv,nameBlock:zv,name:Uv,projectTitle:Vv,dataBlock:Hv,link:Yv,dataTitle:Wv,dataCount:Qv,btnsBlock:Gv,btnBlock:Kv,btnBlockTitle:Jv,action:Zv,cardBlured:Xv},{DashboardIcon:eS,TestPlansIcon:tS,TestSuitesIcon:sS}=Ce,zn={width:16,marginRight:4},aS=({project:t,folowProject:s})=>{const{t:a}=T(),n=$o(t.name);return e.jsxs("div",{className:Ee.cardWrapper,"data-testid":n("card-wrapper"),children:[e.jsxs("div",{className:V({[Ee.cardBlured]:!t.is_visible}),children:[e.jsxs("div",{className:V(Ee.cardContainer),children:[e.jsxs("div",{className:Ee.nameBlock,children:[e.jsx(ca,{icon:t.icon,name:t.name,size:32,dataTestId:"project-card-icon"}),e.jsxs(M,{gap:8,align:"center",children:[t.is_archive&&e.jsx(wt,{"data-testid":n("archived-tag")}),e.jsx(ve,{className:Ee.name,"data-testid":n("name"),to:`/projects/${t.id}/overview`,children:t.name})]})]}),e.jsx("div",{className:Ee.action,"data-testid":n("action"),children:s}),e.jsxs("ul",{className:Ee.dataBlock,children:[e.jsxs("li",{"data-testid":n("data-block-suites"),children:[e.jsx("span",{className:Ee.dataCount,children:t.suites_count}),e.jsx("span",{className:Ee.dataTitle,children:a("Test Suites")})]}),e.jsxs("li",{"data-testid":n("data-block-plans"),children:[e.jsx("span",{className:Ee.dataCount,children:t.plans_count}),e.jsx("span",{className:Ee.dataTitle,children:a("Test Plans")})]}),e.jsxs("li",{"data-testid":n("data-block-cases"),children:[e.jsx("span",{className:Ee.dataCount,children:t.cases_count}),e.jsx("span",{className:Ee.dataTitle,children:a("Test Cases")})]}),e.jsxs("li",{"data-testid":n("data-block-tests"),children:[e.jsx("span",{className:Ee.dataCount,children:t.tests_count}),e.jsx("span",{className:Ee.dataTitle,children:a("Tests")})]})]})]}),e.jsxs("ul",{className:Ee.btnsBlock,children:[e.jsx(ve,{id:`${t.name}-link-overview`,to:`/projects/${t.id}/overview`,children:e.jsxs("li",{className:Ee.btnBlock,children:[e.jsx(eS,{style:zn}),e.jsx("span",{className:Ee.btnBlockTitle,children:a("Overview")})]})}),e.jsx(ve,{id:`${t.name}-link-suites`,to:`/projects/${t.id}/suites`,children:e.jsxs("li",{className:Ee.btnBlock,children:[e.jsx(sS,{style:zn}),e.jsx("span",{className:Ee.btnBlockTitle,children:a("Test Suites")})]})}),e.jsx(ve,{id:`${t.name}-link-plans`,to:`/projects/${t.id}/plans`,children:e.jsxs("li",{className:Ee.btnBlock,children:[e.jsx(tS,{style:zn}),e.jsx("span",{className:Ee.btnBlockTitle,children:a("Test Plans")})]})})]})]}),!t.is_visible&&e.jsx(hc,{project:t})]})},nS="_cardWrapper_1hnzf_1",iS="_cardContainer_1hnzf_19",rS="_nameBlock_1hnzf_43",oS="_btnsBlock_1hnzf_59",lS="_data_1hnzf_81",cS="_bookmark_1hnzf_99",dS="_statItem_1hnzf_107",ks={cardWrapper:nS,cardContainer:iS,nameBlock:rS,btnsBlock:oS,data:lS,bookmark:cS,statItem:dS},uS=({count:t=6})=>Array(t).fill(null).map((s,a)=>e.jsxs("div",{className:ks.cardWrapper,children:[e.jsxs("div",{className:ks.cardContainer,children:[e.jsxs("div",{className:ks.nameBlock,children:[e.jsx(fe,{shape:"circle",width:32,height:32,style:{marginRight:12}}),e.jsx(fe,{width:"50%",height:32})]}),e.jsx(fe,{width:32,height:32,style:{marginLeft:"auto"},className:ks.bookmark}),e.jsx("div",{className:ks.data,children:Array(4).fill(null).map((n,i)=>e.jsxs("div",{className:ks.statItem,children:[e.jsx(fe,{width:48,height:30}),e.jsx(fe,{width:"80%",height:22})]},i))})]}),e.jsx("ul",{className:ks.btnsBlock,children:Array(3).fill(null).map((n,i)=>e.jsx(fe,{width:"20%",height:24},i))})]},a)),hS="_wrapper_1eu03_1",pS="_card_1eu03_21",mS="_cardValue_1eu03_45",ss={wrapper:hS,card:pS,cardValue:mS},gS=({testSuites:t=0,testCases:s=0,testPlans:a=0,tests:n=0})=>{const{t:i}=T();return e.jsxs("ul",{className:ss.wrapper,"data-testid":"project-stats",children:[e.jsxs("li",{className:ss.card,style:{borderColor:"var(--y-graph-primary)"},"data-testid":"project-stats-test-suites",children:[e.jsx("span",{className:ss.cardValue,children:t}),e.jsx("span",{children:i("Test Suites")})]}),e.jsxs("li",{className:ss.card,style:{borderColor:"var(--y-graph-secondary)"},"data-testid":"project-stats-test-cases",children:[e.jsx("span",{className:ss.cardValue,children:s}),e.jsx("span",{children:i("Test Cases")})]}),e.jsxs("li",{className:ss.card,style:{borderColor:"var(--y-graph-fourth)"},"data-testid":"project-stats-test-plans",children:[e.jsx("span",{className:ss.cardValue,children:a}),e.jsx("span",{children:i("Test Plans")})]}),e.jsxs("li",{className:ss.card,style:{borderColor:"var(--y-graph-fifth)"},"data-testid":"project-stats-tests",children:[e.jsx("span",{className:ss.cardValue,children:n}),e.jsx("span",{children:i("Tests")})]})]})},zr=({percent:t,countStr:s,...a})=>e.jsxs("div",{...a,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",flexDirection:"row"},children:[e.jsx(Vd,{percent:t,strokeColor:Oe.accent,showInfo:!1}),e.jsxs("span",{style:{marginLeft:6,fontSize:14},children:[t,"%"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",fontSize:12},children:e.jsx("span",{children:s})})]}),xS=()=>{const{t}=T(),{projectId:s}=Q(),[a,{data:n}]=jp(),[i,r]=h.useState(!1),o=d=>!d.isBefore(K()),c=async d=>{if(!d||!s)return;const[u,p]=d;if(!(!u||!p))try{r(!0),await a({projectId:s,period_date_start:Ba(u),period_date_end:Ba(p)})}catch(m){console.error(m)}finally{r(!1)}},l=[{title:t("Test Plans"),dataIndex:"title",key:"title",ellipsis:{showTitle:!1},render:(d,u)=>e.jsx(ve,{id:`overview-test-plan-link-${u.title}`,to:`/projects/${s}/plans/${u.id}`,children:e.jsx(le,{placement:"topLeft",title:u.title,children:u.title})})},{title:t("Total"),dataIndex:"tests_total",key:"tests_total",width:"180px",render:(d,u)=>{const p=Math.round(Number(u.tests_progress_total)/Number(u.tests_total)*100),m=`${u.tests_progress_total} / ${u.tests_total}`;return e.jsx(zr,{percent:u.tests_progress_total?p:0,countStr:m,"data-testid":`${u.title}-progress-item`})}},{title:e.jsx(vt.RangePicker,{defaultValue:[K().subtract(7,"days"),K()],onChange:c,disabledDate:o,size:"small","data-testid":"project-overview-progress-date-picker"}),dataIndex:"tests_progress_period",key:"tests_progress_period",width:"250px",render:(d,u)=>{const p=Math.round(Number(u.tests_progress_period)/Number(u.tests_progress_total)*100);return e.jsx(zr,{percent:u.tests_progress_total?p:0,countStr:String(u.tests_progress_period),"data-testid":`${u.title}-progress-period-item`})}}];return h.useEffect(()=>{s&&(r(!0),a({projectId:s,period_date_start:Ba(K().subtract(7,"days")),period_date_end:Ba(K())}).finally(()=>{r(!1)}))},[s]),{columns:l,data:n,isLoading:i,handleChange:c,disabledDateStart:o}},fS="_wrapper_n7l0q_1",jS="_header_n7l0q_17",yS="_table_n7l0q_45",Un={wrapper:fS,header:jS,table:yS},_S=()=>{const{t}=T(),{columns:s,data:a,isLoading:n}=xS();return e.jsxs("div",{className:Un.wrapper,children:[e.jsx("div",{className:Un.header,children:e.jsx(G.Title,{level:4,children:t("Executed tests progress")})}),e.jsx(Hd,{dataSource:a,columns:s,rowKey:"id",className:Un.table,pagination:{defaultPageSize:5},id:"projects-overview-table",loading:n})]})},bS=({searchName:t})=>{var j,_;const{userConfig:s}=h.useContext(Pe),[a,n]=h.useState({page:1,page_size:10}),[i,r]=h.useState([]),[o,c]=h.useState(!1),[l,d]=h.useState(!0),[u]=mp(),[p,m]=h.useState(null),{ref:g,inView:f}=gi({threshold:0,trackVisibility:!0,delay:100,skip:l||o}),x=async(w,b=!1)=>{p&&p.abort();try{d(!0);const S=u({...w,ordering:"is_private"});m(S);const{data:C}=await S;if(!C)return;r(v=>b?C.results:[...v,...C.results]),c(!C.pages.next)}catch(S){console.error(S)}finally{d(!1)}};h.useEffect(()=>{!f||l||o||n(w=>{var b,S;return x({page:w.page+1,page_size:w.page_size,is_archive:(b=s==null?void 0:s.projects)==null?void 0:b.is_show_archived,favorites:((S=s==null?void 0:s.projects)==null?void 0:S.is_only_favorite)??!1,name:t}),{page:w.page+1,page_size:w.page_size}})},[f,l,o]),h.useEffect(()=>{n(w=>{var b,S;return y(),x({page:1,page_size:w.page_size,is_archive:(b=s==null?void 0:s.projects)==null?void 0:b.is_show_archived,favorites:((S=s==null?void 0:s.projects)==null?void 0:S.is_only_favorite)??!1,name:t}),{page:1,page_size:w.page_size}})},[(j=s==null?void 0:s.projects)==null?void 0:j.is_only_favorite,(_=s==null?void 0:s.projects)==null?void 0:_.is_show_archived]),h.useEffect(()=>{var w,b;y(),x({page:1,page_size:a.page_size,is_archive:(w=s==null?void 0:s.projects)==null?void 0:w.is_show_archived,favorites:((b=s==null?void 0:s.projects)==null?void 0:b.is_only_favorite)??!1,name:t},!0)},[t]);const y=()=>{n({page:1,page_size:a.page_size}),r([]),c(!1)};return{projects:i,isLoading:l,isLastPage:o,bottomRef:g}},vS="_wrapper_b7pvv_1",SS="_list_b7pvv_11",Ur={wrapper:vS,list:SS},wS=({searchName:t})=>{const{isLoading:s,isLastPage:a,projects:n,bottomRef:i}=bS({searchName:t});return e.jsxs("div",{className:Ur.wrapper,children:[!s&&!n.length&&e.jsx(xi,{}),e.jsxs("div",{className:Ur.list,children:[n.map(r=>e.jsx(Yd.Item,{id:`${r.name}-project-card`,style:{width:"100%"},children:e.jsx(aS,{project:r,folowProject:e.jsx(Qi,{project:r})})},r.id)),s&&e.jsx(uS,{}),!s&&!!n.length&&!a&&e.jsx("div",{id:"scroll-pagination-trigger-dashboard",ref:i},"trigger")]})]})},CS="_action_pm2gl_1",TS={action:CS},{DashboardIcon:kS,TestPlansIcon:IS,TestSuitesIcon:$S}=Ce,{Link:LS}=G,AS=({searchName:t})=>{var j,_;const{t:s}=T(),a=De(),{userConfig:n}=h.useContext(Pe),[i,r]=h.useState({}),[o,c]=h.useState({page:1,pageSize:10}),[l,d]=h.useState("is_private"),{data:u,isFetching:p}=Ii({is_archive:(j=n==null?void 0:n.projects)==null?void 0:j.is_show_archived,favorites:((_=n==null?void 0:n.projects)==null?void 0:_.is_only_favorite)??!1,page:o.page,page_size:o.pageSize,name:t,ordering:l.length?l:"is_private"},{skip:!n}),m=(w,b)=>{a(`/projects/${w}/${b}`)},g=(w,b,S)=>{const C=wi(S);d(C),r(b)},f=[{key:"action_1",width:64,render:(w,b)=>e.jsxs(M,{children:[e.jsx(Qi,{project:b}),b.is_archive?e.jsx(M,{style:{height:30},align:"center",children:e.jsx(wt,{})}):null]})},{title:s("Icon"),dataIndex:"icon",key:"icon",width:50,render:(w,b)=>e.jsx(ca,{icon:b.icon,name:b.name,dataTestId:"dashboard-table-project-icon"})},{title:s("Name"),dataIndex:"name",key:"name",filteredValue:i.name??null,onFilter:(w,b)=>b.name.toLowerCase().includes(String(w).toLowerCase()),render:(w,b)=>{const S=()=>{(!b.is_private||b.is_manageable)&&m(b.id,"overview")},C=e.jsx(LS,{onClick:S,children:e.jsx(Lt,{searchWords:t,textToHighlight:w})});return b.is_private&&!b.is_visible?e.jsx(le,{placement:"topLeft",title:s("You are not able to view this project"),arrow:!0,children:C}):C}},{title:s("Test Suites"),dataIndex:"suites_count",key:"suites_count",render:(w,b)=>b.is_visible?w:"-"},{title:s("Test Cases"),dataIndex:"cases_count",key:"cases_count",render:(w,b)=>b.is_visible?w:"-"},{title:s("Test Plans"),dataIndex:"plans_count",key:"plans_count",render:(w,b)=>b.is_visible?w:"-"},{title:s("Tests"),dataIndex:"tests_count",key:"tests_count",render:(w,b)=>b.is_visible?w:"-"},{title:s("Is Private"),dataIndex:"is_private",key:"is_private",width:120,render:w=>e.jsx(Xn,{value:w}),sorter:!0},{key:"action",width:128,render:(w,b)=>b.is_visible?e.jsxs(ce,{className:TS.action,children:[e.jsx(le,{title:s("Overview"),placement:"top",children:e.jsx(kS,{onClick:()=>m(b.id,"overview")})}),e.jsx(le,{title:s("Test Suites"),placement:"top",children:e.jsx($S,{onClick:()=>m(b.id,"suites")})}),e.jsx(le,{title:s("Test Plans"),placement:"top",children:e.jsx(IS,{onClick:()=>m(b.id,"plans")})})]}):e.jsx(hc,{project:b,type:"min"})}],x=(w,b)=>{c({page:w,pageSize:b})},y={hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:o.page,pageSize:o.pageSize,total:(u==null?void 0:u.count)??0,onChange:x};return{columns:f,projects:u,isLoading:p,paginationTable:y,handleChange:g}},{Link:PS}=G,NS=()=>{const{t}=T(),s=De(),{setSearchText:a,getColumnSearch:n,searchText:i}=zs(),[r,o]=h.useState({}),[c,l]=h.useState(!1),[d,u]=h.useState({page:1,pageSize:10}),{data:p,isFetching:m}=Ii({is_archive:c,page:d.page,page_size:d.pageSize,name:i||void 0}),g=()=>{o({}),a(""),l(!1)},f=b=>{s(`/administration/projects/${b}/overview`)},x=(b,S)=>{o(S)},y=b=>{b.is_private&&!b.is_manageable||s(`/administration/projects/${b.id}/overview`)},j=[{title:t("Icon"),dataIndex:"icon",key:"icon",width:50,render:(b,S)=>e.jsx(ca,{icon:S.icon,name:S.name,dataTestId:"administration-table-project-icon"})},{title:t("Name"),dataIndex:"name",key:"name",filteredValue:r.name??null,...n("name"),onFilter:(b,S)=>S.name.toLowerCase().includes(String(b).toLowerCase()),render:(b,S)=>{const C=()=>{(!S.is_private||S.is_manageable)&&f(S.id)},v=e.jsxs(M,{gap:8,align:"center",children:[S.is_archive&&e.jsx(wt,{}),e.jsx(PS,{onClick:C,children:e.jsx(Lt,{searchWords:i,textToHighlight:b})})]});return S.is_private&&!S.is_manageable?e.jsx(le,{placement:"topLeft",title:t("You are not able to manage this project"),arrow:!0,children:v}):v}}],_=(b,S)=>{u({page:b,pageSize:S})},w={hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:d.page,pageSize:d.pageSize,total:(p==null?void 0:p.count)??0,onChange:_};return{columns:j,projects:p,isLoading:m,paginationTable:w,isShowArchive:c,handleRowClick:y,handleChange:x,handleClearAll:g,handleShowArchive:l}},RS=({searchName:t})=>{const{isLoading:s,columns:a,projects:n,paginationTable:i,handleChange:r}=AS({searchName:t});return e.jsx(ht,{loading:s,dataSource:(n==null?void 0:n.results)??[],columns:a,rowKey:"id",onChange:r,pagination:i})},DS="_disabledRow_16cdk_1",MS={disabledRow:DS},FS=()=>{const{t}=T(),{isLoading:s,isShowArchive:a,columns:n,projects:i,paginationTable:r,handleClearAll:o,handleChange:c,handleRowClick:l,handleShowArchive:d}=NS();return e.jsxs(e.Fragment,{children:[e.jsxs(M,{vertical:!0,gap:16,align:"flex-end",style:{marginBottom:16,float:"right"},children:[e.jsx(L,{id:"clear-filters-and-sorters",onClick:o,children:t("Clear filters and sorters")}),e.jsx(Qt,{id:"test-cases-archive-toggle",label:t("Show Archived"),checked:a,size:"lg",onChange:d})]}),e.jsx(ht,{dataSource:(i==null?void 0:i.results)??[],columns:n,loading:s,rowKey:"id",style:{marginTop:12,cursor:"pointer"},onChange:c,pagination:r,rowClassName:u=>V({[MS.disabledRow]:u.is_private&&!u.is_manageable}),onRow:u=>({onClick:()=>l(u)})})]})},ES="_wrapper_aaj6q_1",BS="_headerContainer_aaj6q_13",OS="_header_aaj6q_13",qS="_actions_aaj6q_39",zS="_projectTitle_aaj6q_51",US="_overview_aaj6q_71",Gs={wrapper:ES,headerContainer:BS,header:OS,actions:qS,projectTitle:zS,overview:US},VS=()=>{const{t}=T(),{project:s}=h.useContext(J);return e.jsxs("div",{className:Gs.wrapper,children:[e.jsxs("div",{className:Gs.headerContainer,children:[e.jsxs("div",{className:Gs.header,children:[e.jsxs("div",{className:Gs.projectTitle,children:[s.is_archive&&e.jsx(wt,{size:"lg"}),e.jsx("span",{children:s.name})]}),e.jsx("span",{className:Gs.overview,children:t("Overview")})]}),e.jsx("div",{className:Gs.actions,children:e.jsx(Qi,{project:s})})]}),e.jsx(gS,{testSuites:s.suites_count,testCases:s.cases_count,testPlans:s.plans_count,tests:s.tests_count}),e.jsx(_S,{})]})},HS="_wrapper_3kgqn_1",YS="_containerContent_3kgqn_13",WS="_wrapperContent_3kgqn_29",Vn={wrapper:HS,containerContent:YS,wrapperContent:WS},QS=()=>e.jsx(lC,{children:e.jsxs("div",{className:Vn.wrapper,children:[e.jsx(Bj,{}),e.jsxs("div",{className:Vn.containerContent,children:[e.jsx("div",{className:Vn.wrapperContent,children:e.jsx(xs,{})}),e.jsx(Xo,{})]}),e.jsx("div",{id:"portal-root"})]})}),GS="_nodeBody_badvb_1",KS="_infoIcon_badvb_33",JS="_nodeLeftAction_badvb_59",ZS="_arrowIcon_badvb_79",XS="_arrowIconOpen_badvb_99",ew="_loader_badvb_109",tw="_activeNode_badvb_127",sw="_isRoot_badvb_137",aw="_isLast_badvb_145",nw="_noborder_badvb_153",iw="_name_badvb_169",rw="_activeLink_badvb_183",ow="_searchContainer_badvb_191",lw="_searchDropdown_badvb_199",Jt={nodeBody:GS,infoIcon:KS,nodeLeftAction:JS,arrowIcon:ZS,arrowIconOpen:XS,loader:ew,activeNode:tw,isRoot:sw,isLast:aw,noborder:nw,name:iw,activeLink:rw,searchContainer:ow,searchDropdown:lw},{ArrowIcon:cw}=Ce,dw=({node:t,selectedId:s,searchText:a,onSelect:n})=>{var l;const i=t.props.level*20,r=async d=>{d.stopPropagation(),await t.open()},o=async()=>{await t.more()},c=()=>{if(t.tree.selectedId===t.id){t.tree.updateSelectId(null),n(null);return}t.tree.updateSelectId(t.id),n(t)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:`${t.title}-${t.id}`,style:{paddingLeft:i},children:e.jsxs("div",{className:V(Jt.nodeBody,{[Jt.activeNode]:s===t.id,[Jt.isRoot]:t.isRoot,[Jt.isLast]:t.isLast}),onClick:c,children:[e.jsxs("div",{className:Jt.nodeLeftAction,children:[t.props.isLoading&&e.jsx(St,{size:"small",className:Jt.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(cw,{className:V(Jt.arrowIcon,{[Jt.arrowIconOpen]:t.props.isOpen}),onClick:r})]}),e.jsx(Lt,{searchWords:a,textToHighlight:t.title})]})},`${t.title}-${t.id}-treeview-suite`),((l=t.parent)==null?void 0:l.props.hasMore)&&t.isLast&&e.jsx(Ra,{isLoading:t.parent.props.isLoading,node:t,onMore:o,isRoot:t.isRoot,isLast:t.isLast})]})},pc=({id:t,getData:s,getAncestors:a,onSelect:n,selectedId:i,skipInit:r=!0,placeholder:o,valueKey:c="name",disabled:l=!1,searchValue:d="",dataParams:u})=>{const{project:p}=h.useContext(J),[m,g]=h.useState(d),[f,x]=h.useState(d),[y,j]=h.useState(!1),_=Fs(f,250,!0),w=h.useRef(null);Ti(w,()=>{j(!1),x(i?d:""),g(i?d:"")},!0,[`#${t}`]);const S=async I=>{const P=await s({project:p.id,page:I.page,parent:I.parent?Number(I.parent):null,page_size:Ae.defaultTreePageSize,ordering:"name",treesearch:_,_n:I._n,...u},!0).unwrap();return{data:fs(P.results,A=>({...I,title:A[c]})),nextInfo:P.pages,_n:I._n}},C=async I=>await a({project:p.id,id:Number(I)}).unwrap(),v=I=>{const P=I.target.value;x(P),g(P),P.length||n(null)},k=()=>{j(!0)},$=I=>{I&&(g(I.title),n(I),j(!1))};return h.useEffect(()=>{g(d)},[d]),e.jsxs("div",{className:Jt.searchContainer,children:[e.jsx(ji,{id:t,style:{marginBottom:8},placeholder:o,onChange:v,onClick:k,value:m,allowClear:!0,disabled:l}),y&&!l&&e.jsx("div",{className:Jt.searchDropdown,ref:w,"data-testid":`${t}-search-dropdown`,children:e.jsx(qs,{fetcher:S,fetcherAncestors:C,skipInit:r,selectedId:i,initDependencies:[_],renderNode:I=>e.jsx(dw,{node:I,selectedId:i,onSelect:$,searchText:m})})})]})},Fa=({id:t,control:s,name:a,label:n,formErrors:i,externalErrors:r,placeholder:o,required:c=!1,getData:l,getAncestors:d,onSelect:u,dataParams:p,skipInit:m=!1,selected:g,rules:f={}})=>{var y;const x=((y=i==null?void 0:i[a])==null?void 0:y.message)??(r==null?void 0:r[a]);return e.jsx(R.Item,{label:n,validateStatus:x?"error":"",help:x,required:c,children:e.jsx(F,{name:"parent",control:s,rules:f,render:()=>{var j;return e.jsx(pc,{id:t,getData:l,getAncestors:d,skipInit:m,dataParams:p,placeholder:o,onSelect:_=>u(_?{label:_.title,value:_.id}:null),selectedId:g==null?void 0:g.value,searchValue:((j=g==null?void 0:g.label)==null?void 0:j.toString())??""})}})})},uw="_skeleton_1yi7w_1",hw="_circle_1yi7w_49",Vr={skeleton:uw,"ant-skeleton-loading":"_ant-skeleton-loading_1yi7w_1",circle:hw},fe=({shape:t="rect",width:s="100%",height:a="100%",style:n,className:i})=>e.jsx("div",{className:V(Vr.skeleton,{[Vr.circle]:t==="circle"},i),style:{width:s,minHeight:a,height:a,...n}}),pw="_tag_muw7g_1",mw={tag:pw},Ks={sm:16,md:24,lg:32},wt=({className:t,style:s,size:a="md",...n})=>{const{t:i}=T();return e.jsx(le,{title:i("Archived"),children:e.jsx("div",{className:V(mw.tag,t),style:{minWidth:Ks[a],minHeight:Ks[a],width:Ks[a],height:Ks[a],lineHeight:`${Ks[a]}px`,fontSize:Ks[a]/2,...s},"data-testid":"archived-tag",...n,children:"A"})})},gw=t=>h.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",...t},h.createElement("rect",{width:256,height:256,fill:"none"}),h.createElement("rect",{x:48,y:48,width:160,height:160,rx:8,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:128,y1:48,x2:128,y2:208,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:128,y1:80,x2:208,y2:80,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:128,y1:112,x2:208,y2:112,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:128,y1:144,x2:208,y2:144,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:128,y1:176,x2:208,y2:176,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16})),xw=({children:t,id:s})=>{const a=document.getElementById(s);return a?Zi.createPortal(t,a):Zi.createPortal(t,document.body)},fw="_resizeLine_1e2pz_1",jw="_right_1e2pz_27",yw="_left_1e2pz_35",Hr={resizeLine:fw,right:jw,left:yw},{DotsIcon:_w}=Ce,mc=({direction:t="right",onMouseDown:s})=>e.jsx("div",{className:V(Hr.resizeLine,Hr[t]),onMouseDown:s,children:e.jsx(_w,{width:10,height:23,style:{color:"var(--y-grey-30)"}})}),bw="_wrapper_1nkxc_1",vw="_fixedRight_1nkxc_27",Sw="_isOpen_1nkxc_39",ww="_header_1nkxc_49",Cw="_body_1nkxc_59",Tw="_loaderBlock_1nkxc_81",kw="_closeIcon_1nkxc_95",Iw="_iconActive_1nkxc_115",as={wrapper:bw,fixedRight:vw,isOpen:Sw,header:ww,body:Cw,loaderBlock:Tw,closeIcon:kw,iconActive:Iw},{CloseIcon:$w}=Ce,Lw=70,Aw=[".ant-modal-root",".ant-popover-content",".anticon-close-circle",".ant-notification-notice-wrapper",".ant-select-dropdown",".ant-dropdown",".ant-picker-dropdown"],Nn=({id:t,isOpen:s,isLoading:a=!1,minWidth:n=500,baseWidth:i=n,onClose:r,title:o,extra:c,children:l})=>{const[d,u]=Es("isDrawerRightFixed",!1,Io),p=()=>{u(!d)},m=h.useRef(null),{width:g,handleMouseDown:f}=Bo({key:t,elRef:m,defaultWidth:i,minWidth:n,maxWidth:Lw,maxAsPercent:!0,direction:"left"});return Ti(m,r,s&&!d,Aw),e.jsx(xw,{id:"portal-root",children:e.jsxs("div",{id:t,ref:m,style:{width:g},className:V(as.wrapper,{[as.isOpen]:s,[as.fixedRight]:d}),children:[e.jsx(mc,{onMouseDown:f,direction:"left"}),a&&e.jsx("div",{className:as.loaderBlock,children:e.jsx(zt,{})}),!a&&e.jsxs(e.Fragment,{children:[e.jsxs(M,{gap:16,justify:"space-between",className:as.header,children:[e.jsxs(M,{gap:4,style:{minWidth:68},children:[e.jsx(Le,{flex:"32px",style:{padding:0,height:32},children:e.jsx($w,{className:as.closeIcon,onClick:r,id:"drawer-close-icon"})}),e.jsx(Le,{flex:"32px",style:{padding:0,height:32},children:e.jsx(gw,{className:V(as.closeIcon,{[as.iconActive]:d}),onClick:p,id:"drawer-square-half-icon"})})]}),e.jsx(M,{align:"flex-start",style:{width:"fit-content",marginRight:"auto"},children:o}),c]}),e.jsx("div",{className:as.body,children:l})]})]})})},Pw="_tableWrapper_rkgx4_1",Nw="_table_rkgx4_1",Rw="_tableHead_rkgx4_33",Dw="_tableBody_rkgx4_75",Mw="_loadMoreContainer_rkgx4_107",Fw="_loadMore_rkgx4_107",Ew="_isRoot_rkgx4_137",Bw="_isLast_rkgx4_145",Yt={tableWrapper:Pw,table:Nw,tableHead:Rw,tableBody:Dw,loadMoreContainer:Mw,loadMore:Fw,isRoot:Ew,isLast:Bw},gc=({children:t,visibleColumns:s})=>{const{t:a}=T();return e.jsx("div",{className:Yt.tableWrapper,children:e.jsxs("table",{className:Yt.table,children:[e.jsx("thead",{className:Yt.tableHead,children:e.jsx("tr",{children:s.map(n=>e.jsx("th",{children:a(n.title)},n.key))})}),e.jsx("tbody",{className:Yt.tableBody,children:t})]})})},Rn=({node:t,isLoading:s,isRoot:a,isLast:n,offset:i,onMore:r})=>{const{t:o}=T(),c=t?t.props.level:0,l=t?t.title:"root",d=i||c*20;return s?e.jsx("tr",{id:`node-${l}-load-more-spinner`,className:Yt.loadMoreContainer,children:e.jsxs("td",{colSpan:100,className:V(Yt.loadMore,{[Yt.isRoot]:a,[Yt.isLast]:n}),children:[e.jsx("span",{style:{width:d,height:1,float:"left"}}),e.jsx(St,{size:"small"})]})}):e.jsx("tr",{id:`node-${l}-more`,className:Yt.loadMoreContainer,children:e.jsxs("td",{colSpan:100,className:V(Yt.loadMore,{[Yt.isRoot]:a}),children:[e.jsx("span",{style:{width:d,height:1,float:"left"}}),e.jsx(L,{id:`node-${l}-more-btn`,size:"small",type:"link",onClick:r,children:o("Load more")})]})})},Ow="_collapseBlock_1c9ye_1",qw="_collapseBlockTitle_1c9ye_9",Yr={collapseBlock:Ow,collapseBlockTitle:qw},{ArrowIcon:zw}=Ce,ii=({children:t,cacheKey:s,collapse:a,defaultCollapse:n=!1,title:i,isLoading:r=!1,onOpenChange:o,...c})=>{const[l,d]=Es(`collapse-${s}`,!!n,Io),u=()=>{o&&o(!l),d(!l)};return h.useEffect(()=>{a!==void 0&&d(a)},[a]),e.jsxs("div",{className:Yr.collapseBlock,...c,children:[e.jsxs("div",{className:Yr.collapseBlockTitle,onClick:u,children:[e.jsx(zw,{width:24,height:24,style:{transform:`rotate(${l?270:360}deg)`}}),i]}),!l&&!r&&t,r&&!l&&e.jsx(zt,{})]})},Uw=t=>h.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",...t},h.createElement("rect",{width:256,height:256,fill:"none"}),h.createElement("rect",{x:56,y:24,width:48,height:48,rx:8,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("rect",{x:168,y:96,width:48,height:48,rx:8,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("rect",{x:168,y:184,width:48,height:48,rx:8,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("line",{x1:80,y1:120,x2:168,y2:120,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16}),h.createElement("path",{d:"M80,72V192a16,16,0,0,0,16,16h72",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:16})),{TableIcon:Vw}=Ce,xc=({value:t,onChange:s})=>{const{t:a}=T();return e.jsxs(M,{gap:8,"data-testid":"data-view-select",children:[e.jsx(le,{title:a("Table view"),placement:"topLeft",children:e.jsx(L,{ghost:t!=="list",onClick:()=>s("list"),icon:e.jsx(Vw,{color:"var(--y-sky-40)"}),"data-testid":"data-view-select-table"})}),e.jsx(le,{title:a("Tree view"),placement:"topLeft",children:e.jsx(L,{ghost:t!=="tree",onClick:()=>s("tree"),icon:e.jsx(Uw,{color:"var(--y-sky-40)",width:18,height:18}),"data-testid":"data-view-select-tree"})})]})},Hw={sm:{fontSize:14,lineHeight:"22px",switcher:"small"},lg:{fontSize:16,lineHeight:"24px",switcher:"default"}},Qt=({id:t,label:s,labelFontSize:a=16,size:n="sm",...i})=>e.jsxs(M,{gap:6,align:"center",style:{cursor:"pointer",width:"fit-content"},children:[e.jsx(Wt,{id:t,size:Hw[n].switcher,...i}),typeof s=="string"?e.jsx("label",{htmlFor:t,style:{cursor:"pointer"},children:e.jsx(G.Text,{style:{fontSize:a,lineHeight:"24px",color:"var(--y-sky-80)"},children:s})}):e.jsx("label",{htmlFor:t,style:{cursor:"pointer"},children:s})]}),Yw="_btn_1m6an_1",Ww="_hide_1m6an_47",Wr={btn:Yw,hide:Ww},{ArrowIcon:Qw}=Ce,Gw=()=>{const[t,s]=h.useState(!1),a=()=>{s(window.pageYOffset>500)},n=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})};return h.useEffect(()=>(window.addEventListener("scroll",a),()=>{window.removeEventListener("scroll",a)}),[]),e.jsx("button",{type:"button",className:V(Wr.btn,{[Wr.hide]:!t}),onClick:n,children:e.jsx(Qw,{style:{transform:"rotate(180deg)"}})})},fc=({title:t})=>e.jsx(le,{title:t,children:e.jsx(Wd,{style:{color:"rgba(0,0,0,.45)",marginLeft:4}})}),Kw="_searchBlock_125ta_1",Jw="_input_125ta_11",Zw="_tree_125ta_19",Hn={searchBlock:Kw,input:Jw,tree:Zw},jc=({data:t,searchValue:s,newList:a=[],allSelectedData:n=[],titleKey:i})=>{const r=(o,c)=>({...o,key:String(o.id),value:String(o.id),title:e.jsx(Lt,{searchWords:s??"",textToHighlight:o[i]??""}),titleText:o[i]??"",name:o[i]??"",children:c});for(const o of t)if(n.push(Number(o.id)),o.children.length){const[c]=jc({data:o.children,searchValue:s,newList:[],allSelectedData:n,titleKey:i});a.push(r(o,c))}else a.push(r(o,[]));return[a,n]};function yc(t,s,a=null,n=[]){let i=[];for(const r of t){const o=[...n,a].filter(Boolean);String(r.titleText.toLowerCase()).includes(s.toLowerCase())&&i.push(...o),r.children&&r.children.length>0&&(i=i.concat(yc(r.children,s,r.key,o)))}return Array.from(new Set(i))}function Gi(t,s){for(const a of t){if(Number(a.id)===s)return a;if(a.children){const n=Gi(a.children,s);if(n)return n}}return null}const _c=(t,s,a=[])=>{var n;if((n=s==null?void 0:s.parent)!=null&&n.id){a.push(s.parent.id);const i=Gi(t,s.parent.id);if(i)return _c(t,i,a)}return a},ri=({type:t,value:s,getData:a,getDataFromRoot:n,onChange:i,onClose:r,onClear:o})=>{const{t:c}=T(),[l,d]=h.useState(!1),[u,p]=h.useState(!0),[m,g]=h.useState(!1),[f,x]=h.useState([]),[y,j]=h.useState([]),[_,w]=h.useState(!0),[b,S]=h.useState(""),[C,v]=h.useState([]),[k,$]=h.useState([]),I=m?C:k,P=h.useMemo(()=>{if(!I.length)return{data:[],selectedData:[]};const[oe,te]=jc({data:I,searchValue:b,titleKey:t==="plans"?"title":"name"});return{data:oe,selectedData:te}},[I,b]);h.useEffect(()=>{const oe=(te,B=[])=>{var ie;for(const ke of te)E.includes(String(ke.id))&&(ie=ke==null?void 0:ke.parent)!=null&&ie.id&&B.push(..._c(I,ke)),ke.children.length&&oe(ke.children,B);return B};x([...new Set(oe(I).map(te=>String(te)))])},[I,s]);const N=oe=>{const{value:te}=oe.target,B=yc(P.data,te);j(B),S(te),w(!0)},A=oe=>{j(oe),w(!1)},q=()=>{i(P.selectedData)},O=oe=>{d(oe),oe||(S(""),r==null||r())},Y=oe=>{const te=oe.map(B=>Number(B.value));if(!te.length){o==null||o();return}i(te)},ee=(oe,te)=>{const{node:B,checked:ie}=te;let ke=[...E];if(ie){const qe=Qe=>{var ge;ke.includes(Qe.key)||ke.push(Qe.key),(ge=Qe.children)==null||ge.forEach(qe)};qe(B)}else{const qe=Qe=>{var ge;ke=ke.filter(rt=>rt!==Qe.key),(ge=Qe.children)==null||ge.forEach(qe)};qe(B)}i(ke.map(Number))},U=oe=>{g(oe)};h.useEffect(()=>{(async()=>{p(!0);const te=await n(),B=await a();v(te),$(B),p(!1)})()},[]);const E=s.map(String),D=h.useMemo(()=>s.map(oe=>{const te=Gi(C,oe);return{value:String(oe),label:te?t==="plans"?te.title:te.name:String(oe)}}),[s,C,t]),ae=c(t==="plans"?"Filter by Test Plans":"Filter by Test Suites");return e.jsx(ue,{id:`${t}-tree-filter`,value:u?[]:D,labelInValue:!0,mode:"multiple",maxTagCount:6,showSearch:!1,placeholder:ae,defaultActiveFirstOption:!1,filterOption:!1,open:l,loading:u,onClear:o,onChange:Y,allowClear:!0,style:{width:"100%"},dropdownStyle:{padding:0},onDropdownVisibleChange:O,dropdownRender:()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Hn.searchBlock,"data-testid":"entity-tree-filter-search-block",children:e.jsx(se,{className:Hn.input,placeholder:c("Search"),variant:"borderless",value:b,autoFocus:!0,onChange:N,suffix:e.jsx(wn,{style:{color:"rgba(0,0,0,.45)"}})})}),e.jsxs("div",{style:{padding:"8px 16px"},children:[e.jsxs(M,{align:"center",justify:"space-between",style:{marginBottom:8},children:[e.jsxs(M,{gap:8,children:[e.jsx(L,{size:"small",onClick:q,style:{padding:"4px 8px"},"data-testid":"entity-tree-filter-select-all",children:c("Select all")}),e.jsx(L,{onClick:o,size:"small",style:{padding:"4px 8px"},"data-testid":"entity-tree-filter-reset",children:c("Reset")})]}),e.jsx(Qt,{id:`${t}-toggle-show-full-tree`,label:c("Show full tree"),labelFontSize:14,checked:m,onChange:U,size:"sm"})]}),u&&e.jsx(zt,{}),!u&&e.jsxs(e.Fragment,{children:[e.jsx(go,{checkable:!0,checkStrictly:!0,defaultCheckedKeys:E,height:300,virtual:!1,showIcon:!1,selectable:!1,treeData:P.data,autoExpandParent:_,onExpand:A,expandedKeys:y,checkedKeys:{checked:E,halfChecked:f},onCheck:ee,className:Hn.tree,"data-testid":"entity-tree-filter-tree"}),e.jsxs("span",{style:{opacity:.7,marginTop:4},"data-testid":"entity-tree-filter-selected-count",children:[c("Selected"),": ",s.length]})]})]})]})})},Xw="_backBtn_17ik6_1",eC="_title_17ik6_23",Qr={backBtn:Xw,title:eC},{ArrowLeftIcon:tC}=Ce,Dn=({model:t,title:s,type:a,isLoadingSubmit:n,isDisabledSubmit:i,submitNode:r,onClose:o,onSubmit:c})=>{const{t:l}=T(),d=l(a==="create"?"Create":"Save");return e.jsxs(M,{align:"center",justify:"space-between",children:[e.jsxs(M,{align:"center",children:[o&&e.jsx("button",{className:Qr.backBtn,type:"button",onClick:o,children:e.jsx(tC,{width:40,height:40})}),e.jsx(G.Title,{level:2,className:Qr.title,"data-testid":`${a}-${t}-title-view`,children:s})]}),e.jsxs(ce,{children:[o&&e.jsx(L,{id:`${a}-${t}-cancel-btn`,onClick:o,size:"large",children:l("Cancel")},"back"),c&&!r&&e.jsx(L,{id:`${a}-${t}-submit-btn`,loading:n,onClick:c,type:"primary",htmlType:"submit",disabled:i,size:"large",children:d},"submit"),r]})]})},zs=(t=300,s)=>{const{t:a}=T(),[n,i]=h.useState(""),[r,o]=h.useState([]),c=Fs(n,t);h.useEffect(()=>{},[s]);const l=(p,m,g)=>{m(),i(p[0]),o(f=>[...f,g])};return{setSearchText:i,setSearchedColumn:o,getColumnSearch:p=>({filterDropdown:({setSelectedKeys:m,selectedKeys:g,confirm:f,close:x})=>e.jsxs("div",{style:{padding:8},onKeyDown:y=>y.stopPropagation(),children:[e.jsx(se,{placeholder:a("Search"),value:g[0],onChange:y=>m(y.target.value?[y.target.value]:[]),onPressEnter:()=>l(g,f,p),style:{marginBottom:8,display:"block"},defaultValue:s,"data-testid":`${p}-search-input`}),e.jsxs(ce,{style:{display:"flex",justifyContent:"right"},children:[e.jsx(L,{id:"close-search",size:"small",type:"text",onClick:()=>{x()},"data-testid":`${p}-search-close`,children:a("Close")}),e.jsx(L,{id:"submit-search",size:"small",type:"primary",onClick:()=>l(g,f,p),"data-testid":`${p}-search-submit`,children:a("Search")})]})]}),filterIcon:m=>e.jsx(wn,{style:{color:m?Oe.accent:void 0},"data-testid":`${p}-search-icon`}),render:m=>r.some(g=>g===p)?e.jsx(Lt,{searchWords:n,textToHighlight:m}):m}),onClear:()=>{i(""),o([])},searchText:n,searchedColumn:r,searchDebounce:c}},sa=({params:t,queryParamsSchema:s,updateParams:a})=>{const[n,i]=h.useState(!0),[r,o]=nt();h.useEffect(()=>{if(n)i(!1);else{const c=yt(s);if(ya(c,t))return;for(const[d,u]of Object.entries(t)){if(u===void 0||Array.isArray(u)&&!u.length||typeof u=="string"&&!u.length){r.delete(d);continue}r.set(d,String(u))}o(r)}},[t]),h.useEffect(()=>{if(!a||n)return;const c=yt(s);ya(c,t)||a(t)},[n,t,r.toString()])},sC=()=>{const{t}=T(),{showModal:s}=Ot(),a=ye(),n=z(Xu),i=z(eh),r=z(Fo),[o,c]=h.useState(null),{handleSubmit:l,reset:d,control:u,setValue:p,watch:m,getValues:g,formState:{isDirty:f}}=we({defaultValues:{email:r==null?void 0:r.email,first_name:r==null?void 0:r.first_name,last_name:r==null?void 0:r.last_name,password:"",confirm:"",username:r==null?void 0:r.username,is_active:!0,is_superuser:!1}}),[x,{isLoading:y}]=Pu(),[j]=Nu(),{onHandleError:_}=We(c),w=m("password"),b=m("confirm"),S=m("is_active"),C=m("is_superuser");h.useEffect(()=>{const[P,N]=g(["password","confirm"]);c(P!==N&&P&&N?{confirm:t("The passwords that you entered do not match!")}:null)},[w,b]),h.useEffect(()=>{i&&r?(p("username",r.username),p("email",r.email),p("first_name",r.first_name),p("last_name",r.last_name),p("is_active",r.is_active),p("is_superuser",r.is_superuser)):(p("is_active",!0),p("is_superuser",!0))},[i,r]);const v=async P=>{const[N,A,q,O]=g(["password","confirm","username","email"]),Y=i&&!N&&!A,ee=Y?{username:q,email:O}:{password:N,confirm:A,username:q,email:O},U={};if(Object.keys(ee).forEach(E=>{const D=E;ee[D]||(U[D]=t("This field can not be empty!"))}),N!==A&&N&&A&&(U.confirm=t("The passwords that you entered do not match!")),Object.keys(U).length){c(U);return}c(null),Y&&(delete P.password,delete P.confirm);try{i&&r?await j({id:r.id,body:P}).unwrap():await x({...P}).unwrap(),k(),H.success({message:t("Success"),closable:!0,description:t(i?"User updated successfully":"User created successfully")})}catch(E){_(E)}},k=()=>{a(Ku()),c(null),d()},$=()=>{if(!y){if(f){s(k);return}k()}};return{title:i?`${t("Edit User")} '${r==null?void 0:r.username}'`:t("Create User"),isShow:n,isEditMode:i,isLoading:y,isActive:S,isAdmin:C,isDirty:f,errors:o,control:u,handleCancel:$,handleSubmitForm:l(v)}},Pe=h.createContext({me:null,userConfig:null,updateConfig:async()=>{},isLoading:!1}),aC=({children:t})=>{const{data:s,isLoading:a}=Du(),{data:n,isLoading:i}=Fu({},{skip:!s}),[r]=qu(),o=ye(),c=z(th),l=async p=>{const m={...c,...p};o(Wu(m)),await r(m)},d=h.useMemo(()=>n?{...n,...c}:null,[n,c]),u=h.useMemo(()=>!s||!d?null:{me:s,userConfig:d,updateConfig:l,isLoading:a||i},[s,d,l,a,i]);return u?e.jsx(Pe.Provider,{value:u,children:t}):null},nC={token:{colorPrimary:"#425cd7",colorPrimaryHover:"#4e6bf3",colorInfo:"#425cd7",colorSuccess:"#4daf7c",colorWarning:"#efb622",colorError:"#c44d56",colorLink:"#425cd7",colorText:"#555",borderRadius:4,fontFamily:"Proxima"},components:{Layout:{siderBg:"#222",triggerBg:"#222",bodyBg:"#f6f6f6",footerBg:"#f6f6f6"},Menu:{colorPrimary:"#555",itemColor:"#ffffffa6",itemBg:"#222",itemSelectedBg:"rgba(85, 85, 85, 0.22);",itemSelectedColor:"#fff",itemHoverColor:"#fff",itemHoverBg:"rgba(85, 85, 85, 0.22);"},Switch:{handleSize:16,trackHeight:24,trackPadding:4,colorTextQuaternary:"#CBD0E2",colorTextTertiary:"#A8B1CE",trackHeightSM:16,handleSizeSM:10},Button:{fontWeight:600,fontSize:12,lineHeight:16},Table:{borderRadius:4,headerBg:"#f6f6f6"},Tag:{borderRadiusLG:100,borderRadiusSM:100,borderRadiusXS:100,fontSize:14,lineHeight:16,fontWeightStrong:600},Typography:{fontSizeHeading1:26,fontSizeHeading2:22,fontSizeHeading3:18,fontSizeHeading4:16,fontSizeHeading5:14},Form:{verticalLabelPadding:"0 0 5px 0",labelColor:"#6A6E83"},Checkbox:{borderRadiusSM:2}}},iC=({children:t})=>{const{i18n:s}=T(),[a,n]=h.useState(an()==="en"?Xi:er);return h.useEffect(()=>{String(a)!==s.language&&n(s.language==="en"?Xi:er)},[s.language]),e.jsx(Qd,{theme:nC,locale:a,children:t})},rC=({treeSettings:t,searchDebounce:s})=>{const{project:a}=h.useContext(J),{testPlanId:n}=Q(),[i]=nt(),[r]=Cn(),[o]=na(),c=h.useCallback(async(u,p)=>{const m=await r({project:a.id,page:u.page,parent:u.parent?Number(u.parent):null,page_size:Ae.defaultTreePageSize,ordering:`${t.plans.sortBy==="desc"?"-":""}${t.plans.filterBy}`,treesearch:s,is_archive:t.show_archived,_n:u._n,...p},!0).unwrap();return{data:fs(m.results,u),nextInfo:m.pages,_n:u._n}},[t.plans,t.show_archived,s]),l=h.useMemo(()=>[i.get("rootId"),s,t.show_archived,t.plans],[t.show_archived,t.plans,s,i.get("rootId")]);return{fetcher:c,fetcherAncestors:u=>o({project:a.id,id:Number(u)}).unwrap(),initDependencies:l,skipInit:!1,selectedId:n??null}},oC=({treeSettings:t,searchDebounce:s})=>{const{project:a}=h.useContext(J),{testSuiteId:n}=Q(),[i]=nt(),[r]=Os(),[o]=ia(),c=h.useCallback(async(u,p)=>{const m=await r({project:a.id,page:u.page,parent:u.parent?Number(u.parent):null,page_size:Ae.defaultTreePageSize,ordering:`${t.suites.sortBy==="desc"?"-":""}${t.suites.filterBy}`,treesearch:s,_n:u._n,...p},!0).unwrap();return{data:fs(m.results,u),nextInfo:m.pages,_n:u._n}},[t.suites,s]),l=h.useMemo(()=>[i.get("rootId"),s,t.suites],[t.suites,s,i.get("rootId")]);return{fetcher:c,fetcherAncestors:u=>o({project:a.id,id:Number(u)}).unwrap(),initDependencies:l,skipInit:!1,selectedId:n??null}},Us=h.createContext(null),lC=({children:t})=>{const[s]=nt(),a=Nt(),n=h.useRef(null),i=h.useRef(null),[r,o]=h.useState(ol()),[c,l]=h.useState(s.get("treeSearch")??""),d=Fs(c,250,!0),u=s.get("rootId"),p=h.useMemo(()=>{switch(l(""),!0){case a.pathname.includes("suites"):return"suites";case a.pathname.includes("plans"):return"plans";default:return"suites"}},[a.pathname]),m=oC({treeSettings:r,searchDebounce:d}),g=rC({treeSettings:r,searchDebounce:d}),f=y=>{o(j=>{const _={...j,...y};return jg(_),_})},x=h.useMemo(()=>{const y=p==="suites"?m.initDependencies:g.initDependencies;return{...{treebar:p==="suites"?n:i,searchText:c,treeSettings:r,initParent:u,updateTreeSettings:f,setSearchText:l,activeTab:p},...p==="suites"?m:g,initDependencies:[...y,p]}},[u,p,m,g]);return p?e.jsx(Us.Provider,{value:x,children:t}):null},cC="или",dC="и",uC="да",hC="нет",pC="ID",mC="Действие",gC="Группа",xC="Проект",fC="Проекты",jC="Пользователь",yC="Пользователи",_C="Профиль",bC="Избранное",vC="Архивный",SC="Архивные",wC="Обзор",CC="Тест",TC="Тесты",kC="Выйти",IC="Успешно",$C="Обновлен",LC="Создан",AC="Кейс",PC="Никто",NC="Статусы",RC="Да",DC="Нет",MC="Всего",FC="Создать",EC="Обновить",BC="Изменить",OC="Удалить",qC="Отменить",zC="Закрыть",UC="Лейбл",VC="Параметр",HC="Параметры",YC="Результат",WC="Расширить",QC="Поиск",GC="Выбрать",KC="Копировать",JC="Сохранить",ZC="Описание",XC="Архивировать",e1="Статистика",t1="Имя",s1="Оценка",a1="Лейблы",n1="Тип",i1="Ответственный",r1="Предусловия",o1="Сценарий",l1="Ожидаемый результат",c1="Атрибуты",d1="Обязательный",u1="Родитель",h1="Выбрано",p1="Набор",m1="Количество",g1="Вложения",x1="Постусловия",f1="Шаги",j1="Клонировать",y1="шаг",_1="Комментарий",b1="Комментарии",v1="Статус",S1="Основное",w1="Имя пользователя",C1="Почта",T1="Пароль",k1="Войти",I1="Неавторизован",$1="Админ",L1="Активный",A1="Иконка",P1="Администрация",N1="Приватный",R1="Архивировано",D1="Ok",M1="Причина",F1="Настройки",E1="Результаты",B1="Архивация",O1="Удаление",q1="Внимание",z1="Активность",U1="Добавить",V1="Время",H1="Восстановить",Y1="Отправить",W1="обновлен",Q1="создан",G1="архивирован",K1="скопирован",J1="восстановлен",Z1="успешно",X1="неизвестно",eT="добавлен",tT="удален",sT="удален",aT="Сбросить",nT="наборы",iT="Оценка",rT="История",oT="планов",lT="Цвет",cT="Версия",dT="Роли",uT="Действия",hT="Возрастанию",pT="Убыванию",mT="отредактировано",gT="Уведомления",xT="Сообщение",fT="Инициатор",jT="Включено",yT="Сообщения",_T="версия",bT="Авторские права",vT="проблеме",ST="Переименовать",wT="Очистить",CT="Фильтр",TT="Сортировка",kT="обязательно",Gr={or:cC,and:dC,yes:uC,no:hC,ID:pC,Action:mC,Group:gC,Project:xC,Projects:fC,User:jC,Users:yC,Profile:_C,Favorites:bC,Archival:vC,Archives:SC,Overview:wC,Test:CC,Tests:TC,Logout:kC,Success:IC,Updated:$C,Created:LC,Case:AC,Nobody:PC,Statuses:NC,Yes:RC,No:DC,"Collapse All":"Свернуть всё","Create child":"Создать дочерний","Test Plan":"Тест План","Test Plans":"Тест Планы","Test Suite":"Тестовый Набор","Test Suites":"Тестовые Наборы","Test Case":"Тест Кейс","Test Suites & Cases":"Тестовые Наборы & Кейсы","Test Plans & Results":"Тест Планы & Результаты","Test Cases":"Тест Кейсы","Executed tests progress":"Ход выполнения тестов","Filter by test result attribute":"Фильтр по атрибуту результата теста","Filter by Status":"Фильтр по статусу","Search by attribute":"Поиск по атрибуту",Total:MC,Create:FC,Update:EC,Edit:BC,Delete:OC,Cancel:qC,Close:zC,Label:UC,Parameter:VC,Parameters:HC,Result:YC,Expand:WC,Search:QC,Select:GC,Copy:KC,Save:JC,Description:ZC,Archive:XC,Statistic:e1,Name:t1,Estimate:s1,Labels:a1,Type:n1,Assignee:i1,"Assign To":"Назначить","Assign To Me":"Назначить меня",Setup:r1,Scenario:o1,Expected:l1,Attributes:c1,Required:d1,Parent:u1,Selected:h1,Suite:p1,Count:m1,Attachments:g1,Teardown:x1,Steps:f1,Clone:j1,step:y1,Comment:_1,Comments:b1,Status:v1,General:S1,Username:w1,Email:C1,Password:T1,Login:k1,Unauthorized:I1,Admin:$1,Active:L1,Icon:A1,Administration:P1,Private:N1,Archived:R1,Ok:D1,Reason:M1,Settings:F1,Results:E1,Archiving:B1,Deleting:O1,Attention:q1,Activity:z1,Add:U1,Time:V1,Restore:H1,Send:Y1,updated:W1,created:Q1,archived:G1,copied:K1,restore:J1,successfully:Z1,unknown:X1,added:eT,deleted:tT,removed:sT,Reset:aT,suites:nT,Estimates:iT,History:rT,plans:oT,Color:lT,Version:cT,Roles:dT,Actions:uT,"Attention! This isn't the latest version.":"Внимание! Это не последняя версия.","Load more":"Загрузить еще","Add comment":"Добавить комментарий","Move test to plan":"Переместить тест в план","Save order":"Сохранить заказ","No attachments":"Нет вложений","Apply to steps":"Применить к шагам","Describe your test result.":"Опишите результат вашего теста.","Set the test status (passed, failed etc.).":"Установите статус теста (пройден, провален и т.д.).","Add to favorites":"Добавить к избранным","has been added to favorites":"был добавлен к избранным","has been removed to favorites":"был удален из избранных","Project status settings":"Настройки статусов проекта","Password updated successfully":"Пароль успешно обновлен","No matches":"Нет совпадений","Search a user":"Поиск пользователя","Search Unassigned":"Поиск  по не назначенным","Shown columns":"Видимые столбцы","Select all":"Выбрать всё","to favorites":"из избранных","has been":"был",Ascending:hT,Descending:pT,"Filter by":"Фильтровать по","Sort by":"Сортировать по","Order by":"Порядок по","Type a comment":"Введите комментарий","Create status":"Создать статус","Edit status":"Изменить статус","Status updated successfully":"Статус успешно обновлен","Status created successfully":"Статус успешно создан","Status deleted successfully":"Статус успешно удален","Include Test Cases Assignment":"Сохранить ответственных за тесты","Project is required":"Проект обязателен для заполнения","New plan name is required":"Новое имя тест плана обязательно","New name is not be empty":"Новое имя не может быть пустым","An element cannot be a child of itself.":"Элемент не может быть потомком самому себе.","Test Suite cannot be its own parent.":"Тестовый набор не может быть родителем для самого себя.","Test Plan cannot be its own parent.":"Тестовый план не может быть родителем для самого себя.","Error when try to change follow project":"Ошибка при попытке изменить избранный проект","This field can not be empty!":"Это поле не может быть пустым!","The passwords that you entered do not match!":"Введённые пароли не совпадают!","Is Private":"Приватный","Is Favorite":"Избранный","No Comment":"Нет комментариев","load more":"загрузить ещё","ver.":"вер.","Actual ver.":"Актуальная вер.","Add Result":"Добавить результат","No test results":"Нет тестовых результатов","Access Management":"Управление доступом","Custom Attributes":"Кастомные Атрибуты","Test Results":"Тестовые Результаты","Add step":"Добавить шаг","Remember me":"Запомнить меня","First Name":"Имя","Last Name":"Фамилия","Add attribute":"Добавить атрибут","Verbose Name":"Подробное имя","Verbose Name Related Model":"Подробное название, связанное с моделью","Error!":"Ошибка!","Search a test plan":"Поиск тестового плана","Keep Assignee":"Сохранить ответственного","Not estimated tests statistics":"Неоцененная статистика тестов","Show Archived":"Показать архивные","Common Filters":"Общие Фильтры","Tests Count":"Количество Тестов","Tests Estimates":"Оценка Тестов","Tests Count Histogram":"Количество Тестов Гистограмма","Applied To":"Применить к","Last status":"Последний статус","Required field":"Обязательное поле","Maximum length":"Максимальная длина","Maximum length 255":"Максимальная длина 255","Hide more":"Скрыть больше","Show more":"Показать больше","Start date":"Дата начала","Due date":"Ожидаемая дата завершения","Finish date":"Дата завершения","Select Test Plan":"Выберите Тест План","Sort By":"Сортировать","Create User":"Создать пользователя","Edit User":"Изменить пользователя","Copy Test Case":"Копировать Тест Кейс","Move tests":"Переместить тесты","Parent plan":"Родительский план","Please enter a name":"Пожалуйста введите имя","Do you want to close?":"Вы хотите закрыть?","You will lose your data if you continue!":"Если вы продолжите, вы потеряете свои данные!","Create Custom Attribute":"Создать Кастомный Атрибут","Custom Attribute":"Кастомный Атрибут","Suite specific":"Определённые Тестовые Наборы","Edit Test Suite":"Изменить Тестовый Набор","Copy Test Suite":"Копировать Тестовый Набор","Copy Test Plan":"Копировать Тест План","New Plan name":"Название нового Тест Плана","Create Test Suite":"Создать Тестовый Набор","Create Child Test Suite":"Создать Дочерний Тестовый Набор","Create child suite":"Создать дочерний набор","Create Child Test Plan":"Создать Дочерний Тест План","Create child plan":"Создать дочерний план","View activity":"Посмотреть активность","Clear filters and sorters":"Очистить фильтры и сортировку","Drop files here to attach, or click to browse":"Перетащите файлы сюда или нажмите, чтобы открыть через браузер","Do you want to delete these label?":"Вы хотите удалить этот лейбл?","Do you want to delete these parameter?":"Вы хотите удалить этот параметр?","Do you want to delete these status?":"Вы хотите удалить этот статус?","Do you want to delete this filter?":"Вы хотите удалить этот фильтр?","Filter deleted successfully":"Фильтр успешно удален","Label deleted successfully":"Лейбл успешно удален","Parameter created successfully":"Параметр успешно создан","Parameter updated successfully":"Параметр успешно изменен","Parameter deleted successfully":"Параметр успешно удален","Do you want to delete this comment?":"Вы хотите удалить этот комментарий?","Comment deleted successfully":"Комментарий успешно удален","Do you want to delete these attribute?":"Вы хотите удалить этот атрибут?","Attribute deleted successfully":"Атрибут успешно удален","Do you want to delete these user?":"Вы хотите удалить этого пользователя?","Create label":"Создание лейбла","Edit label":"Изменение лейбла","Label created successfully":"Лейбл успешно создан","Label updated successfully":"Лейбл успешно изменен","User created successfully":"Пользователь успешно создан","User updated successfully":"Пользователь успешно изменен","User deleted successfully":"Пользователь успешно удален","Delete attribute":"Удалить атрибут",edited:mT,"added a comment":"добавил комментарий","Text value":"Текст","List value":"Список","JSON value":"JSON","Avatar was updated successfully":"Аватарка успешно обновлена","Showing detail in console log.":"Посмотретите детали в консоли браузера.","Do you want to delete user from project?":"Вы хотите удалить пользователя из проекта?","Project deleted successfully":"Проект успешно удален","Parent Test Suite":"Родительский Тестовый Набор","Search a test suite":"Поиск тестового набора","New Suite name":"Название нового Тестовго Набора","New Test Case name":"Название нового Тест Кейса","Attribute created successfully":"Аттрибут успешно создан","Attribute edited successfully":"Аттрибут успешно изменен","Edit Test Result":"Изменить Тестовый Результат","Clone Test Result":"Клонировать Тестовый Результат","Please select":"Пожалуйста выберите","Please select roles":"Пожалуйста выберите роли","Please select project":"Пожалуйста выберите проект","Update current version":"Обновить текущую версию","Select a test suite":"Выберите тестовый набор","General Details":"Основные детали","No Server Response":"Нет ответа от сервера","Missing Username or Password":"Неправильное имя пользователя или пароль","Login Failed":"Ошибка входа","Upload icon":"Загрузить иконку","Delete icon":"Удалить иконку","is not a png or jpg file":"не является файлом png или jpg","You are not able to manage this project":"Вы не можете управлять этим проектом","You are not able to view this project":"Вы не можете просматривать этот проект","Edit comment":"Изменить комментарий","Upload file":"Загрузить файл","Edit Project":"Изменить Проект","Create Test Case":"Создать Тест Кейс","Edit Test Case":"Изменить Тест Кейс","Please confirm to change suite.":"Пожалуйста подтвердите изменение тестового набора.","Do you want to change suite?":"Вы хотите изменить тестовый набор?","Do you want to restore this version of test case?":"Вы хотите восстановить тест кейс с этой версией?","Clone test result":"Клонировать тестовый результат","Project test results settings":"Настройки тестовых результатов проекта","Edit project test results settings":"Изменить настройки тестовых результатов проекта","Is Editable":"Редактируемый","Edit time":"Изменить время","Edit Profile":"Изменить Профиль","Profile updated successfully":"Профиль успешно обновлен","Add user to project":"Добавить пользователя в проект","Edit user project access":"Редактировать доступ пользователя к проекту","User assign error":"Ошибка назначения пользователя","User assigned successfully":"Пользователь успешно назначен","Change password":"Изменить пароль","Confirm Password":"Подтвердите пароль","Failed to send a reqeust":"Не удалось отправить запрос","Request has been sent":"Запрос был отправлен","Request Access":"Запросить доступ","Request access to":"Запросить доступ к","Search by test or user":"Поиск по тесту или пользователю","the selected data in this table will remove it from view":"выбранных данных в этой таблице приведет к их удалению только из просмотра","Start Date":"Дата начала","Created At":"Дата создания","Select suite":"Выбрать тестовый набор","Already added":"Уже добавлен","New label":"Новый лейбл","No data":"Нет данных","Table view":"Вид таблицы","Tree view":"Вид дерева",Notifications:gT,Message:xT,Actor:fT,"Notification settings":"Настройки уведомлений","Mark as read":"Отметить как прочитанное","Mark as unread":"Отметить как непрочитанное",Enabled:jT,Messages:yT,"User access deleted successfully":"Доступ пользователя успешно отозван","Filter & sort":"Фильтр & сортировка",version:_T,"Released under the AGPL-v3 License":"Размещено под лицензией AGPL-v3","Found a bug or have a comment?":"Нашли ошибку или есть комментарий?",Copyright:bT,"Please report an":"Пожалуйста, сообщите о",issue:vT,"email us":"по электронной почте","Reset filter":"Сбросить фильтр","Save Changes":"Сохранить изменения","Save as New Filter":"Сохранить как новый фильтр",Rename:ST,"Name filter cant be empty!":"Имя фильтра не может быть пустым!","Filter created successfully":"Фильтр успешно создан","Filter updated successfully":"Фильтр успешно изменен","Filter name":"Имя фильтра","New Filter":"Новый фильтр","Saved Filters":"Сохраненные фильтры",Clear:wT,"Filter by Test Plans":"Фильтровать по Тест Планам","Filter by Test Suites":"Фильтровать по Тестовым Наборам","Show full tree":"Показать полное дерево",Filter:CT,Sort:TT,"Name or ID":"Имя или ID","Assigned to me":"Добавить себя","Test Plan Start Date":"Дата начала Тест Плана","Test Plan Created At":"Дата создания Тест Плана","Test Suite Created At":"Дата создания Тестового Набора","Test Case Created At":"Дата создания Тест Кейса","Test Created At":"Дата создания Теста","Unsaved Changes":"Несохранённые изменения","Result Status":"Статус Результата","No custom attributes":"Нет кастомных аттрибутов",required:kT,"Not supported yet":"Не поддерживается в этой версии","Not Assigned":"Не назначено","At least one applied to must be active":"Необходимо выбрать хотя бы один активным","Attribute name":"Имя аттрибута","Copy link":"Скопировать ссылку"},IT=t=>{const s={};return Object.keys(t).forEach(a=>{s[a]=a}),s},$T={en:{translation:IT(Gr)},ru:{translation:Gr}},LT=({step:t,isEdit:s,onSubmit:a,onCloseModal:n})=>{var b,S,C;const{t:i}=T(),{isLoading:r,isDirty:o,errors:c,control:l,attachments:d,attachmentsIds:u,handleClose:p,handleSubmit:m,onSubmitForm:g,onLoad:f,setAttachments:x,setValue:y,onChange:j,register:_,onRemove:w}=Fg({step:t,isEdit:s,onSubmit:a,onCloseModal:n});return e.jsx(he,{className:"test-case-steps-modal",title:`${i(s?"Edit":"Create")} ${i("step")}`,open:!!t,onCancel:p,centered:!0,footer:[e.jsx(L,{id:"modal-steps-cancel-btn",onClick:p,children:i("Cancel")},"back"),e.jsx(L,{id:s?"modal-steps-edit-btn":"modal-steps-create-btn",type:"primary",onClick:m(g),loading:r,disabled:!o,children:i(s?"Update":"Create")},"submit")],children:e.jsxs(R,{id:"test-case-steps-form",layout:"vertical",onFinish:m(g),children:[e.jsx(R.Item,{label:i("Name"),validateStatus:c!=null&&c.name?"error":"",help:((b=c==null?void 0:c.name)==null?void 0:b.message)??"",required:!0,children:e.jsx(F,{name:"name",control:l,rules:{maxLength:{value:255,message:i("Maximum length 255")},required:{value:!0,message:i("Required field")}},render:({field:v})=>e.jsx(se,{...v,"data-testid":"test-case-steps-name-input"})})}),e.jsx(R.Item,{label:i("Scenario"),validateStatus:c!=null&&c.scenario?"error":"",help:((S=c.scenario)==null?void 0:S.message)??"",required:!0,children:e.jsx(F,{name:"scenario",control:l,render:()=>e.jsx(F,{name:"scenario",control:l,rules:{required:{value:!0,message:i("Required field")}},render:({field:v})=>e.jsx(lt,{uploadId:"step-scenario",fieldProps:v,stateAttachments:{attachments:d,setAttachments:x},customRequest:f,setValue:y})})})}),e.jsx(R.Item,{label:i("Expected"),validateStatus:c!=null&&c.expected?"error":"",help:((C=c==null?void 0:c.expected)==null?void 0:C.message)??"",children:e.jsx(F,{name:"expected",control:l,render:({field:v})=>e.jsx(lt,{uploadId:"step-expected",fieldProps:v,stateAttachments:{attachments:d,setAttachments:x},customRequest:f,setValue:y})})}),e.jsx(mt.DropFiles,{attachments:d,attachmentsIds:u,onChange:j,onLoad:f,onRemove:w,register:_,idInput:"test-case-steps-attachments-input"})]})})},AT="_wrapper_6txai_1",PT="_ul_6txai_15",NT="_ghostClass_6txai_31",Yn={wrapper:AT,ul:PT,ghostClass:NT},bc=({steps:t,setSteps:s})=>{const{t:a}=T(),{handleStep:n,handleSortSteps:i,handleDeleteStep:r,handleClickCloseModal:o,handleClickEditStep:c,isEdit:l,modalStep:d,handleSubmit:u}=Mg({steps:t,setSteps:s});return e.jsxs("div",{className:Yn.wrapper,children:[e.jsx(L,{id:"add-step",size:"middle",icon:e.jsx(ct,{}),onClick:n,children:a("Add step")},"add-step"),e.jsx("ul",{className:Yn.ul,children:e.jsx(Gd.ReactSortable,{list:t.map(p=>({...p,chosen:!1})),setList:i,animation:150,ghostClass:Yn.ghostClass,handle:".handle",children:t.map((p,m)=>e.jsx($a.Step,{step:p,index:m,actions:{onClickDelete:r,onClickEdit:c}},p.sort_order))})}),e.jsx(LT,{isEdit:l,step:d,onCloseModal:o,onSubmit:u})]})},bn=({control:t})=>{const{t:s}=T();return e.jsxs(M,{style:{width:"100%"},align:"center",justify:"space-between",children:[e.jsx("span",{children:s("Scenario")}),e.jsx(F,{name:"is_steps",control:t,render:({field:a})=>e.jsx(Qt,{id:"edit-steps-toggle",label:s("Steps"),checked:a.value,onChange:a.onChange,size:"sm"})})]})},RT="_formItem_1waex_1",Kr={formItem:RT},Jr=t=>({name:"",scenario:"",project:t,suite:void 0,expected:"",setup:"",teardown:"",estimate:null,description:"",attachments:[],steps:[],is_steps:!1,labels:[],attributes:[]}),DT=()=>{const{t}=T(),{project:s}=h.useContext(J),{showModal:a}=Ot(),{testSuiteId:n}=Q(),[i,r]=h.useState("general"),[o]=nt(),c=De(),[l,d]=h.useState(null),{handleSubmit:u,reset:p,control:m,setValue:g,register:f,setError:x,formState:{isDirty:y,errors:j},watch:_}=we({defaultValues:Jr(s.id)}),w=_("is_steps"),b=_("steps"),[S,{isLoading:C}]=Og(),{onHandleError:v}=We(d),{attachments:k,attachmentsIds:$,isLoading:I,setAttachments:P,onRemove:N,onLoad:A,onChange:q,onReset:O}=ls(m,s.id),Y=Bi({setValue:g,testCase:null,isShow:!0,isEditMode:!1}),{attributes:ee,initAttributes:U,resetAttributes:E,addAttribute:D,onAttributeChangeName:ae,onAttributeChangeType:oe,onAttributeChangeValue:te,onAttributeRemove:B}=_l({mode:"create",setValue:g}),{setIsRedirectByUser:ie}=Eo({isDirty:y,pathname:"new-test-case"}),ke=pe=>{const _e=o.get("prevSearch");let Ue=`/projects/${s.id}/suites/${n}`;if(pe!==void 0&&(Ue+=`?test_case=${pe}`),!_e){c(Ue);return}const Ze=Po(_e);pe!==void 0?Ue+=`&${Ze}`:Ue+=`?${Ze}`,c(Ue)},qe=pe=>{ie(),ke(pe),d(null),r("general"),p(),O(),E(),Y.setLabels([]),Y.setSearchValue("")},Qe=pe=>{r(pe)},ge=({id:pe,name:_e,scenario:Ue,expected:Ze,sort_order:Ne,attachments:Xe})=>({id:typeof pe=="string"?void 0:pe,name:_e,scenario:Ue,expected:Ze,sort_order:Ne,attachments:Xe.map(_t=>typeof _t=="object"?_t.id:_t)}),rt=async pe=>{var Xe,_t,Me;const _e=pe,{isSuccess:Ue,attributesJson:Ze,errors:Ne}=ps(ee);if(!Ue){d({attributes:JSON.stringify(Ne)});return}if(pe.is_steps&&!((Xe=pe.steps)!=null&&Xe.length)){x("steps",{type:"required",message:t("Required field")});return}if(!pe.is_steps&&!((_t=pe.scenario)!=null&&_t.length)){x("scenario",{type:"required",message:t("Required field")});return}d(null);try{const et=_e.steps?_e.steps.map(Ie=>ge(Ie)):[],tt=await S({..._e,project:s.id,is_steps:!!_e.is_steps,scenario:_e.is_steps?void 0:_e.scenario,steps:_e.is_steps?et:void 0,estimate:(Me=_e.estimate)!=null&&Me.length?_e.estimate:void 0,suite:Number(n),attributes:Ze}).unwrap();qe(tt.id),H.success({message:t("Success"),closable:!0,description:e.jsx(Re,{id:String(tt.id),action:"created",title:t("Test Case"),link:`/projects/${s.id}/suites/${n}?test_case=${tt.id}`})})}catch(et){v(et)}},ze=()=>{if(!C){if(y){a(qe);return}qe()}};return h.useEffect(()=>{U.length&&p({...Jr(s.id),attributes:U})},[U]),{isLoading:C||I,errors:l,formErrors:j,control:m,attachments:k,attachmentsIds:$,steps:b??[],isSteps:w,isDirty:y,tab:i,attributes:ee,onLoad:A,onRemove:N,onChange:q,setValue:g,setAttachments:P,handleCancel:ze,handleSubmitForm:u(rt),register:f,labelProps:Y,handleTabChange:Qe,addAttribute:D,onAttributeChangeName:ae,onAttributeChangeType:oe,onAttributeChangeValue:te,onAttributeRemove:B}},MT=()=>{var N,A,q;const{t}=T(),{isLoading:s,errors:a,formErrors:n,control:i,attachments:r,attachmentsIds:o,steps:c,isSteps:l,isDirty:d,tab:u,attributes:p,labelProps:m,onLoad:g,onRemove:f,onChange:x,setValue:y,setAttachments:j,handleCancel:_,handleSubmitForm:w,register:b,handleTabChange:S,addAttribute:C,onAttributeChangeName:v,onAttributeChangeType:k,onAttributeChangeValue:$,onAttributeRemove:I}=DT(),P=l?c.length?"":t("Required field"):((N=n.scenario)==null?void 0:N.message)??(a==null?void 0:a.scenario)??"";return e.jsxs(e.Fragment,{children:[e.jsx(Dn,{model:"test-case",type:"create",isDisabledSubmit:!d,isLoadingSubmit:s,onSubmit:w,onClose:_,title:e.jsxs(e.Fragment,{children:[t("Create")," ",t("Test")," ",t("Case")]})}),a?e.jsx(it,{error:a,skipFields:["name","setup","scenario","teardown","estimate","attributes"]}):null,e.jsx(R,{id:"create-test-case-form",layout:"vertical",onFinish:w,children:e.jsxs(dt,{defaultActiveKey:"general",onChange:S,activeKey:u,children:[e.jsx(dt.TabPane,{tab:t("General"),children:e.jsxs(Ye,{gutter:[32,32],style:{marginTop:14},children:[e.jsxs(Le,{span:12,children:[e.jsx(R.Item,{label:t("Name"),validateStatus:((A=n.name)==null?void 0:A.message)??(a==null?void 0:a.name)?"error":"",help:((q=n.name)==null?void 0:q.message)??(a==null?void 0:a.name)??"",required:!0,children:e.jsx(F,{name:"name",control:i,rules:{required:t("Required field")},render:({field:O})=>e.jsx(se,{...O,id:"create-name-input"})})}),e.jsx(R.Item,{label:t("Description"),validateStatus:a!=null&&a.description?"error":"",help:a!=null&&a.description?a.description:"",children:e.jsx(F,{name:"description",control:i,render:({field:O})=>e.jsx(lt,{uploadId:"create-description",textAreaId:"create-description-textarea",fieldProps:O,stateAttachments:{attachments:r,setAttachments:j},customRequest:g,setValue:y})})}),e.jsx(R.Item,{label:t("Setup"),validateStatus:a!=null&&a.setup?"error":"",help:a!=null&&a.setup?a.setup:"",children:e.jsx(F,{name:"setup",control:i,render:({field:O})=>e.jsx(lt,{uploadId:"create-setup",textAreaId:"create-setup-textarea",fieldProps:O,stateAttachments:{attachments:r,setAttachments:j},customRequest:g,setValue:y})})}),!l&&e.jsx(R.Item,{label:e.jsx(bn,{control:i}),validateStatus:P?"error":"",help:P,required:!0,className:Kr.formItem,children:e.jsx(F,{name:"scenario",control:i,render:({field:O})=>e.jsx(lt,{uploadId:"create-scenario",textAreaId:"create-scenario-textarea",customRequest:g,fieldProps:O,stateAttachments:{attachments:r,setAttachments:j},setValue:y})})}),l&&e.jsx(R.Item,{label:e.jsx(bn,{control:i}),validateStatus:P?"error":"",help:P,required:!0,className:Kr.formItem,children:e.jsx(F,{name:"steps",control:i,render:({field:O})=>e.jsx(bc,{steps:O.value??[],setSteps:O.onChange})})}),!l&&e.jsx(R.Item,{label:t("Expected"),validateStatus:a!=null&&a.expected?"error":"",help:a!=null&&a.expected?a.expected:"",children:e.jsx(F,{name:"expected",control:i,render:({field:O})=>e.jsx(lt,{uploadId:"create-expected",textAreaId:"create-expected-textarea",fieldProps:O,stateAttachments:{attachments:r,setAttachments:j},customRequest:g,setValue:y})})}),e.jsx(R.Item,{label:t("Teardown"),validateStatus:a!=null&&a.teardown?"error":"",help:a!=null&&a.teardown?a.teardown:"",children:e.jsx(F,{name:"teardown",control:i,render:({field:O})=>e.jsx(lt,{uploadId:"create-teardown",textAreaId:"create-teardown-textarea",fieldProps:O,stateAttachments:{attachments:r,setAttachments:j},customRequest:g,setValue:y})})})]}),e.jsxs(Le,{span:12,children:[e.jsx(R.Item,{label:t("Estimate"),validateStatus:a!=null&&a.estimate?"error":"",help:a!=null&&a.estimate?a.estimate:"",children:e.jsx(F,{name:"estimate",control:i,render:({field:O})=>e.jsx(se,{...O,id:"create-estimate-input","data-testid":"create-estimate-input",value:O.value??"",suffix:e.jsx(fc,{title:Ae.estimateTooltip})})})}),e.jsx(R.Item,{label:t("Labels"),validateStatus:a!=null&&a.labels?"error":"",help:a!=null&&a.labels?a.labels:"",children:e.jsx(F,{name:"labels",control:i,render:({field:O})=>e.jsx(Ui,{labelProps:m,fieldProps:O})})}),e.jsx(F,{name:"attributes",control:i,render:({field:O})=>e.jsxs(Ye,{style:{flexDirection:"column",marginTop:c.length?24:0},children:[e.jsx(oa,{attributes:p,onChangeName:v,onChangeType:k,onChangeValue:$,onRemove:I,onBlur:O.onBlur,errors:a!=null&&a.attributes?JSON.parse(a==null?void 0:a.attributes):void 0}),e.jsx(ra,{onClick:C})]})})]})]})},"general"),e.jsx(dt.TabPane,{tab:t("Attachments"),children:e.jsx(mt.DropFiles,{attachments:r,attachmentsIds:o,onChange:x,onLoad:g,onRemove:f,register:b,idInput:"create-test-case-attachments-input"})},"attachments")]})})]})},FT="_treeBlock_635o4_1",ET="_nodeBody_635o4_21",BT="_infoIcon_635o4_53",OT="_nodeLeftAction_635o4_79",qT="_arrowIcon_635o4_99",zT="_arrowIconOpen_635o4_119",UT="_loader_635o4_129",VT="_activeNode_635o4_147",HT="_isRoot_635o4_157",YT="_isLast_635o4_165",WT="_noborder_635o4_173",QT="_name_635o4_189",GT="_activeLink_635o4_203",is={treeBlock:FT,nodeBody:ET,infoIcon:BT,nodeLeftAction:OT,arrowIcon:qT,arrowIconOpen:zT,loader:UT,activeNode:VT,isRoot:HT,isLast:YT,noborder:WT,name:QT,activeLink:GT},{ArrowIcon:KT}=Ce,JT=({node:t,onSelect:s,selectedId:a})=>{var c;const n=t.props.level*20,i=async l=>{l.stopPropagation(),await t.open()},r=async()=>{await t.more()},o=()=>{if(t.tree.selectedId===t.id){t.tree.updateSelectId(null),s(null);return}t.tree.updateSelectId(t.id),s(t)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:`${t.title}-${t.id}`,style:{paddingLeft:n},children:e.jsxs("div",{className:V(is.nodeBody,{[is.activeNode]:a===t.id,[is.isRoot]:t.isRoot,[is.isLast]:t.isLast}),onClick:o,children:[e.jsxs("div",{className:is.nodeLeftAction,children:[t.props.isLoading&&e.jsx(St,{size:"small",className:is.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(KT,{className:V(is.arrowIcon,{[is.arrowIconOpen]:t.props.isOpen}),onClick:i})]}),e.jsx("span",{children:t.data.name})]})},`${t.title}-${t.id}-treeview-suite`),((c=t.parent)==null?void 0:c.props.hasMore)&&t.isLast&&e.jsx(Ra,{isLoading:t.parent.props.isLoading,node:t,onMore:r,isRoot:t.isRoot,isLast:t.isLast})]})},ZT=({suite:t,onChange:s})=>{var _;const{t:a}=T(),{project:n}=h.useContext(J),[i,r]=h.useState(!1),[o,c]=h.useState(""),l=Fs(o,250,!0),[d,u]=h.useState(t),[p]=Os(),[m]=ia(),g=async w=>{const b=await p({project:n.id,page:w.page,parent:w.parent?Number(w.parent):null,page_size:Ae.defaultTreePageSize,ordering:"name",treesearch:l,_n:w._n},!0).unwrap();return{data:fs(b.results,w),nextInfo:b.pages,_n:w._n}},f=w=>m({project:n.id,id:Number(w)}).unwrap(),x=w=>{c(w.target.value)},y=w=>{w&&u({value:w.data.id,label:w.data.name})},j=()=>{d&&(s(d),r(!1))};return h.useEffect(()=>{u(t)},[t]),e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx(se,{id:"suite-edit-input",value:(_=t==null?void 0:t.label)==null?void 0:_.toString(),readOnly:!0,style:{width:"100%"},onClick:()=>r(!0)})}),e.jsxs(he,{title:a("Select suite"),open:i,onCancel:()=>r(!1),width:"700px",className:"select-suite-modal",footer:[e.jsx(L,{id:"close-btn",onClick:()=>r(!1),children:a("Close")},"back"),e.jsx(L,{id:"select-suite",type:"primary",onClick:j,children:a("Select")},"submit")],children:[e.jsx(mi,{style:{marginBottom:8},placeholder:a("Search"),onChange:x}),e.jsx("div",{className:is.treeBlock,children:e.jsx(qs,{fetcher:g,fetcherAncestors:f,initDependencies:[l,i],selectedId:d==null?void 0:d.value,renderNode:w=>e.jsx(JT,{node:w,selectedId:d==null?void 0:d.value,onSelect:y})})})]})]})},XT="_formItem_1waex_1",Zr={formItem:XT},e0=t=>t.sort((a,n)=>a.sort_order-n.sort_order).map((a,n)=>({...a,sort_order:n+1})),t0=()=>{const{t}=T(),{project:s}=h.useContext(J),{showModal:a}=Ot(),n=De(),{testSuiteId:i}=Q(),[r,o]=nt(),c=r.get("test_case"),[l,d]=h.useState("general"),{data:u,isLoading:p}=yl({testCaseId:String(c)},{skip:!c}),[m,g]=h.useState(null),{handleSubmit:f,reset:x,control:y,setValue:j,register:_,setError:w,clearErrors:b,formState:{isDirty:S,errors:C},watch:v}=we({defaultValues:{name:"",description:"",setup:"",scenario:"",expected:"",teardown:"",estimate:null,is_steps:!1,labels:[],suite:void 0,attributes:[],attachments:[],steps:[]}}),k=v("is_steps"),$=v("steps"),[I,P]=h.useState(null),[N,{isLoading:A}]=qg(),{onHandleError:q}=We(g),{attachments:O,attachmentsIds:Y,isLoading:ee,setAttachments:U,onRemove:E,onLoad:D,onChange:ae,onReset:oe}=ls(y,s.id),{attributes:te,isLoading:B,setAttributes:ie,addAttribute:ke,onAttributeChangeName:qe,onAttributeChangeType:Qe,onAttributeChangeValue:ge,onAttributeRemove:rt,getAttributeJson:ze}=_l({mode:"edit",setValue:j}),pe=Bi({setValue:j,testCase:u??null,isShow:!0,isEditMode:!0,defaultLabels:(u==null?void 0:u.labels.map(re=>Number(re.id)))??[]}),{data:_e,isLoading:Ue}=wm({project:s.id});h.useEffect(()=>{if(u!=null&&u.suite){P({label:u.suite.name,value:u.suite.id});return}},[u]);const{setIsRedirectByUser:Ze}=Eo({isDirty:S,pathname:"edit-test-case"}),Ne=()=>{Ze(),bt(),g(null),d("general"),x(),oe(),ie([]),pe.setLabels([]),pe.setSearchValue("")},Xe=re=>{d(re)},_t=({id:re,name:Z,scenario:ne,expected:W,sort_order:me,attachments:be})=>({id:typeof re=="string"?void 0:re,name:Z,scenario:ne,expected:W,sort_order:me,attachments:be.map(Ct=>typeof Ct=="object"?Ct.id:Ct)}),Me=()=>new Promise(re=>{he.confirm({title:t("Do you want to change suite?"),content:t("Please confirm to change suite."),okText:t("Ok"),cancelText:t("Cancel"),onOk:()=>re(!0),onCancel:()=>re(!1),okButtonProps:{"data-testid":"change-suite-button-confirm"},cancelButtonProps:{"data-testid":"change-suite-button-cancel"}})}),et=async(re,Z=!0)=>{var Vt,Ss,gt;if(!u)return;const ne=re;if(re.is_steps&&!((Vt=re.steps)!=null&&Vt.length)){w("steps",{type:"required",message:t("Required field")});return}if(!re.is_steps&&!((Ss=re.scenario)!=null&&Ss.length)){w("scenario",{type:"required",message:t("Required field")});return}const{isSuccess:W,attributesJson:me,errors:be}=ps(te);if(!W){g({attributes:JSON.stringify(be)});return}if(!(ne.suite&&ne.suite!==Number(i)&&!await Me())){g(null);try{const Vs=ne.steps?ne.steps.map(Nc=>_t(Nc)):[],Pc=e0(Vs),Ea=await N({...u,...ne,attachments:ne.attachments,is_steps:!!ne.is_steps,scenario:ne.is_steps?void 0:ne.scenario,steps:ne.is_steps?Pc:[],estimate:(gt=ne.estimate)!=null&&gt.length?ne.estimate:null,skip_history:Z,attributes:me}).unwrap();o({version:String(Ea.versions[0]),test_case:String(u.id)}),Ne(),H.success({message:t("Success"),closable:!0,description:e.jsx(Re,{id:String(Ea.id),action:"updated",title:t("Test Case"),link:`/projects/${s.id}/suites/${i}?test_case=${Ea.id}`})}),ne.suite!==Number(i)&&n(`/projects/${s.id}/suites/${ne.suite}?test_case=${Ea.id}`)}catch(Vs){q(Vs)}}},tt=re=>{et(re,!0)},Ie=re=>{et(re,!1)},Dt=()=>{if(!A){if(S){a(Ne);return}Ne()}},bt=()=>{const re=r.get("prevSearch"),Z=`/projects/${s.id}/suites/${i}?test_case=${(u==null?void 0:u.id)??""}`;if(!re){n(Z);return}const ne=Po(re);n(`${Z}&${ne}`)},ot=re=>{j("suite",re.value,{shouldDirty:!0}),P(re)};h.useEffect(()=>{if(!u||B)return;const re=u.attachments.map(W=>({...W,uid:String(W.id)})),Z=[...u.steps].sort((W,me)=>W.sort_order-me.sort_order);re.length&&U(re);const ne=ze(u.attributes);ie(ne),x({name:u.name,description:u.description,setup:u.setup,scenario:u.scenario??"",expected:u.expected??"",teardown:u.teardown,estimate:u.estimate,steps:Z,is_steps:u.is_steps,labels:u.labels,suite:Number(u.suite.id),attributes:ne,attachments:re.map(W=>W.id)},{keepDirty:!1})},[u,B]);const bs=!Ue;return{title:`${t("Edit Test Case")} '${u==null?void 0:u.name}'`,isLoading:A||p||ee||B||Ue,errors:m,formErrors:C,control:y,attachments:O,attachmentsIds:Y,isSteps:k,isDirty:S,tab:l,selectedSuite:I,shouldShowSuiteSelect:bs,suites:_e,steps:$??[],onLoad:D,onRemove:E,onChange:ae,setValue:j,clearErrors:b,setAttachments:U,handleCancel:Dt,handleSubmitFormAsNew:f(Ie),handleSubmitFormAsCurrent:f(tt),register:_,labelProps:pe,handleTabChange:Xe,attributes:te,setAttributes:ie,addAttribute:ke,onAttributeChangeType:Qe,onAttributeChangeValue:ge,onAttributeChangeName:qe,onAttributeRemove:rt,handleSelectSuite:ot}},s0=()=>{var U,E,D;const{t}=T(),{title:s,isLoading:a,errors:n,formErrors:i,control:r,attachments:o,attachmentsIds:c,isSteps:l,steps:d,isDirty:u,labelProps:p,tab:m,shouldShowSuiteSelect:g,attributes:f,selectedSuite:x,onLoad:y,onRemove:j,onChange:_,setValue:w,setAttachments:b,handleCancel:S,handleSubmitFormAsCurrent:C,handleSubmitFormAsNew:v,register:k,handleTabChange:$,addAttribute:I,onAttributeChangeType:P,onAttributeChangeValue:N,onAttributeChangeName:A,onAttributeRemove:q,handleSelectSuite:O}=t0(),Y=l?d.length?"":t("Required field"):((U=i.scenario)==null?void 0:U.message)??(n==null?void 0:n.scenario)??"",ee=[{key:"1",label:e.jsx(L,{id:"modal-update-test-case-btn",loading:a,onClick:C,type:"primary",disabled:!u,children:t("Update current version")},"submit")}];return a?e.jsx(zt,{}):e.jsxs(e.Fragment,{children:[e.jsx(Dn,{model:"test-case",type:"edit",title:s,onClose:S,submitNode:e.jsx(Sn.Button,{className:"edit-test-case",menu:{items:ee},type:u?"primary":void 0,loading:a,disabled:!u,style:{width:"fit-content",display:"inline-flex"},onClick:v,size:"large","data-testid":"dropdown-update-button",children:t("Update")},"update")}),n?e.jsx(it,{error:n,skipFields:["name","setup","scenario","teardown","estimate","steps","attributes"]}):null,e.jsx(R,{id:"edit-test-case-form",layout:"vertical",onFinish:v,children:e.jsxs(dt,{defaultActiveKey:"general",onChange:$,activeKey:m,children:[e.jsx(dt.TabPane,{tab:t("General"),children:e.jsxs(Ye,{gutter:[32,32],style:{marginTop:14},children:[e.jsxs(Le,{span:12,children:[e.jsx(R.Item,{label:t("Name"),validateStatus:((E=i.name)==null?void 0:E.message)??(n==null?void 0:n.name)?"error":"",help:((D=i.name)==null?void 0:D.message)??(n==null?void 0:n.name)??"",required:!0,children:e.jsx(F,{name:"name",control:r,render:({field:ae})=>e.jsx(se,{...ae,id:"edit-name-input"})})}),e.jsx(R.Item,{label:t("Description"),validateStatus:n!=null&&n.description?"error":"",help:n!=null&&n.description?n.description:"",children:e.jsx(F,{name:"description",control:r,render:({field:ae})=>e.jsx(lt,{uploadId:"edit-description",textAreaId:"edit-description-textarea",fieldProps:ae,stateAttachments:{attachments:o,setAttachments:b},customRequest:y,setValue:w})})}),g&&e.jsx(R.Item,{label:t("Suite"),validateStatus:n!=null&&n.suite?"error":"",help:n!=null&&n.suite?n.suite:"",children:e.jsx(F,{name:"suite",control:r,render:()=>e.jsx(ZT,{suite:x,onChange:O})})}),e.jsx(R.Item,{label:t("Setup"),validateStatus:n!=null&&n.setup?"error":"",help:n!=null&&n.setup?n.setup:"",children:e.jsx(F,{name:"setup",control:r,render:({field:ae})=>e.jsx(lt,{uploadId:"edit-setup",textAreaId:"edit-setup-textarea",fieldProps:ae,stateAttachments:{attachments:o,setAttachments:b},customRequest:y,setValue:w})})}),!l&&e.jsx(R.Item,{label:e.jsx(bn,{control:r}),validateStatus:Y?"error":"",help:Y,required:!0,className:Zr.formItem,children:e.jsx(F,{name:"scenario",control:r,render:({field:ae})=>e.jsx(lt,{uploadId:"edit-scenario",textAreaId:"edit-scenario-textarea",customRequest:y,fieldProps:ae,stateAttachments:{attachments:o,setAttachments:b},setValue:w})})}),l&&e.jsx(R.Item,{label:e.jsx(bn,{control:r}),validateStatus:Y?"error":"",help:Y,required:!0,className:Zr.formItem,children:e.jsx(F,{name:"steps",control:r,render:({field:ae})=>e.jsx(bc,{steps:ae.value??[],setSteps:ae.onChange})})}),!l&&e.jsx(R.Item,{label:t("Expected"),validateStatus:n!=null&&n.expected?"error":"",help:n!=null&&n.expected?n.expected:"",children:e.jsx(F,{name:"expected",control:r,render:({field:ae})=>e.jsx(lt,{uploadId:"edit-expected",textAreaId:"edit-expected-textarea",fieldProps:ae,stateAttachments:{attachments:o,setAttachments:b},customRequest:y,setValue:w})})}),e.jsx(R.Item,{label:t("Teardown"),validateStatus:n!=null&&n.teardown?"error":"",help:n!=null&&n.teardown?n.teardown:"",children:e.jsx(F,{name:"teardown",control:r,render:({field:ae})=>e.jsx(lt,{uploadId:"edit-teardown",textAreaId:"edit-teardown-textarea",fieldProps:ae,stateAttachments:{attachments:o,setAttachments:b},customRequest:y,setValue:w})})})]}),e.jsxs(Le,{span:12,children:[e.jsx(R.Item,{label:t("Estimate"),validateStatus:n!=null&&n.estimate?"error":"",help:n!=null&&n.estimate?n.estimate:"",children:e.jsx(F,{name:"estimate",control:r,render:({field:ae})=>e.jsx(se,{...ae,id:"edit-estimate-input",value:ae.value??"",suffix:e.jsx(fc,{title:Ae.estimateTooltip})})})}),e.jsx(R.Item,{label:t("Labels"),validateStatus:n!=null&&n.labels?"error":"",help:n!=null&&n.labels?n.labels:"",children:e.jsx(F,{name:"labels",control:r,render:({field:ae})=>e.jsx(Ui,{labelProps:p,fieldProps:ae})})}),e.jsx(F,{name:"attributes",control:r,render:({field:ae})=>e.jsxs(Ye,{style:{flexDirection:"column",marginTop:0},children:[e.jsx(oa,{attributes:f,onChangeName:A,onChangeType:P,onChangeValue:N,onRemove:q,onBlur:ae.onBlur,errors:n!=null&&n.attributes?JSON.parse(n==null?void 0:n.attributes):void 0}),e.jsx(ra,{onClick:I})]})})]})]})},"general"),e.jsx(dt.TabPane,{tab:t("Attachments"),children:e.jsx(mt.DropFiles,{attachments:o,attachmentsIds:c,onChange:_,onLoad:y,onRemove:j,register:k,idInput:"edit-test-case-attachments-input"})},"attachments")]})})]})},a0=({projectId:t,showAccessManagement:s=!0})=>{const{t:a}=T(),n=De(),{projectDetailsActiveTab:i}=h.useContext(cs),r=[{label:a("Overview"),key:"overview",path:`/administration/projects/${t}/overview`},{label:a("Parameters"),key:"parameters",path:`/administration/projects/${t}/parameters`},{label:a("Labels"),key:"labels",path:`/administration/projects/${t}/labels`},{label:a("Statuses"),key:"statuses",path:`/administration/projects/${t}/statuses`},{label:a("Custom Attributes"),key:"attributes",path:`/administration/projects/${t}/attributes`},{label:a("Settings"),key:"settings",path:`/administration/projects/${t}/settings`}];s&&r.push({label:a("Access Management"),key:"access-management",path:`/administration/projects/${t}/access-management`});const o=c=>{const l=r.find(d=>d.key===c);l&&n(l.path)};return e.jsx(dt,{activeKey:i,items:r,onChange:o})},{Content:n0}=es,cs=vn.createContext(null),i0=()=>{const{t}=T(),[s,a]=h.useState(""),{project:n}=h.useContext(J),i=[e.jsx(Zt.Item,{children:t("Administration")},"administration"),e.jsx(Zt.Item,{children:e.jsx(ve,{to:"/administration/projects",children:t("Projects")})},"projects"),e.jsx(Zt.Item,{children:n.name},n.id)];return e.jsx(e.Fragment,{children:e.jsxs(cs.Provider,{value:{projectDetailsActiveTab:s,setProjectDetailsActiveTab:a},children:[e.jsx(ka,{breadcrumbRender:()=>e.jsx(Zt,{children:i}),title:n==null?void 0:n.name,ghost:!1,footer:e.jsx(a0,{projectId:n.id}),style:{paddingBottom:0}}),e.jsx(n0,{style:{margin:"24px"},children:e.jsx(xs,{context:n.id})})]})})},r0={isModalOpen:!1,mode:"create",user:null,onSuccess:null},vc=Pt({name:"role",initialState:r0,reducers:{openModal:(t,s)=>{t.isModalOpen=!0,t.mode=s.payload.mode,t.user=s.payload.user??null,s.payload.mode==="edit"&&!s.payload.user&&console.warn("User is not provided for edit mode")},closeModal:t=>{t.isModalOpen=!1},setOnSuccess:(t,s)=>{t.onSuccess=s.payload},resetOnSuccess:t=>{t.onSuccess=null}}}),{openModal:Sc,closeModal:o0,setOnSuccess:l0,resetOnSuccess:c0}=vc.actions,d0=vc.reducer,u0=t=>t.role.isModalOpen,h0=t=>t.role.mode,p0=t=>t.role.user,wc=t=>t.role.onSuccess,m0=()=>{const{t}=T(),s=ye(),a=()=>{s(Sc({mode:"create"}))};return e.jsx(L,{id:"add-user-to-project",type:"primary",icon:e.jsx(ct,{}),onClick:a,style:{marginBottom:16,float:"right"},children:t("Add user to project")})},ns="roles",Ca=Je.createApi({reducerPath:"roleApi",baseQuery:pt,tagTypes:["Role","User"],endpoints:t=>({getRoles:t.query({query:()=>({url:`${ns}/`}),providesTags:()=>[{type:"Role",id:"LIST"}]}),getRole:t.query({query:s=>`${ns}/${s}/`,providesTags:(s,a,n)=>[{type:"Role",id:n}]}),createRole:t.mutation({query:s=>({url:`${ns}/`,method:"POST",body:s}),invalidatesTags:[{type:"Role",id:"LIST"}]}),updateRole:t.mutation({query:({id:s,body:a})=>({url:`${ns}/${s}/`,method:"PATCH",body:a}),invalidatesTags:s=>Ge(s,"Role")}),deleteRole:t.mutation({query:s=>({url:`${ns}/${s}/`,method:"DELETE"}),invalidatesTags:[{type:"Role",id:"LIST"}]}),assignRole:t.mutation({query:s=>({url:`${ns}/assign/`,method:"POST",body:s}),invalidatesTags:[{type:"User",id:"LIST"}]}),unassignRole:t.mutation({query:s=>({url:`${ns}/unassign/`,method:"POST",body:s}),invalidatesTags:[{type:"User",id:"LIST"}]}),updateAssignedRole:t.mutation({query:s=>({url:`${ns}/assign/`,method:"PUT",body:s}),invalidatesTags:[{type:"User",id:"LIST"}]}),getPermissions:t.query({query:()=>({url:`${ns}/permissions/`})})})});Ca.util.invalidateTags([{type:"Role",id:"LIST"}]);const{useGetRolesQuery:g0,useCreateRoleMutation:e$,useUpdateRoleMutation:t$,useDeleteRoleMutation:s$,useGetPermissionsQuery:a$,useAssignRoleMutation:x0,useUnassignRoleMutation:f0,useUpdateAssignedRoleMutation:j0}=Ca,y0=()=>{const{t}=T(),{projectId:s}=Q(),[a,n]=h.useState(null),i=z(u0),r=z(h0),o=z(p0),c=ye(),l=r==="edit",d=z(wc),{data:u,isLoading:p}=g0({}),{handleSubmit:m,reset:g,setValue:f,control:x,formState:{isDirty:y}}=we(),[j,_]=h.useState(null),{onHandleError:w}=We(_),[b]=x0(),[S]=j0();h.useEffect(()=>{o?(f("user",String(o.id),{shouldDirty:!1}),n({label:e.jsx(fa,{user:o}),value:o.id}),f("roles",o.roles.map(N=>N.id),{shouldDirty:!1})):n(null)},[o]);const C=async N=>{try{if(l){if(!o)throw new Error("User not found");await S({user:o.id,roles:N.roles.map(Number),project:Number(s)}).unwrap()}else await b({user:Number(N.user),roles:N.roles.map(Number),project:Number(s)}).unwrap();const A=t(l?"User updated successfully":"User assigned successfully");H.success({message:t("Success"),closable:!0,description:A}),d==null||d(),g(),v(),n(null)}catch(A){w(A),H.error({message:t("Error!"),description:t("User assign error")})}},v=()=>{c(o0()),g(),n(null),_(null)},k=N=>{_(null),C(N)},$=N=>{N&&(n(N),f("user",String(N.value)||"",{shouldDirty:!0}))},I=()=>{n(null),f("user","",{shouldDirty:!0})},P=t(r==="create"?"Add user to project":"Edit user project access");return{isOpenned:i,errors:j,isDirty:y,selectedUser:a??void 0,handleClose:v,handleSubmitForm:m(k),handleUserChange:$,handleUserClear:I,isLoading:p,roles:(u==null?void 0:u.results)??[],control:x,title:P,isEditMode:l,mode:r,onSuccess:d}},_0=()=>{const{t}=T(),{isOpenned:s,handleClose:a,isLoading:n,handleSubmitForm:i,isDirty:r,errors:o,handleUserChange:c,handleUserClear:l,selectedUser:d,control:u,roles:p,title:m,isEditMode:g}=y0();return e.jsx(he,{className:"user-project-access-modal",title:m,open:s,onCancel:a,width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-create-edit-user",onClick:a,children:t("Close")},"back"),e.jsx(L,{id:"user-project-access-submit",loading:n,onClick:i,type:"primary",disabled:!r,children:t(g?"Update":"Create")},"submit")],children:e.jsxs(e.Fragment,{children:[o?e.jsx(it,{error:o,skipFields:["user","role"]}):null,e.jsxs(R,{id:"create-edit-user-form",layout:"vertical",onFinish:i,children:[e.jsx(R.Item,{label:t("Name"),validateStatus:o!=null&&o.user?"error":"",help:(o==null?void 0:o.user)??"",required:!0,children:e.jsx(Il,{selectedUser:d,handleChange:c,handleClear:l})}),e.jsx(R.Item,{label:t("Roles"),validateStatus:o!=null&&o.roles?"error":"",help:(o==null?void 0:o.roles)??"",required:!0,children:e.jsx(F,{name:"roles",control:u,render:({field:f})=>e.jsx(ue,{mode:"multiple",...f,placeholder:t("Please select roles"),style:{width:"100%"},id:"user-project-access-roles",filterOption:!1,showSearch:!1,children:p.map(x=>e.jsx(ue.Option,{value:Number(x.id),children:x.name},x.id))})})})]})]})})},b0=({user:t})=>{const{t:s}=T(),[a]=f0(),n=z(wc),{projectId:i}=Q(),r=async()=>{try{await a({user:t.id,project:Number(i)}).unwrap(),H.success({message:s("Success"),closable:!0,description:s("User access deleted successfully")}),n==null||n()}catch(o){Se(o)}};return e.jsx(L,{"data-testid":`${t.username}-delete-user-project-access`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:()=>{he.confirm({title:s("Do you want to delete user from project?"),okText:s("Delete"),cancelText:s("Cancel"),onOk:r,okButtonProps:{"data-testid":"delete-user-button-confirm"},cancelButtonProps:{"data-testid":"delete-user-button-cancel"}})}})},v0=({user:t})=>{const s=ye(),a=()=>{s(Sc({mode:"edit",user:t}))};return e.jsx(L,{"data-testid":`${t.username}-edit-user-project-access`,icon:e.jsx(Ke,{}),shape:"circle",onClick:a})},S0=t=>{const{t:s}=T(),a=ye(),[n,i]=h.useState({page:1,page_size:10}),[r,o]=h.useState({}),[c,l]=h.useState({}),{projectId:d}=Q(),{data:u,isLoading:p,refetch:m}=vp({...n,...c,id:Number(d)}),g=async()=>{await m()};h.useEffect(()=>(Promise.resolve(a(l0(g))),()=>{a(c0())}),[a,m]);const{setSearchText:f,getColumnSearch:x}=zs(),y=(S,C)=>{o(C),l(v=>({...v,username:C!=null&&C.username?String(C.username[0]):void 0,email:C!=null&&C.email?String(C.email[0]):void 0,first_name:C!=null&&C.first_name?String(C.first_name[0]):void 0,last_name:C!=null&&C.last_name?String(C.last_name[0]):void 0}))},j=()=>{o({}),l({}),f("")},_=[{key:"avatar",width:"32px",align:"right",render:(S,C)=>e.jsx(Ut,{avatar_link:C.avatar_link,size:32})},{title:s("Username"),dataIndex:"username",key:"username",filteredValue:r.username??null,...x("username"),onFilter:(S,C)=>C.username.toLowerCase().includes(String(S).toLowerCase())},{title:s("Email"),dataIndex:"email",key:"email",filteredValue:r.email??null,...x("email"),onFilter:(S,C)=>C.email.toLowerCase().includes(String(S).toLowerCase())},{title:s("First Name"),dataIndex:"first_name",key:"first_name",filteredValue:r.first_name??null,...x("first_name"),onFilter:(S,C)=>C.first_name.toLowerCase().includes(String(S).toLowerCase())},{title:s("Last Name"),dataIndex:"last_name",key:"last_name",filteredValue:r.last_name??null,...x("last_name"),onFilter:(S,C)=>C.last_name.toLowerCase().includes(String(S).toLowerCase())},{title:s("Roles"),key:"roles",render:(S,C)=>C.roles.length===0?"-":C.roles.map(v=>v.name).join(", ")},{title:s("Actions"),key:"action",width:110,render:(S,C)=>e.jsxs(ce,{children:[t&&e.jsx(v0,{user:C}),t&&e.jsx(b0,{user:C})]})}],w=(S,C)=>{i({page:S,page_size:C})},b={total:(u==null?void 0:u.pages.total)??0,hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:n.page,pageSize:n.page_size,onChange:w};return{users:(u==null?void 0:u.results)??[],isLoading:p,columns:_,paginationTable:b,handleChange:y,clearAll:j}},w0=({isManageable:t=!1})=>{const{t:s}=T(),{columns:a,isLoading:n,users:i,paginationTable:r,handleChange:o,clearAll:c}=S0(t);return e.jsxs(e.Fragment,{children:[e.jsx(ce,{style:{marginBottom:16,display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:c,children:s("Clear filters and sorters")})}),e.jsx(ht,{loading:n,dataSource:i,columns:a,rowKey:"username",style:{marginTop:12},onChange:o,pagination:r})]})},C0=()=>{const{setProjectDetailsActiveTab:t}=h.useContext(cs),{project:s}=h.useContext(J);return h.useEffect(()=>{t("access-management")},[]),e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:s.is_manageable&&e.jsx(m0,{})}),e.jsx(w0,{isManageable:s.is_manageable}),e.jsx(_0,{})]})},T0=({project:t})=>{const{t:s}=T(),[a,n]=h.useState(null),{onHandleError:i}=We(n),[r,o]=h.useState(!1),[c,{isLoading:l}]=Li(),{handleSubmit:d,reset:u,control:p,setValue:m,watch:g,formState:{isDirty:f}}=we(),x=g("is_result_editable");h.useEffect(()=>{var _;t.settings&&(m("is_result_editable",t.settings.is_result_editable),m("result_edit_limit",((_=t.settings.result_edit_limit)==null?void 0:_.toString())??""))},[r,t]);const y=async({is_result_editable:_,result_edit_limit:w})=>{n(null);try{const b={is_result_editable:_,result_edit_limit:_&&(w!=null&&w.trim())?w.trim():null};await c({id:t.id,body:{settings:b}}).unwrap(),j(),H.success({message:s("Success"),closable:!0,description:e.jsx(Re,{action:"updated",title:s("Project test results settings"),link:`/administration/projects/${t.id}/settings`,id:t.id.toString()})})}catch(b){i(b)}},j=()=>{o(!1),n(null),u()};return e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"default",icon:e.jsx(Ke,{}),onClick:()=>o(!0),children:s("Edit")}),e.jsx(he,{className:"edit-test-results-settings-modal",title:s("Edit project test results settings"),open:r,onCancel:()=>o(!1),width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-edit-test-results-settings",onClick:j,children:s("Close")},"back"),e.jsx(L,{id:"edit-test-results-settings",loading:l,onClick:d(y),type:"primary",disabled:!f,children:s("Save")},"submit")],children:e.jsxs(e.Fragment,{children:[a?e.jsx(it,{error:a,skipFields:["is_result_editable","result_edit_limit"]}):null,e.jsxs(R,{id:"edit-test-results-settings-form",layout:"vertical",onFinish:d(y),children:[e.jsx(R.Item,{label:s("Is Editable"),validateStatus:a!=null&&a.is_result_editable?"error":"",help:a!=null&&a.is_result_editable?a.is_result_editable:"",children:e.jsx(F,{name:"is_result_editable",control:p,render:({field:_})=>e.jsx(Wt,{checked:x,..._})})}),x&&e.jsx(R.Item,{label:e.jsx(le,{overlayStyle:{minWidth:460},title:Ae.estimateTooltip,children:s("Edit time")}),validateStatus:a!=null&&a.result_edit_limit?"error":"",help:a!=null&&a.result_edit_limit?a.result_edit_limit:"",children:e.jsx(F,{name:"result_edit_limit",control:p,render:({field:_})=>e.jsx(se,{..._,value:_.value??""})})})]})]})})]})},k0=()=>{const{t}=T(),{setProjectDetailsActiveTab:s}=h.useContext(cs);h.useEffect(()=>{s("settings")});const{project:a}=h.useContext(J),{me:n}=h.useContext(Pe),i=!a.is_archive||(n==null?void 0:n.is_superuser),r=a.settings.result_edit_limit?`${a.settings.result_edit_limit}`:"Unlimited";return e.jsxs(os,{style:{padding:24,minHeight:360},children:[a.is_manageable&&i&&e.jsx(ce,{style:{marginBottom:"16px",float:"right"},children:e.jsx(T0,{project:a})}),e.jsx(je,{orientation:"left",orientationMargin:0,children:e.jsx("div",{style:{display:"flex",alignItems:"center",margin:"12px 0"},children:e.jsx(G.Title,{style:{margin:"0 8px 0 0"},level:4,children:t("Test Results")})})}),e.jsxs("div",{style:{padding:8},children:[e.jsx(at,{title:t("Is Editable"),value:e.jsx(Go,{value:!!a.settings.is_result_editable,trueText:t("Yes"),falseText:t("No")})}),a.settings.is_result_editable&&e.jsx(at,{title:t("Edit time"),value:r})]})]})},I0=()=>{const{t}=T(),{project:s}=h.useContext(J),{setProjectDetailsActiveTab:a}=h.useContext(cs),[n,i]=h.useState([]),[r]=Li();h.useEffect(()=>{a("statuses")},[]);const o=l=>{i(l)},c=async()=>{try{const l=n.reduce((d,u,p)=>(d[u.id]=p,d),{});await r({id:s.id,body:{settings:{status_order:l}}}).unwrap(),H.success({message:t("Success"),description:e.jsx(Re,{action:"updated",title:t("Project status settings"),link:`/administration/projects/${s.id}/statuses`,id:String(s.id)})}),i([])}catch(l){Se(l)}};return e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsxs(ce,{style:{display:"flex",justifyContent:"right"},children:[e.jsx(lv,{}),e.jsx(L,{id:"save-order",type:"primary",icon:e.jsx(ja,{}),onClick:c,style:{marginBottom:16,float:"right"},disabled:!n.length,children:t("Save order")})]}),e.jsx(uv,{onChangeOrder:o})]})},$0=t=>{let s=null,a=!1;return n=>i=>(sl.match(i)?(s||(s=new WebSocket(i.payload.url)),s.onopen=()=>{console.log("Notification WebSocket connected"),a=!0},s.onmessage=r=>{const o=JSON.parse(r.data);t.dispatch(Zp(o))},s.onclose=()=>{t.dispatch(cn())},s.onerror=r=>{console.error("Notification WebSocket error",r)}):cn.match(i)&&(s&&a&&(s.close(),a=!1,console.log("Notification WebSocket disconnected")),s=null),n(i))},L0={parameter:null,modal:{isShow:!1,isEditMode:!1}},Cc=Pt({name:"parameter",initialState:L0,reducers:{setParameter:(t,s)=>{t.parameter=s.payload},showCreateParameterModal:t=>{t.modal.isShow=!0},showEditParameterModal:t=>{t.modal.isShow=!0,t.modal.isEditMode=!0},hideModal:t=>{t.modal.isShow=!1,t.modal.isEditMode=!1}}}),{setParameter:A0,showCreateParameterModal:P0,showEditParameterModal:N0,hideModal:R0}=Cc.actions,D0=t=>t.parameter.modal.isShow,M0=t=>t.parameter.modal.isEditMode,F0=t=>t.parameter.parameter,E0=Cc.reducer,B0={showArchived:!1,isOnlyFavorites:!1},Tc=Pt({name:"project",initialState:B0,reducers:{showArchived:t=>{t.showArchived=!t.showArchived},setIsOnlyFavorites:t=>{t.isOnlyFavorites=!t.isOnlyFavorites}}});Tc.actions;const O0=Tc.reducer,q0={key:"root",storage:ru,whitelist:["user","auth","system"]},z0=Kd({app:_u,auth:wu,testCase:Dg,user:ah,parameter:E0,project:O0,testPlan:Nx,test:Yx,role:d0,system:qb,testsFilter:Vx,testCasesFilter:Pg,[_a.reducerPath]:_a.reducer,[tn.reducerPath]:tn.reducer,[rn.reducerPath]:rn.reducer,[on.reducerPath]:on.reducer,[Sa.reducerPath]:Sa.reducer,[gn.reducerPath]:gn.reducer,[Be.reducerPath]:Be.reducer,[un.reducerPath]:un.reducer,[ms.reducerPath]:ms.reducer,[jn.reducerPath]:jn.reducer,[dn.reducerPath]:dn.reducer,[ba.reducerPath]:ba.reducer,[va.reducerPath]:va.reducer,[Ca.reducerPath]:Ca.reducer,[yn.reducerPath]:yn.reducer,[hn.reducerPath]:hn.reducer,[_n.reducerPath]:_n.reducer,notificationWS:Xp}),U0=iu(q0,z0),kc=Jd({reducer:U0,middleware:t=>t({serializableCheck:{ignoredActions:[Xd,eu,tu,su,au,nu]}}).concat(tn.middleware).concat(on.middleware).concat(rn.middleware).concat(Sa.middleware).concat(gn.middleware).concat(Be.middleware).concat(un.middleware).concat(ms.middleware).concat(jn.middleware).concat(dn.middleware).concat(ba.middleware).concat(va.middleware).concat(yn.middleware).concat(Ca.middleware).concat(_a.middleware).concat(hn.middleware).concat(_n.middleware).concat($0),devTools:!0}),Ic=Zd(kc),V0=()=>{const{t}=T(),[s]=Tu(),[a]=Mu(),[n]=Eu(),[i,r]=h.useState(""),o=De(),{handleSubmit:c,reset:l,control:d}=we({defaultValues:{username:"",password:"",remember_me:!1}}),u=Nt().state,[p,m]=h.useState(!1);return{onSubmit:c(async f=>{r(""),m(!0);try{await Ic.purge(),await s(f).unwrap(),await a().unwrap(),await n({}).unwrap(),l();const x=Iu();if(x){$u(),o(x,{replace:!0});return}if(u!=null&&u.from){if(u.from.search.includes("?next=/plugins/")){const y=u.from.search.replace("?next=/","");window.location.replace(`${u.from.pathname}${y}`);return}o(`${u.from.pathname}${u.from.search}`);return}o("/")}catch(x){const y=x;y!=null&&y.status?y.status===400?r(t("Missing Username or Password")):y.status===401?r(t("Unauthorized")):r(t("Login Failed")):r(t("No Server Response"))}m(!1)}),errMsg:i,control:d,isLoading:p}},H0=()=>{const{t}=T(),{control:s,errMsg:a,onSubmit:n,isLoading:i}=V0();return e.jsxs(e.Fragment,{children:[a?e.jsx(gs,{style:{marginBottom:24},description:a,type:"error"}):null,e.jsxs(R,{onFinish:n,layout:"vertical",children:[e.jsx(R.Item,{label:t("Username"),children:e.jsx(F,{name:"username",control:s,render:({field:r})=>e.jsx(se,{...r})})}),e.jsx(R.Item,{label:t("Password"),name:"password",style:{marginBottom:8},children:e.jsx(F,{name:"password",control:s,render:({field:r})=>e.jsx(se.Password,{...r})})}),e.jsx(R.Item,{name:"remember_me",children:e.jsx(F,{name:"remember_me",control:s,render:({field:r})=>e.jsx(ts,{...r,checked:r.value,onChange:o=>r.onChange(o.target.checked),children:t("Remember me")})})}),e.jsx(R.Item,{children:e.jsx(L,{id:"login-btn",size:"large",type:"primary",htmlType:"submit",block:!0,loading:i,children:t("Login")})})]})]})},Y0=()=>e.jsxs(Ye,{justify:"center",align:"middle",style:{minHeight:"100vh",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:0,width:"100%"},children:e.jsx(rc,{})}),e.jsxs(Le,{xl:6,lg:8,md:10,sm:12,xs:24,children:[e.jsx("div",{children:e.jsx("h1",{style:{marginBottom:24,textAlign:"center"},children:"TestY"})}),e.jsx(H0,{}),e.jsx(qo,{})]})]}),W0=()=>{const{t}=T(),{setActiveTab:s,setTitle:a}=h.useContext(An);return h.useEffect(()=>{s("overview"),a(t("Notifications"))},[]),e.jsx(yi,{children:e.jsx(vo,{children:e.jsx(ev,{})})})},Q0=()=>{const{t}=T(),{setActiveTab:s,setTitle:a}=h.useContext(An);return h.useEffect(()=>{s("settings"),a(t("Notification settings"))},[]),e.jsx(yi,{children:e.jsx(vo,{children:e.jsx(Wb,{})})})},G0=()=>{const t=_i(),s=Nt();return t?e.jsx(aC,{children:e.jsx(xs,{})}):e.jsx(So,{to:"/login",state:{from:s},replace:!0})},{Content:K0}=es,Xr=()=>{const{t}=T(),s=[e.jsx(Zt.Item,{children:t("Administration")},"administration"),e.jsx(Zt.Item,{children:t("Projects")},"projects")];return e.jsxs(e.Fragment,{children:[e.jsx(ka,{breadcrumbRender:()=>e.jsx(Zt,{children:s}),title:t("Projects"),ghost:!1,style:{paddingBottom:0}}),e.jsx(K0,{style:{margin:"24px"},children:e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{marginBottom:"16px",display:"flex",justifyContent:"right"},children:e.jsx(Lv,{})}),e.jsx(FS,{})]})})]})},J0="_nodeBody_19szl_1",Z0="_nodeLeftAction_19szl_31",X0="_arrowIcon_19szl_51",ek="_arrowIconOpen_19szl_69",tk="_isRoot_19szl_79",sk="_isLast_19szl_87",ak="_loader_19szl_95",nk="_container_19szl_113",ik="_loadMore_19szl_129",Is={nodeBody:J0,nodeLeftAction:Z0,arrowIcon:X0,arrowIconOpen:ek,isRoot:tk,isLast:sk,loader:ak,container:nk,loadMore:ik},{ArrowIcon:rk}=Ce,$c=({node:t,searchText:s,onCheck:a})=>{var c;const n=t.props.level*20,i=l=>{a(Number(t.id)),l.target.checked?t.check():t.uncheck()},r=async()=>{await t.open()},o=async()=>{await t.more()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{id:`${t.title}-${t.id}`,style:{paddingLeft:n},children:e.jsxs("div",{className:V(Is.nodeBody,{[Is.isRoot]:t.isRoot,[Is.isLast]:t.isLast}),children:[e.jsxs("div",{className:Is.nodeLeftAction,children:[e.jsx(ts,{style:{height:16},checked:t.props.isChecked,onChange:i,onClick:l=>l.stopPropagation(),indeterminate:t.props.isHalfChecked&&!t.props.isChecked}),t.props.isLoading&&e.jsx(St,{size:"small",className:Is.loader}),!t.props.isLoading&&t.props.canOpen&&e.jsx(rk,{className:V(Is.arrowIcon,{[Is.arrowIconOpen]:t.props.isOpen}),onClick:r})]}),e.jsx(Lt,{searchWords:s,textToHighlight:t.data.name})]})}),((c=t.parent)==null?void 0:c.props.hasMore)&&t.isLast&&e.jsx(Ra,{isLoading:t.parent.props.isLoading,node:t,onMore:o,isRoot:t.isRoot,isLast:t.isLast,style:{height:60}})]})},ok="_wrapper_zv9wp_1",lk="_treeBlock_zv9wp_15",ck="_suiteSpecificBlock_zv9wp_33",Wn={wrapper:ok,treeBlock:lk,suiteSpecificBlock:ck},dk=({value:t,onChange:s})=>{const{t:a}=T(),{project:n}=h.useContext(J),[i,r]=h.useState(""),o=Fs(i,250,!0),[c]=Os(),l=g=>{r(g.target.value)},d=()=>{s({...t,testcase:{...t.testcase,is_required:!t.testcase.is_required}})},u=()=>{const g=!t.testcase.is_suite_specific;s({...t,testcase:{...t.testcase,is_suite_specific:g,suite_ids:g?t.testcase.suite_ids:[]}})},p=async g=>{const f=await c({project:n.id,page:g.page,parent:g.parent?Number(g.parent):null,page_size:Ae.defaultTreePageSize,ordering:"name",treesearch:o,_n:g._n},!0).unwrap();return{data:fs(f.results,g,y=>({isChecked:t.testcase.suite_ids.includes(y.id)??!1})),nextInfo:f.pages,_n:g._n}},m=g=>{var f,x;s({...t,testcase:{...t.testcase,suite_ids:(f=t.testcase.suite_ids)!=null&&f.includes(g)?(x=t.testcase.suite_ids)==null?void 0:x.filter(y=>y!==g):[...t.testcase.suite_ids??[],g]}})};return e.jsxs("div",{className:Wn.wrapper,children:[e.jsx(ts,{"data-testid":"checkbox-is-required",className:"checkbox-md",checked:t.testcase.is_required,onChange:d,children:a("Required")}),e.jsx(ts,{"data-testid":"checkbox-suite-specific",className:"checkbox-md",checked:t.testcase.is_suite_specific,onChange:u,children:a("Suite specific")}),t.testcase.is_suite_specific&&e.jsxs("div",{className:Wn.suiteSpecificBlock,children:[e.jsx(ji,{"data-testid":"search-input",placeholder:"Search",onChange:l,value:i,style:{marginBottom:"8px"}}),e.jsx("div",{className:Wn.treeBlock,children:e.jsx(qs,{fetcher:p,initDependencies:[o],renderNode:g=>e.jsx($c,{node:g,onCheck:m,searchText:i})})})]})]})},uk="_wrapper_zv9wp_1",hk="_treeBlock_zv9wp_15",pk="_suiteSpecificBlock_zv9wp_33",mk={wrapper:uk,treeBlock:hk,suiteSpecificBlock:pk},gk=({value:t,onChange:s})=>{const{t:a}=T(),n=()=>{s({...t,testplan:{...t.testplan,is_required:!t.testplan.is_required}})};return e.jsx("div",{className:mk.wrapper,children:e.jsx(ts,{"data-testid":"checkbox-is-required",className:"checkbox-md",checked:t.testplan.is_required,onChange:n,children:a("Required")})})},xk="_wrapper_x0jny_1",fk="_selectStatus_x0jny_15",jk="_treeBlock_x0jny_25",yk="_suiteSpecificBlock_x0jny_43",Ja={wrapper:xk,selectStatus:fk,treeBlock:jk,suiteSpecificBlock:yk},_k=({value:t,onChange:s})=>{const{t:a}=T(),{project:n}=h.useContext(J),[i,r]=h.useState(""),o=Fs(i,250,!0),[c]=Os(),{statuses:l}=qt({project:n.id}),d=x=>{r(x.target.value)},u=x=>{s({...t,testresult:{...t.testresult,status_specific:x}})},p=()=>{s({...t,testresult:{...t.testresult,is_required:!t.testresult.is_required}})},m=()=>{const x=!t.testresult.is_suite_specific;s({...t,testresult:{...t.testresult,is_suite_specific:x,suite_ids:x?t.testresult.suite_ids:[]}})},g=async x=>{const y=await c({project:n.id,page:x.page,parent:x.parent?Number(x.parent):null,page_size:Ae.defaultTreePageSize,ordering:"name",treesearch:o,_n:x._n},!0).unwrap();return{data:fs(y.results,x,_=>({isChecked:t.testresult.suite_ids.includes(_.id)??!1})),nextInfo:y.pages,_n:x._n}},f=x=>{var y,j;s({...t,testresult:{...t.testresult,suite_ids:(y=t.testresult.suite_ids)!=null&&y.includes(x)?(j=t.testresult.suite_ids)==null?void 0:j.filter(_=>_!==x):[...t.testresult.suite_ids??[],x]}})};return e.jsxs("div",{className:Ja.wrapper,children:[e.jsx(R.Item,{label:a("Result Status"),style:{marginBottom:0},children:e.jsx(ue,{id:"select-status",placeholder:a("Please select"),mode:"multiple",allowClear:!0,showSearch:!1,value:t.testresult.status_specific,onChange:u,className:Ja.selectStatus,children:l.map(x=>e.jsx(ue.Option,{value:x.id,children:e.jsx(Rt,{id:x.id,name:x.name,color:x.color})},x.id))})}),e.jsx(ts,{"data-testid":"checkbox-is-required",className:"checkbox-md",checked:t.testresult.is_required,onChange:p,children:a("Required")}),e.jsx(ts,{"data-testid":"checkbox-suite-specific",className:"checkbox-md",checked:t.testresult.is_suite_specific,onChange:m,children:a("Suite specific")}),t.testresult.is_suite_specific&&e.jsxs("div",{className:Ja.suiteSpecificBlock,children:[e.jsx(ji,{"data-testid":"search-input",placeholder:"Search",onChange:d,value:i,style:{marginBottom:"8px"}}),e.jsx("div",{className:Ja.treeBlock,children:e.jsx(qs,{fetcher:g,initDependencies:[o],renderNode:x=>e.jsx($c,{node:x,onCheck:f,searchText:i})})})]})]})},bk="_wrapper_zv9wp_1",vk="_treeBlock_zv9wp_15",Sk="_suiteSpecificBlock_zv9wp_33",wk={wrapper:bk,treeBlock:vk,suiteSpecificBlock:Sk},Ck=({value:t,onChange:s})=>{const{t:a}=T(),n=()=>{s({...t,testsuite:{...t.testsuite,is_required:!t.testsuite.is_required}})};return e.jsx("div",{className:wk.wrapper,children:e.jsx(ts,{"data-testid":"checkbox-is-required",className:"checkbox-md",checked:t.testsuite.is_required,onChange:n,children:a("Required")})})},Tk=t=>h.createElement("svg",{width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("path",{d:"M6.32178 26.1055H25.2565L27.7891 11.555H3.78906L6.32178 26.1055ZM24.8946 13.9349L23.2063 23.6954H8.37208L6.6837 13.9349H24.8946Z",fill:"currentColor"}),h.createElement("path",{d:"M11.862 15.4643H19.7165V17.8532H11.862V15.4643Z",fill:"currentColor"}),h.createElement("path",{d:"M6.40737 8.51442H25.171V10.9033H6.40737V8.51442Z",fill:"currentColor"}),h.createElement("path",{d:"M8.80692 5.47388H22.7706V7.86276H8.80692V5.47388Z",fill:"currentColor"})),kk=t=>h.createElement("svg",{width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.2384 7.67993H6.39844V11.5199H10.2384V7.67993ZM25.5981 7.67993H12.1581V11.5199H25.5981V7.67993ZM6.39844 14.0799H10.2384V17.9199H6.39844V14.0799ZM25.5981 14.0799H12.1581V17.9199H25.5981V14.0799ZM6.39844 20.4799H10.2384V24.3199H6.39844V20.4799ZM25.5981 20.4799H12.1581V24.3199H25.5981V20.4799Z",fill:"currentColor"})),Ik=t=>h.createElement("svg",{width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.6654 4.66553H11.332V25.9989H14.6654V4.66553ZM8.66537 13.3312H5.33203V25.9978H8.66537V13.3312ZM17.332 9.9999H20.6654V25.9999H17.332V9.9999ZM26.6654 15.3312H23.332V25.9978H26.6654V15.3312Z",fill:"currentColor"})),$k=t=>h.createElement("svg",{width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.4008 4.80005H4.80078V25.6H15.9492C15.4701 24.6361 15.2008 23.5495 15.2008 22.4001C15.2008 18.4236 18.4243 15.2 22.4008 15.2V4.80005ZM20.0008 9.60005H7.20078V7.20005H20.0008V9.60005ZM16.8008 13.6H7.20078V11.2H16.8008V13.6ZM13.6008 17.6H7.20078V15.2H13.6008V17.6Z",fill:"currentColor"}),h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27.2008 22.4001C27.2008 25.051 25.0518 27.2001 22.4008 27.2001C19.7498 27.2001 17.6008 25.051 17.6008 22.4001C17.6008 19.7491 19.7498 17.6 22.4008 17.6C25.0518 17.6 27.2008 19.7491 27.2008 22.4001ZM19.2008 22.5847L20.4008 21.477L21.6008 22.5847L24.4008 20.0001L25.6008 21.1077L21.6008 24.8001L19.2008 22.5847Z",fill:"currentColor"})),Lk="_list_cfvxe_1",Ak="_item_cfvxe_17",Pk="_itemHeader_cfvxe_49",Nk="_name_cfvxe_63",Rk="_active_cfvxe_77",Dk="_disabled_cfvxe_105",xa={list:Lk,item:Ak,itemHeader:Pk,name:Nk,active:Rk,disabled:Dk},Mk={testcase:e.jsx(Tk,{width:32,height:32}),testresult:e.jsx(Ik,{width:32,height:32}),testplan:e.jsx(kk,{width:32,height:32}),testsuite:e.jsx($k,{width:32,height:32})},Fk=({contentTypes:t,value:s,onChange:a})=>{const n=r=>{const o=s[r.model];a({...s,[r.model]:{...o,is_active:!o.is_active}})},i={testcase:e.jsx(dk,{value:s,onChange:a}),testresult:e.jsx(_k,{value:s,onChange:a}),testplan:e.jsx(gk,{value:s,onChange:a}),testsuite:e.jsx(Ck,{value:s,onChange:a})};return e.jsx("ul",{className:xa.list,children:t.map(r=>{const o=s[r.model].is_active;return e.jsxs("li",{"data-testid":`applied-to-${r.model}`,className:V(xa.item,{[xa.active]:o}),children:[e.jsxs("div",{className:xa.itemHeader,children:[e.jsx(Qt,{id:r.model,label:e.jsx("span",{className:xa.name,children:r.name}),checked:o,size:"lg",onChange:()=>n(r)}),Mk[r.model]]}),o&&i[r.model]]},r.id)})})},us={is_active:!1,is_required:!1},Ek=({formType:t,attribute:s})=>{const{t:a}=T(),{project:n}=h.useContext(J),{statuses:i}=qt({project:n.id}),{handleClose:r,handleShow:o,isShow:c}=rh(),[l,{isLoading:d}]=pg(),[u,{isLoading:p}]=mg(),m=d||p,{data:g}=xg(),[f,x]=h.useState(null),{onHandleError:y}=We(x),{handleSubmit:j,reset:_,control:w,formState:{isDirty:b}}=we({defaultValues:{name:(s==null?void 0:s.name)??"",type:(s==null?void 0:s.type)??0,applied_to:{testresult:{...us,is_suite_specific:!1,suite_ids:[],status_specific:i.map(k=>k.id)},testcase:{...us,is_suite_specific:!1,suite_ids:[]},testplan:us,testsuite:us}}}),S=async k=>{if(x(null),!Object.entries(k.applied_to).reduce((P,[,N])=>N.is_active?P+1:P,0)){x({applied_to:a("At least one applied to must be active")});return}const I=Object.fromEntries(Object.entries(k.applied_to).filter(([,P])=>P.is_active));try{await l({...k,project:n.id,applied_to:I}).unwrap(),H.success({message:a("Success"),closable:!0,description:a("Attribute created successfully")}),v()}catch(P){y(P)}},C=async k=>{if(!s)return;if(x(null),!Object.entries(k.applied_to).reduce((P,[,N])=>N.is_active?P+1:P,0)){x({applied_to:a("At least one applied to must be active")});return}const I=Object.fromEntries(Object.entries(k.applied_to).filter(([,P])=>P.is_active));try{await u({id:Number(s.id),body:{...k,applied_to:I}}).unwrap(),H.success({message:a("Success"),closable:!0,description:a("Attribute edited successfully")}),v()}catch(P){y(P)}},v=()=>{x(null),_(),r()};return h.useEffect(()=>{s&&_({name:s.name,type:s.type,applied_to:{testresult:s.applied_to.testresult?{is_active:!0,is_required:s.applied_to.testresult.is_required,is_suite_specific:!!s.applied_to.testresult.suite_ids.length,suite_ids:s.applied_to.testresult.suite_ids,status_specific:s.applied_to.testresult.status_specific}:{...us,is_suite_specific:!1,suite_ids:[],status_specific:i.map(k=>k.id)},testcase:s.applied_to.testcase?{is_active:!0,is_required:s.applied_to.testcase.is_required,is_suite_specific:!!s.applied_to.testcase.suite_ids.length,suite_ids:s.applied_to.testcase.suite_ids}:{...us,is_suite_specific:!1,suite_ids:[]},testplan:s.applied_to.testplan?{is_active:!0,is_required:s.applied_to.testplan.is_required}:us,testsuite:s.applied_to.testsuite?{is_active:!0,is_required:s.applied_to.testsuite.is_required}:us}})},[s]),{isShow:c,control:w,errors:f,isLoading:m,isDirty:b,contentTypes:g??[],handleClose:v,handleShow:o,handleSubmitForm:j(t==="create"?S:C)}},Lc=t=>{const{t:s}=T(),{isShow:a,control:n,isDirty:i,isLoading:r,errors:o,contentTypes:c,handleClose:l,handleSubmitForm:d,handleShow:u}=Ek(t),{formType:p,attribute:m}=t,g=p==="create",f=s(g?"Create":"Edit"),x=s(g?"Create":"Update");return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:g?"create-custom-attribute":`${p}-custom-attribute-${m==null?void 0:m.id}`,icon:g?e.jsx(ct,{}):e.jsx(Ke,{}),type:g?"primary":void 0,style:g?{marginBottom:16,float:"right"}:void 0,shape:g?"default":"circle",onClick:u,children:g?s("Create Custom Attribute"):""}),e.jsx(he,{className:`${p}-custom-attribute-modal`,title:`${f} ${s("Custom Attribute")}`,open:a,onCancel:l,width:"600px",centered:!0,destroyOnClose:!0,footer:[e.jsx(L,{id:`close-${p}-attribute`,onClick:l,children:s("Close")},"back"),e.jsx(L,{id:`${p}-custom-attribute`,loading:r,onClick:d,type:"primary",disabled:!i,children:x},"submit")],children:e.jsxs(e.Fragment,{children:[o?e.jsx(it,{error:o,skipFields:["name","content_types","applied_to"]}):null,e.jsxs(R,{id:`${p}-attribute-form`,layout:"vertical",onFinish:d,children:[e.jsx(R.Item,{label:s("Name"),validateStatus:o!=null&&o.name?"error":"",help:o!=null&&o.name?o.name:"",required:!0,children:e.jsx(F,{name:"name",control:n,render:({field:y})=>e.jsx(se,{...y})})}),e.jsx(R.Item,{label:s("Type"),validateStatus:o!=null&&o.type?"error":"",help:o!=null&&o.type?o.type:"",required:!0,children:e.jsx(F,{name:"type",control:n,defaultValue:0,render:({field:y})=>e.jsx(ue,{...y,placeholder:s("Please select"),style:{width:"100%"},options:rl})})}),e.jsx(R.Item,{label:s("Applied To"),validateStatus:o!=null&&o.applied_to?"error":"",help:o!=null&&o.applied_to?o.applied_to:"",required:!0,children:e.jsx(F,{name:"applied_to",control:n,render:({field:y})=>e.jsx(Fk,{contentTypes:c,value:y.value,onChange:y.onChange})})})]})]})})]})},Bk=({attributeId:t})=>{const{t:s}=T(),[a]=gg(),n=i=>{he.confirm({title:s("Do you want to delete these attribute?"),okText:s("Delete"),cancelText:s("Cancel"),onOk:async()=>{try{await a(i).unwrap(),H.success({message:s("Success"),closable:!0,description:s("Attribute deleted successfully")})}catch(r){Se(r)}},okButtonProps:{"data-testid":"delete-attribute-button-confirm"},cancelButtonProps:{"data-testid":"delete-attribute-button-cancel"}})};return e.jsx(L,{id:`delete-custom-attribute-${t}`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:()=>n(Number(t))})},Ok=()=>{const{t}=T(),{projectId:s}=Q(),{data:a,isFetching:n}=La({project:s??""}),[i,r]=h.useState({}),{setSearchText:o,getColumnSearch:c}=zs(),l=(p,m)=>{r(m)},d=()=>{r({}),o("")},u=[{title:t("Name"),dataIndex:"name",key:"name",filteredValue:i.name??null,sorter:(p,m)=>p.name.localeCompare(m.name),...c("name"),onFilter:(p,m)=>m.name.toLowerCase().includes(String(p).toLowerCase())},{title:t("Type"),dataIndex:"type",key:"type",filteredValue:i.type??null,filters:rl.map(({value:p,label:m})=>({value:p,text:m})),onFilter:(p,m)=>m.type===p,render:(p,m)=>e.jsx(ce,{children:Ri[m.type]})},{title:t("Applied To"),dataIndex:"applied_to",key:"applied_to",render:p=>e.jsx(ce,{children:Object.keys(p).join(", ")})},{title:t("Action"),key:"action",width:100,render:(p,m)=>e.jsxs(ce,{children:[e.jsx(Lc,{formType:"edit",attribute:m}),e.jsx(Bk,{attributeId:m.id})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ce,{style:{marginBottom:16,display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:d,children:t("Clear filters and sorters")})}),e.jsx(ht,{loading:n,dataSource:a,columns:u,rowKey:"id",style:{marginTop:12},onChange:l,id:"administration-projects-attributes",rowClassName:"administration-projects-attributes-row"})]})},qk=()=>{const{setProjectDetailsActiveTab:t}=h.useContext(cs);return h.useEffect(()=>{t("attributes")},[]),e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:e.jsx(Lc,{formType:"create"})}),e.jsx(Ok,{})]})},zk={0:"System",1:"Custom"},Uk=Object.entries(zk).map(([t,s])=>({value:Number(t),label:s})),Vk=({mode:t,label:s,setIsShow:a,isShow:n})=>{const{t:i}=T(),{projectId:r}=Q(),[o,{isLoading:c}]=Oh(),[l,{isLoading:d}]=qh(),[u,p]=h.useState(null),{onHandleError:m}=We(p),{handleSubmit:g,reset:f,control:x,setValue:y,formState:{isDirty:j}}=we({defaultValues:{name:(s==null?void 0:s.name)??"",type:0}}),_=async C=>{p(null);try{t==="edit"&&s&&r?await l({id:Number(s.id),body:C}).unwrap():await o({...C,project:Number(r)}).unwrap(),H.success({message:i("Success"),closable:!0,description:i(t==="edit"?"Label updated successfully":"Label created successfully")}),w()}catch(v){m(v)}},w=()=>{p(null),f(),a(!1)},b=()=>{(!c||!d)&&w()},S=h.useMemo(()=>t==="create"||!s?i("Create label"):`${i("Edit label")} ${s.name}`,[t,s]);return h.useEffect(()=>{!n||t!=="edit"||!s||(y("name",s.name),y("type",s.type))},[t,s]),{title:S,isShow:n,control:x,errors:u,isLoading:c||d,isDirty:j,handleCancel:b,handleSubmitForm:g(_)}},Ac=t=>{const{t:s}=T(),{title:a,isLoading:n,isDirty:i,control:r,errors:o,handleCancel:c,handleSubmitForm:l}=Vk(t);return e.jsx(he,{className:`${t.mode}-label-modal`,title:a,open:t.isShow,onCancel:c,width:"600px",centered:!0,footer:[e.jsx(L,{id:`${t.mode}-label-close`,onClick:c,children:s("Close")},"back"),e.jsx(L,{id:`${t.mode}-label-button`,loading:n,onClick:l,type:"primary",disabled:!i,children:t.mode==="edit"?s("Update"):s("Create")},"submit")],children:e.jsxs(e.Fragment,{children:[o?e.jsx(it,{error:o,skipFields:["name"]}):null,e.jsxs(R,{id:`${t.mode}-label-form`,layout:"vertical",onFinish:l,children:[e.jsx(R.Item,{label:s("Name"),validateStatus:o!=null&&o.name?"error":"",help:o!=null&&o.name?o.name:"",children:e.jsx(F,{name:"name",control:r,render:({field:d})=>e.jsx(se,{...d})})}),e.jsx(R.Item,{label:s("Type"),validateStatus:o!=null&&o.type?"error":"",help:o!=null&&o.type?o.type:"",children:e.jsx(F,{name:"type",control:r,defaultValue:0,render:({field:d})=>e.jsx(ue,{...d,placeholder:s("Please select"),style:{width:"100%"},options:Uk})})})]})]})})},Hk=()=>{const{t}=T(),[s,a]=h.useState(!1),n=()=>{a(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{id:"create-label-button",type:"primary",icon:e.jsx(ct,{}),onClick:n,style:{marginBottom:16,float:"right"},children:[t("Create")," ",t("Label")]}),e.jsx(Ac,{mode:"create",isShow:s,setIsShow:a})]})},Yk=({label:t})=>{const[s,a]=h.useState(!1),n=()=>{a(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:`${t.name}-edit-label-button`,icon:e.jsx(Ke,{}),shape:"circle",onClick:n}),e.jsx(Ac,{mode:"edit",label:t,isShow:s,setIsShow:a})]})},Wk=({label:t})=>{const{t:s}=T(),[a]=zh(),n=()=>{he.confirm({title:s("Do you want to delete these label?"),okText:s("Delete"),cancelText:s("Cancel"),onOk:async()=>{try{await a(Number(t.id)).unwrap(),H.success({message:s("Success"),closable:!0,description:s("Label deleted successfully")})}catch(i){Se(i)}},okButtonProps:{"data-testid":"delete-label-button-confirm"},cancelButtonProps:{"data-testid":"delete-label-button-cancel"}})};return e.jsx(L,{id:`${t.name}-delete-label-button`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:n})},Qk=t=>{switch(t){case 0:return"System";case 1:return"Custom";default:return"None"}},Gk=()=>{const{t}=T(),{projectId:s}=Q(),{data:a,isFetching:n}=ki({project:s??""},{skip:!s}),[i,r]=h.useState({}),{setSearchText:o,getColumnSearch:c}=zs(),l=(p,m)=>{r(m)},d=()=>{r({}),o("")},u=[{title:t("ID"),dataIndex:"id",key:"id",width:"70px",sorter:(p,m)=>Number(p.id)-Number(m.id)},{title:t("Name"),dataIndex:"name",key:"name",filteredValue:i.name??null,sorter:(p,m)=>p.name.localeCompare(m.name),...c("name"),onFilter:(p,m)=>m.name.toLowerCase().includes(String(p).toLowerCase())},{title:t("Type"),dataIndex:"type",key:"type",filteredValue:i.type??null,filters:[{value:"0",text:"System"},{value:"1",text:"Custom"}],onFilter:(p,m)=>Number(m.type)===Number(p),render:(p,m)=>Qk(m.type)},{title:t("Action"),key:"action",width:100,render:(p,m)=>e.jsxs(ce,{children:[e.jsx(Yk,{label:m}),e.jsx(Wk,{label:m})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ce,{style:{marginBottom:16,display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:d,children:t("Clear filters and sorters")})}),e.jsx(ht,{loading:n,dataSource:a,columns:u,rowKey:"id",style:{marginTop:12},onChange:l,id:"administration-projects-labels",rowClassName:"administration-projects-labels-row"})]})},Kk=()=>{const{setProjectDetailsActiveTab:t}=h.useContext(cs);return h.useEffect(()=>{t("labels")},[]),e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:e.jsx(Hk,{})}),e.jsx(Gk,{})]})},Jk=({project:t})=>e.jsxs(e.Fragment,{children:[e.jsx(ca,{icon:t.icon,name:t.name,dataTestId:"project-icon"}),e.jsx(at,{title:"Name",value:t==null?void 0:t.name,dataTestId:"project-name"}),e.jsx(at,{title:"Description",value:t==null?void 0:t.description,dataTestId:"project-description"}),e.jsx(at,{title:"Status",value:e.jsx(Go,{value:!(t!=null&&t.is_archive),trueText:"ACTIVE",falseText:"ARCHIVED",dataTestid:"project-status"})}),e.jsx(at,{title:"Private",value:e.jsx(Ps,{color:"default","data-testid":"project-private",children:t.is_private?"Yes":"No"})})]}),Zk=()=>{const{setProjectDetailsActiveTab:t}=h.useContext(cs),{project:s}=h.useContext(J),{me:a}=h.useContext(Pe),n=!s.is_archive||(a==null?void 0:a.is_superuser);return h.useEffect(()=>{t("overview")}),e.jsxs(os,{style:{padding:24,minHeight:360},children:[s.is_manageable&&e.jsxs(ce,{style:{marginBottom:"16px",float:"right"},children:[n&&e.jsx(Nv,{project:s}),s.is_archive?e.jsx(uc,{project:s}):e.jsx(kv,{project:s})]}),e.jsx(Jk,{project:s})]})},Xk=()=>{const{t}=T(),s=Ds(),{projectId:a}=Q(),{data:n,isFetching:i}=Ni(Number(a),{skip:!a}),[r]=hg(),[o,c]=h.useState({}),{setSearchText:l,getColumnSearch:d}=zs(),u=f=>{s(A0(f)),s(N0())},p=(f,x)=>{c(x)},m=()=>{c({}),l("")},g=[{title:t("Name"),dataIndex:"data",key:"data",filteredValue:o.data??null,...d("data"),onFilter:(f,x)=>x.data.toLowerCase().includes(String(f).toLowerCase()),render:(f,x)=>e.jsx("span",{"data-testid":`${x.data}-name`,children:f})},{title:t("Group"),dataIndex:"group_name",key:"group_name",filteredValue:o.group_name??null,...d("group_name"),onFilter:(f,x)=>x.group_name.toLowerCase().includes(String(f).toLowerCase()),render:(f,x)=>e.jsx("span",{"data-testid":`${x.data}-group-name`,children:f})},{title:t("Action"),key:"action",width:100,render:(f,x)=>e.jsxs(ce,{children:[e.jsx(L,{id:`${x.data}-edit`,icon:e.jsx(Ke,{}),shape:"circle",onClick:()=>u(x)}),e.jsx(L,{id:`${x.data}-delete`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:()=>{he.confirm({title:t("Do you want to delete these parameter?"),okText:t("Delete"),cancelText:t("Cancel"),onOk:async()=>{try{await r(x.id).unwrap(),H.success({message:t("Success"),closable:!0,description:t("Parameter deleted successfully")})}catch(y){Se(y)}},okButtonProps:{"data-testid":"delete-parameter-button-confirm"},cancelButtonProps:{"data-testid":"delete-parameter-button-cancel"}})}})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ce,{style:{marginBottom:16,display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:m,children:t("Clear filters and sorters")})}),e.jsx(ht,{loading:i,dataSource:n,columns:g,rowKey:"data",style:{marginTop:12},onChange:p,id:"administration-projects-parameters",rowClassName:"administration-projects-parameters-row"})]})},eI=({projectId:t})=>{const{t:s}=T(),{showModal:a}=Ot(),n=Ds(),i=z(D0),r=z(M0),o=oi(F0),[c,l]=h.useState(null),{handleSubmit:d,reset:u,control:p,setValue:m,formState:{isDirty:g}}=we(),[f,{isLoading:x}]=dg(),[y]=ug(),{onHandleError:j}=We(l);h.useEffect(()=>{r&&o&&(m("data",o.data),m("group_name",o.group_name))},[r,o]);const _=async v=>{l(null);try{r&&o?await y({id:o.id,body:{...v,project:o.project}}).unwrap():await f({...v,project:t}).unwrap(),w(),H.success({message:s("Success"),closable:!0,description:s(r?"Parameter updated successfully":"Parameter created successfully")})}catch(k){j(k)}},w=()=>{n(R0()),l(null),u()},b=()=>{if(!x){if(g){a(w);return}w()}},S=r?`${s("Edit")} ${s("Parameter")} ${o==null?void 0:o.data}`:`${s("Create")} ${s("Parameter")}`,C=r?"edit":"create";return e.jsx(he,{className:`${C}-parameter-modal`,title:S,open:i,onCancel:b,width:"600px",centered:!0,footer:[e.jsx(L,{onClick:b,"data-testid":`${C}-parameter-close-button`,children:s("Close")},"back"),e.jsx(L,{loading:x,onClick:d(_),type:"primary",disabled:!g,"data-testid":`${C}-parameter-button`,children:s(r?"Update":"Create")},"submit")],children:e.jsxs(e.Fragment,{children:[c?e.jsx(it,{error:c,skipFields:["data","group_name"]}):null,e.jsxs(R,{layout:"vertical",onFinish:d(_),"data-testid":`${C}-parameter-form`,children:[e.jsx(R.Item,{label:"Name",validateStatus:c!=null&&c.data?"error":"",help:c!=null&&c.data?c.data:"",children:e.jsx(F,{name:"data",control:p,render:({field:v})=>e.jsx(se,{...v,"data-testid":`${C}-parameter-name`})})}),e.jsx(R.Item,{label:"Group",validateStatus:c!=null&&c.group_name?"error":"",help:c!=null&&c.group_name?c.group_name:"",children:e.jsx(F,{name:"group_name",control:p,render:({field:v})=>e.jsx(se,{...v,"data-testid":`${C}-parameter-group`})})})]})]})})},tI=()=>{const{t}=T(),s=Ds(),{setProjectDetailsActiveTab:a}=h.useContext(cs),n=ou();h.useEffect(()=>{a("parameters")},[]);const i=()=>{s(P0())};return e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:e.jsxs(L,{id:"create-parameter",type:"primary",icon:e.jsx(ct,{}),onClick:i,style:{marginBottom:16,float:"right"},children:[t("Create")," ",t("Parameter")]})}),e.jsx(eI,{projectId:n}),e.jsx(Xk,{})]})},sI=({user:t})=>{const{t:s}=T(),[a]=Ru(),n=async()=>{try{await a(t.id).unwrap(),H.success({message:s("Success"),closable:!0,description:s("User deleted successfully")})}catch(i){Se(i)}};return e.jsx(L,{id:`delete-user-details-${t.username}`,"data-testid":`delete-user-details-${t.username}`,icon:e.jsx(ut,{}),shape:"circle",danger:!0,onClick:()=>{he.confirm({title:s("Do you want to delete these user?"),okText:s("Delete"),cancelText:s("Cancel"),onOk:n,okButtonProps:{"data-testid":"delete-user-button-confirm"},cancelButtonProps:{"data-testid":"delete-user-button-cancel"}})}})},aI=({user:t})=>{const s=ye(),a=()=>{s(Yu(t)),s(Gu())};return e.jsx(L,{id:`show-user-details-${t.username}`,"data-testid":`show-user-details-${t.username}`,icon:e.jsx(Ke,{}),shape:"circle",onClick:a})},eo=8,to=t=>/[A-Z]/.test(t)?/[a-z]/.test(t)?/\d/.test(t)?/[!@#$%^&*]/.test(t)?t.length<eo?{password:`Password must have at least ${eo} characters.`}:null:{password:"Password must have at least one special character."}:{password:"Password must have at least one digit."}:{password:"Password must have at least one lowercase character."}:{password:"Password must have at least one uppercase character."},nI=()=>{const{t}=T(),s=z(Fo),[a,n]=h.useState(null),{handleSubmit:i,reset:r,control:o,setValue:c,formState:{isDirty:l},getValues:d,watch:u}=we(),[p,{isLoading:m}]=Ou(),{onHandleError:g}=We(n),[f,x]=h.useState(!1),y=u("password"),j=u("confirm");h.useEffect(()=>{const[C,v]=d(["password","confirm"]);if(!C&&!v){n(null);return}const k=to(C);if(k){n(k);return}n(C!==v?{confirm:t("The passwords that you entered do not match!")}:to(C))},[y,j]);const _=()=>{x(!1),n(null),r()},w=()=>{x(!0)},b=async C=>{if(!a)try{const{password:v}=C;await p({password:v}).unwrap(),H.success({message:t("Success"),closable:!0,description:t("Password updated successfully")}),_()}catch(v){g(v)}};return h.useEffect(()=>{f&&s&&(c("password",""),c("confirm",""))},[s,f]),{handleSave:b,handleCancel:_,handleShow:w,saveDisabled:!l||m||!!a,errors:a,control:o,handleSubmit:i,isShow:f,password:y}},iI=()=>{const{t}=T(),{handleSave:s,handleCancel:a,handleShow:n,saveDisabled:i,errors:r,control:o,handleSubmit:c,isShow:l,password:d}=nI();return e.jsxs(e.Fragment,{children:[e.jsx(L,{id:"change-password-btn",icon:e.jsx(lu,{}),onClick:n,style:{marginLeft:8},children:t("Change password")}),e.jsxs(he,{className:"change-password-modal",title:t("Change password"),open:l,onCancel:a,centered:!0,footer:[e.jsx(L,{id:"cancel-btn",onClick:a,children:t("Cancel")},"back"),e.jsx(L,{id:"save-btn",type:"primary",onClick:c(s),disabled:i,children:t("Save")},"submit")],children:[e.jsxs(R,{id:"change-password-form",layout:"vertical",onFinish:c(s),children:[e.jsx(R.Item,{label:t("Password"),validateStatus:r!=null&&r.password?"error":"",help:r!=null&&r.password?r.password:"",required:!0,children:e.jsx(F,{name:"password",control:o,render:({field:u})=>e.jsx(se.Password,{id:"change-password-form-password",...u})})}),e.jsx(R.Item,{name:"confirm",label:t("Confirm Password"),dependencies:["password"],validateStatus:r!=null&&r.confirm?"error":"",help:r!=null&&r.confirm?r.confirm:"",required:!0,children:e.jsx(F,{name:"confirm",control:o,render:({field:u})=>e.jsx(se.Password,{id:"change-password-form-confirm",...u,disabled:!!(r!=null&&r.password)||!d})})})]}),r?e.jsx(it,{error:r,skipFields:["password","confirm"]}):null]})]})},rI=t=>h.createElement("svg",{id:"emoji",viewBox:"0 0 72 72",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("g",{id:"color"},h.createElement("rect",{x:5,y:17,width:62,height:38,fill:"#1e50a0"}),h.createElement("g",null,h.createElement("polygon",{fill:"#fff",points:"40 28.856 40 32 50.181 32 67 21.691 67 17 59.346 17 40 28.856"}),h.createElement("polygon",{fill:"#d22f27",points:"67 17 67 17 63.173 17 40 31.203 40 32 43.482 32 67 17.586 67 17"}),h.createElement("polygon",{fill:"#fff",points:"59.347 55 67 55 67 55 67 50.308 50.182 40 40 40 40 43.143 59.347 55"}),h.createElement("polygon",{fill:"#d22f27",points:"67 55 67 52.653 46.355 40 41.568 40 66.042 55 67 55 67 55"}),h.createElement("polygon",{fill:"#fff",points:"32 43.144 32 40 21.819 40 5 50.309 5 55 12.654 55 32 43.144"}),h.createElement("polygon",{fill:"#d22f27",points:"5 55 5 55 8.827 55 32 40.797 32 40 28.518 40 5 54.414 5 55"}),h.createElement("polygon",{fill:"#fff",points:"12.653 17 5 17 5 17 5 21.692 21.818 32 32 32 32 28.857 12.653 17"}),h.createElement("polygon",{fill:"#d22f27",points:"5 17 5 19.347 25.646 32 30.432 32 5.958 17 5 17 5 17"}),h.createElement("rect",{x:5,y:31,width:62,height:10,fill:"#fff"}),h.createElement("rect",{x:31,y:17,width:10,height:38,fill:"#fff"}),h.createElement("rect",{x:5,y:33,width:62,height:6,fill:"#d22f27"}),h.createElement("rect",{x:33,y:17,width:6,height:38,fill:"#d22f27"}))),h.createElement("g",{id:"line"},h.createElement("rect",{x:5,y:17,width:62,height:38,fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2}))),oI=t=>h.createElement("svg",{id:"emoji",viewBox:"0 0 72 72",xmlns:"http://www.w3.org/2000/svg",...t},h.createElement("g",{id:"color"},h.createElement("rect",{x:5,y:17,width:62,height:38,fill:"#d22f27"}),h.createElement("rect",{x:5,y:17,width:62,height:13,fill:"#fff"}),h.createElement("rect",{x:5,y:30,width:62,height:12,fill:"#1e50a0"})),h.createElement("g",{id:"line"},h.createElement("rect",{x:5,y:17,width:62,height:38,fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2}))),lI="_select_14kvk_1",cI="_label_14kvk_19",Qn={select:lI,label:cI},so={ru:e.jsx(oI,{width:24}),en:e.jsx(rI,{width:24})},dI=[{label:"Русский",value:"ru"},{label:"English",value:"en"}],uI=()=>{const{i18n:t}=T(),[s,a]=Es("lang",Ae.defaultLang),n=i=>{const r=i;a(r),t.changeLanguage(r)};return e.jsx(ue,{className:Qn.select,defaultValue:[s],onChange:n,options:dI,labelRender:i=>e.jsxs(M,{align:"center",gap:8,style:{maxHeight:22},children:[e.jsx("span",{role:"img","aria-label":i.label,className:Qn.label,children:so[i.value]}),e.jsx("span",{children:i.label})]}),optionRender:i=>e.jsxs(M,{align:"center",gap:8,style:{maxHeight:22},children:[e.jsx("span",{role:"img","aria-label":i.data.label,className:Qn.label,children:so[i.value]}),e.jsx("span",{children:i.data.label})]})})},hI=()=>{const{t}=T(),[s,a]=h.useState({page:1,page_size:10}),[n,i]=h.useState({}),[r,o]=h.useState({}),c=z(aa),{data:l,isLoading:d}=Lu({...s,...r}),{setSearchText:u,getColumnSearch:p}=zs(),m=(j,_)=>{i(_),o(w=>({...w,username:_!=null&&_.username?String(_.username[0]):void 0,email:_!=null&&_.email?String(_.email[0]):void 0,first_name:_!=null&&_.first_name?String(_.first_name[0]):void 0,last_name:_!=null&&_.last_name?String(_.last_name[0]):void 0,is_active:_!=null&&_.is_active?!!_.is_active[0]:void 0,is_superuser:_!=null&&_.is_superuser?!!_.is_superuser[0]:void 0}))},g=()=>{i({}),o({}),u("")},f=[{key:"avatar",width:"32px",align:"right",render:(j,_)=>e.jsx(Ut,{avatar_link:_.avatar_link,size:32})},{title:t("Username"),dataIndex:"username",key:"username",filteredValue:n.username??null,...p("username"),onFilter:(j,_)=>_.username.toLowerCase().includes(String(j).toLowerCase())},{title:t("Email"),dataIndex:"email",key:"email",filteredValue:n.email??null,...p("email"),onFilter:(j,_)=>_.email.toLowerCase().includes(String(j).toLowerCase())},{title:t("First Name"),dataIndex:"first_name",key:"first_name",filteredValue:n.first_name??null,...p("first_name"),onFilter:(j,_)=>_.first_name.toLowerCase().includes(String(j).toLowerCase())},{title:t("Last Name"),dataIndex:"last_name",key:"last_name",filteredValue:n.last_name??null,...p("last_name"),onFilter:(j,_)=>_.last_name.toLowerCase().includes(String(j).toLowerCase())},{title:t("Active"),dataIndex:"is_active",key:"is_active",width:100,filters:[{text:"Active",value:!0}],filteredValue:n.is_active??null,onFilter:(j,_)=>_.is_active,render:j=>e.jsx(Xn,{value:j})},{title:t("Admin"),dataIndex:"is_superuser",key:"is_superuser",width:100,filters:[{text:"Admin",value:!0}],filteredValue:n.is_superuser??null,onFilter:(j,_)=>_.is_superuser,render:j=>e.jsx(Xn,{value:j})},{key:"action",width:110,render:(j,_)=>c!=null&&c.is_superuser?e.jsxs(ce,{children:[e.jsx(aI,{user:_}),e.jsx(sI,{user:_})]}):null}],x=(j,_)=>{a({page:j,page_size:_})},y={total:(l==null?void 0:l.pages.total)??0,hideOnSinglePage:!1,pageSizeOptions:Ae.pageSizeOptions,showLessItems:!0,showSizeChanger:!0,current:s.page,pageSize:s.page_size,onChange:x};return{users:(l==null?void 0:l.results)??[],isLoading:d,columns:f,paginationTable:y,handleChange:m,clearAll:g}},pI=()=>{const{t}=T(),{columns:s,isLoading:a,users:n,paginationTable:i,handleChange:r,clearAll:o}=hI();return e.jsxs(e.Fragment,{children:[e.jsx(ce,{style:{marginBottom:16,display:"flex",justifyContent:"right"},children:e.jsx(L,{id:"clear-filters-and-sorters",onClick:o,children:t("Clear filters and sorters")})}),e.jsx(ht,{loading:a,dataSource:n,columns:s,rowKey:"username",style:{marginTop:12},onChange:r,pagination:i})]})},mI=()=>{const{t}=T(),{title:s,isEditMode:a,isShow:n,isLoading:i,isActive:r,isAdmin:o,isDirty:c,errors:l,control:d,handleCancel:u,handleSubmitForm:p}=sC(),m=a?t("Edit").toLowerCase():t("Create").toLowerCase();return e.jsx(he,{className:`${m}-user-modal`,title:s,open:n,onCancel:u,width:"600px",centered:!0,footer:[e.jsx(L,{id:`close-${m}-user`,onClick:u,children:t("Close")},"back"),e.jsx(L,{id:`${m}-user-btn`,loading:i,onClick:p,type:"primary",disabled:!c,children:t(a?"Update":"Create")},"submit")],children:e.jsxs(e.Fragment,{children:[l?e.jsx(it,{error:l,skipFields:["username","email","password","confirm","first_name","last_name","is_active","is_superuser"]}):null,e.jsxs(R,{id:`${m}-user-form`,layout:"vertical",onFinish:p,children:[e.jsx(R.Item,{label:t("Username"),validateStatus:l!=null&&l.username?"error":"",help:l!=null&&l.username?l.username:"",required:!a,children:e.jsx(F,{name:"username",control:d,render:({field:g})=>e.jsx(se,{id:`${m}-username`,...g,disabled:a})})}),e.jsx(R.Item,{label:t("Email"),validateStatus:l!=null&&l.email?"error":"",help:l!=null&&l.email?l.email:"",required:!0,children:e.jsx(F,{name:"email",control:d,render:({field:g})=>e.jsx(se,{id:`${m}-email`,...g})})}),!a&&e.jsxs(e.Fragment,{children:[e.jsx(R.Item,{label:t("Password"),validateStatus:l!=null&&l.password?"error":"",help:l!=null&&l.password?l.password:"",required:!a,children:e.jsx(F,{name:"password",control:d,render:({field:g})=>e.jsx(se.Password,{id:`${m}-password`,...g})})}),e.jsx(R.Item,{name:"confirm",label:t("Confirm Password"),dependencies:["password"],validateStatus:l!=null&&l.confirm?"error":"",help:l!=null&&l.confirm?l.confirm:"",required:!a,children:e.jsx(F,{name:"confirm",control:d,render:({field:g})=>e.jsx(se.Password,{id:`${m}-confirm`,...g})})})]}),e.jsx(R.Item,{label:t("First Name"),validateStatus:l!=null&&l.first_name?"error":"",help:l!=null&&l.first_name?l.first_name:"",children:e.jsx(F,{name:"first_name",control:d,render:({field:g})=>e.jsx(se,{id:`${m}-first-name`,...g})})}),e.jsx(R.Item,{label:t("Last Name"),validateStatus:l!=null&&l.last_name?"error":"",help:l!=null&&l.last_name?l.last_name:"",children:e.jsx(F,{name:"last_name",control:d,render:({field:g})=>e.jsx(se,{id:`${m}-last-name`,...g})})}),e.jsx(R.Item,{label:t("Active"),validateStatus:l!=null&&l.is_active?"error":"",help:l!=null&&l.is_active?l.is_active:"",children:e.jsx(F,{name:"is_active",control:d,render:({field:g})=>e.jsx(Wt,{id:`${m}-is-active`,checked:r,...g})})}),e.jsx(R.Item,{label:t("Admin"),validateStatus:l!=null&&l.is_superuser?"error":"",help:l!=null&&l.is_superuser?l.is_superuser:"",children:e.jsx(F,{name:"is_superuser",control:d,render:({field:g})=>e.jsx(Wt,{id:`${m}-is-admin`,checked:o,...g})})})]})]})})},gI=()=>{const{t}=T(),{showModal:s}=Ot(),a=Ds(),n=z(sh),i=oi(aa),[r,o]=h.useState(null),{handleSubmit:c,reset:l,control:d,setValue:u,formState:{isDirty:p}}=we(),[m,{isLoading:g}]=Bu(),{onHandleError:f}=We(o);h.useEffect(()=>{n&&i&&(u("first_name",i.first_name),u("last_name",i.last_name))},[n,i]);const x=()=>{a(Zu()),o(null),l()},y=()=>{if(!g){if(p){s(x);return}x()}},j=async _=>{o(null);try{await m(_).unwrap(),x(),H.success({message:t("Success"),closable:!0,description:t("Profile updated successfully")})}catch(w){f(w)}};return e.jsx(he,{className:"edit-profile-modal",title:t("Edit Profile"),open:n,onCancel:y,width:"600px",centered:!0,footer:[e.jsx(L,{id:"close-edit-profile",onClick:y,children:t("Close")},"back"),e.jsx(L,{id:"update-edit-profile",loading:g,onClick:c(j),type:"primary",disabled:!p,children:t("Update")},"submit")],children:e.jsxs(e.Fragment,{children:[r?e.jsx(it,{error:r,skipFields:["first_name","last_name"]}):null,e.jsxs(R,{id:"edit-profile-form",layout:"vertical",onFinish:c(j),children:[e.jsx(R.Item,{label:t("First Name"),validateStatus:r!=null&&r.first_name?"error":"",help:r!=null&&r.first_name?r.first_name:"",children:e.jsx(F,{name:"first_name",control:d,render:({field:_})=>e.jsx(se,{..._})})}),e.jsx(R.Item,{label:t("Last Name"),validateStatus:r!=null&&r.last_name?"error":"",help:r!=null&&r.last_name?r.last_name:"",children:e.jsx(F,{name:"last_name",control:d,render:({field:_})=>e.jsx(se,{..._})})})]})]})})},{Content:xI}=es,ao=()=>{const{t}=T(),s=Ds(),a=z(aa),n=[e.jsx(Zt.Item,{children:t("Administration")},"administration"),e.jsx(Zt.Item,{children:t("Users")},"users")],i=()=>{s(Qu())};return e.jsxs(e.Fragment,{children:[e.jsx(ka,{breadcrumbRender:()=>e.jsx(Zt,{children:n}),title:t("Users"),ghost:!1,style:{paddingBottom:0}}),e.jsxs(xI,{style:{margin:"24px"},children:[e.jsx(mI,{}),e.jsxs(os,{style:{padding:24,minHeight:360},children:[e.jsx(ce,{style:{display:"flex",justifyContent:"right"},children:(a==null?void 0:a.is_superuser)&&e.jsx(L,{id:"create-user",onClick:i,type:"primary",icon:e.jsx(ct,{}),style:{marginBottom:16,float:"right"},children:t("Create User")})}),e.jsx(pI,{})]})]})]})},fI="_header_u17av_1",jI="_row_u17av_27",yI="_searchIcon_u17av_37",_I="_viewBtn_u17av_47",bI="_viewBtnActive_u17av_61",Js={header:fI,row:jI,searchIcon:yI,viewBtn:_I,viewBtnActive:bI},{ColumnViewIcon:vI,TableIcon:SI}=Ce,wI=({searchText:t,onChangeSearch:s,onIsOnlyFavoriteClick:a,onShowArchived:n,view:i,setView:r})=>{var l,d;const{t:o}=T(),{userConfig:c}=h.useContext(Pe);return e.jsxs("div",{className:Js.header,"data-testid":"dashboard-header",children:[e.jsx("div",{"data-testid":"dashboard-header-search",children:e.jsx(se.Search,{placeholder:o("Search"),value:t,onChange:u=>s(u.target.value),style:{maxWidth:360},size:"large",allowClear:!0,"data-testid":"dashboard-header-search-input"})}),e.jsxs(M,{align:"center",gap:16,className:Js.row,children:[e.jsx(Qt,{id:"only-favorites-switcher",checked:(l=c==null?void 0:c.projects)==null?void 0:l.is_only_favorite,onChange:a,label:o("Favorites"),size:"lg"}),e.jsx(Qt,{id:"show-archived-switcher",checked:(d=c==null?void 0:c.projects)==null?void 0:d.is_show_archived,onChange:n,label:o("Archives"),size:"lg"})]}),e.jsx(uI,{}),e.jsxs(ce,{style:{marginLeft:16},children:[e.jsx(L,{className:V(Js.viewBtn,{[Js.viewBtnActive]:i==="cards"}),ghost:i!=="cards",onClick:()=>r("cards"),icon:e.jsx(vI,{width:24,height:24}),"data-testid":"dashboard-header-view-btn-cards"}),e.jsx(L,{className:V(Js.viewBtn,{[Js.viewBtnActive]:i==="table"}),ghost:i!=="table",onClick:()=>r("table"),icon:e.jsx(SI,{width:24,height:24}),"data-testid":"dashboard-header-view-btn-table"})]})]})},CI=()=>{const{userConfig:t,updateConfig:s}=h.useContext(Pe),[a,n]=h.useState(void 0),i=Fs(a,250,!0),[r,o]=Es("dashboard-view","cards"),c=async()=>{var d;await s({...t,projects:{...t==null?void 0:t.projects,is_show_archived:!((d=t==null?void 0:t.projects)!=null&&d.is_show_archived)}})},l=async()=>{var d;await s({...t,projects:{...t==null?void 0:t.projects,is_only_favorite:!((d=t==null?void 0:t.projects)!=null&&d.is_only_favorite)}})};return e.jsxs(e.Fragment,{children:[e.jsx(wI,{onChangeSearch:d=>n(d),searchText:a??"",onShowArchived:c,onIsOnlyFavoriteClick:l,view:r,setView:o}),r==="cards"&&e.jsx(wS,{searchName:i??""}),r==="table"&&e.jsx(RS,{searchName:i??""})]})},{Content:TI}=es,kI=()=>e.jsx(TI,{style:{margin:"20px 32px",marginTop:0,display:"flex",flexDirection:"column"},children:e.jsx(CI,{})}),II=()=>{const t=De(),[s]=To();return h.useEffect(()=>{s().unwrap().then(()=>{t("/login")})},[]),e.jsx(zt,{})},$I="_avatarWrapper_1qtci_1",LI={avatarWrapper:$I},{Content:AI}=es,PI=({profile:t})=>{const{t:s}=T();return e.jsxs(e.Fragment,{children:[e.jsx(at,{title:s("Username"),value:t.username}),e.jsx(at,{title:s("Email"),value:t.email}),e.jsx(at,{title:s("First Name"),value:t.first_name}),e.jsx(at,{title:s("Last Name"),value:t.last_name})]})},NI=()=>{const{t}=T(),s=Ds(),{me:a}=h.useContext(Pe),n=()=>{s(Ju())};return e.jsxs(e.Fragment,{children:[e.jsx(ka,{title:t("Profile"),ghost:!1,style:{paddingBottom:0}}),e.jsxs(Ye,{style:{margin:"24px"},children:[e.jsx(Le,{flex:"0 1 260px",children:e.jsx("div",{className:LI.avatarWrapper,children:e.jsx(Fb,{})})}),e.jsx(Le,{flex:9,children:e.jsx(AI,{style:{marginLeft:"24px"},children:e.jsxs(yi,{children:[e.jsxs(Ye,{align:"middle",children:[e.jsx(Le,{flex:"auto",children:e.jsx("p",{style:{margin:0,fontSize:18},children:t("General Details")})}),e.jsxs(Le,{flex:"none",children:[e.jsx(L,{id:"edit-profile",onClick:n,icon:e.jsx(Ke,{}),children:t("Edit")}),a&&e.jsx(iI,{})]})]}),e.jsx(je,{}),a&&e.jsx(PI,{profile:a})]})})})]}),e.jsx(gI,{})]})};K.extend(cu);K.extend(du);K.updateLocale(an(),{weekStart:1});const RI=uu(hu(e.jsxs(X,{children:[e.jsx(X,{element:e.jsx(G0,{}),children:e.jsxs(X,{path:"/",element:e.jsx(vm,{}),children:[e.jsx(X,{index:!0,element:e.jsx(kI,{})}),e.jsx(X,{path:"administration/projects",element:e.jsx(Xr,{})}),e.jsx(X,{path:"administration/users",element:e.jsx(ao,{})}),e.jsxs(X,{element:e.jsx(pf,{}),children:[e.jsxs(X,{path:"projects/:projectId",children:[e.jsx(X,{index:!0,element:e.jsx(So,{to:"overview",replace:!0})}),e.jsx(X,{path:"overview",element:e.jsx(VS,{})}),e.jsxs(X,{element:e.jsx(QS,{}),children:[e.jsxs(X,{path:"suites",children:[e.jsxs(X,{element:e.jsx(yv,{}),children:[e.jsx(X,{index:!0,element:e.jsx(qr,{})}),e.jsx(X,{path:":testSuiteId",element:e.jsx(qr,{})}),e.jsx(X,{path:":testSuiteId/custom-attributes",element:e.jsx(vv,{})}),e.jsx(X,{path:":testSuiteId/attachments",element:e.jsx(Sv,{})})]}),e.jsx(X,{path:"new-test-suite",element:e.jsx(ur,{type:"create"})}),e.jsx(X,{path:":testSuiteId/edit-test-suite",element:e.jsx(ur,{type:"edit"})}),e.jsx(X,{path:":testSuiteId/new-test-case",element:e.jsx(MT,{})}),e.jsx(X,{path:":testSuiteId/edit-test-case",element:e.jsx(s0,{})})]}),e.jsxs(X,{path:"plans",children:[e.jsxs(X,{element:e.jsx(pv,{}),children:[e.jsx(X,{index:!0,element:e.jsx(Or,{})}),e.jsx(X,{path:":testPlanId",element:e.jsx(Or,{})}),e.jsx(X,{path:":testPlanId/activity",element:e.jsx(gv,{})}),e.jsx(X,{path:":testPlanId/custom-attributes",element:e.jsx(xv,{})}),e.jsx(X,{path:":testPlanId/attachments",element:e.jsx(fv,{})})]}),e.jsx(X,{path:"new-test-plan",element:e.jsx(Tr,{type:"create"})}),e.jsx(X,{path:":testPlanId/edit-test-plan",element:e.jsx(Tr,{type:"edit"})})]})]})]}),e.jsxs(X,{path:"administration",children:[e.jsx(X,{path:"projects",element:e.jsx(Xr,{})}),e.jsxs(X,{path:"projects/:projectId",element:e.jsx(i0,{}),children:[e.jsx(X,{path:"overview",element:e.jsx(Zk,{})}),e.jsx(X,{path:"parameters",element:e.jsx(tI,{})}),e.jsx(X,{path:"labels",element:e.jsx(Kk,{})}),e.jsx(X,{path:"statuses",element:e.jsx(I0,{})}),e.jsx(X,{path:"access-management",element:e.jsx(C0,{})}),e.jsx(X,{path:"attributes",element:e.jsx(qk,{})}),e.jsx(X,{path:"settings",element:e.jsx(k0,{})})]}),e.jsx(X,{path:"users",element:e.jsx(ao,{})})]})]}),e.jsx(X,{path:"profile",element:e.jsx(NI,{})}),e.jsxs(X,{path:"notifications",element:e.jsx(sv,{}),children:[e.jsx(X,{index:!0,element:e.jsx(W0,{})}),e.jsx(X,{path:"settings",element:e.jsx(Q0,{})})]})]})}),e.jsx(X,{path:"/login",element:e.jsx(Y0,{})}),e.jsx(X,{path:"/logout",element:e.jsx(II,{})}),e.jsx(X,{path:"*",element:e.jsx(el,{code:"404",message:"Sorry, the page you visited does not exist."})})]}))),DI=()=>(al(),e.jsx(pu,{router:RI}));mu.use(gu).init({resources:$T,lng:an(),fallbackLng:an(),interpolation:{escapeValue:!1}});const MI=document.getElementById("root"),FI=xu(MI);FI.render(e.jsx(fu,{store:kc,children:e.jsx(ju,{loading:null,persistor:Ic,children:e.jsx(iC,{children:e.jsx(DI,{})})})}));
